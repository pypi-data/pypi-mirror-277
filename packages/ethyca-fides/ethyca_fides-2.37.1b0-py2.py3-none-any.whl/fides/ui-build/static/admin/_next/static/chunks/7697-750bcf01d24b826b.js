(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7697],{44845:function(e,t,n){"use strict";var s=n(90849),r=n(90089),i=n(28841),o=n(24246),a=["search","onChange","withIcon","onClear","placeholder"];function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.search,n=e.onChange,s=e.withIcon,c=e.onClear,d=e.placeholder,u=(0,r.Z)(e,a);return(0,o.jsxs)(i.BZy,{size:"sm",minWidth:"308px",children:[s?(0,o.jsx)(i.Z8_,{pointerEvents:"none",children:(0,o.jsx)(i.PTu,{color:"gray.300",w:"17px",h:"17px"})}):null,(0,o.jsx)(i.IIB,l({autoComplete:"off",type:"search",minWidth:200,size:"sm",borderRadius:"md",value:t,name:"search",onChange:function(e){return n(e.target.value)},placeholder:d||""},u)),c?(0,o.jsx)(i.xHT,{children:(0,o.jsx)(i.zxk,{borderLeftRadius:0,height:"95%",right:"14px",flexShrink:0,fontWeight:"light",size:"sm",onClick:c,children:"Clear"})}):null]})}},88486:function(e,t,n){"use strict";n.d(t,{Gt:function(){return f},eB:function(){return h},oI:function(){return u}});var s=n(34090),r=n(27378),i=n(6848),o=n(30691),a=n(2458),c=n(24246),l=(0,r.createRef)(),d=(0,r.createRef)(),u=function(){var e=(0,i.T)(),t=(0,i.C)(o.DB),n=(0,r.useCallback)((function(){d.current=void 0,l.current=void 0}),[]),s=(0,r.useCallback)((function(){e((0,o.Mr)()),d.current&&(d.current(!0),n())}),[e,n]),a=(0,r.useCallback)((function(){e((0,o.Mr)()),d.current&&(d.current(!1),n())}),[e,n]);return{attemptAction:(0,r.useCallback)((function(){return t?(e((0,o.h7)()),l.current||(l.current=new Promise((function(e){d.current=e}))),l.current):Promise.resolve(!0)}),[t,e]),onConfirm:s,onClose:a}},f=function(e){var t=e.id,n=e.name,a=(0,s.u6)().dirty,c=(0,i.T)();return(0,r.useEffect)((function(){return c((0,o.Zu)({id:t,name:n})),function(){c((0,o.dz)({id:t}))}}),[c,t,n]),(0,r.useEffect)((function(){c((0,o.$p)({id:t,isDirty:a}))}),[a,c,t]),null},h=function(){var e=u(),t=e.onConfirm,n=e.onClose,s=(0,i.C)(o.uv);return(0,c.jsx)(a.Z,{isOpen:s,onClose:n,onConfirm:t,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},89348:function(e,t,n){"use strict";n.d(t,{q:function(){return D}});var s=n(28841),r=n(27378),i=n(90849),o=n(55732),a=n(97865),c=n(34707),l=n.n(c),d=n(78624),u=n(88486),f=n(91728),h=n(96156),m=n(34090),x=n(24246),y=function(e){var t=e.systems,n=e.dataFlows,r=e.onDataFlowSystemChange,i=(0,m.u6)().setFieldValue,o=n.map((function(e){return e.fides_key}));return(0,x.jsxs)(s.iA_,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,x.jsx)(s.hrZ,{children:(0,x.jsxs)(s.Tr,{children:[(0,x.jsx)(s.Th,{children:"System"}),(0,x.jsx)(s.Th,{})]})}),(0,x.jsx)(s.p3B,{children:t.filter((function(e){return o.includes(e.fides_key)})).map((function(e){return(0,x.jsxs)(s.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,x.jsx)(s.Td,{children:(0,x.jsx)(s.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,x.jsx)(s.Td,{textAlign:"end",children:(0,x.jsx)(s.hU,{background:"gray.50","aria-label":"Unassign data flow from system",icon:(0,x.jsx)(h.l,{}),variant:"outline",size:"sm",onClick:function(){return function(e){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));i("dataFlowSystems",t),r(t)}(e)},"data-testid":"unassign-btn"})})]},e.fides_key)}))})]})},g=n(44845),p=n(13861),j=n(73679),v=function(e){var t=e.allSystems,n=e.dataFlowSystems,r=e.onChange,i=e.flowType,o=(0,m.u6)().setFieldValue,a=function(e){if(!!n.find((function(t){return t.fides_key===e.fides_key}))){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));o("dataFlowSystems",t),r(t)}else{var s=[].concat((0,j.Z)(n),[{fides_key:e.fides_key,type:"system"}]);o("dataFlowSystems",s),r(s)}};return(0,x.jsx)(s.xuv,{overflowY:"auto",maxHeight:"300px",children:(0,x.jsxs)(s.iA_,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,x.jsx)(s.hrZ,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,x.jsxs)(s.Tr,{children:[(0,x.jsx)(s.Th,{children:"System"}),(0,x.jsxs)(s.Th,{textAlign:"right",children:["Set as ",i]})]})}),(0,x.jsx)(s.p3B,{children:t.map((function(e){var t=!!n.find((function(t){return t.fides_key===e.fides_key}));return(0,x.jsxs)(s.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,x.jsx)(s.Td,{children:(0,x.jsx)(s.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,x.jsx)(s.Td,{textAlign:"right",children:(0,x.jsx)(s.rsf,{isChecked:t,onChange:function(){return a(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},b=function(e){var t=e.currentSystem,n=e.systems,i=e.isOpen,a=e.onClose,c=e.dataFlowSystems,d=e.onDataFlowSystemChange,u=e.flowType,f=(0,m.u6)().setFieldValue,h=(0,r.useState)(""),y=h[0],j=h[1],b=(0,r.useState)(c),w=b[0],C=b[1],k=function(){var e=(0,o.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(w),a();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=0===n.length,_=(0,r.useMemo)((function(){return n?n.filter((function(e){return e.fides_key!==t.fides_key})).filter((function(e){return(0,p.R)(e,y)})):[]}),[n,t.fides_key,y]),O=(0,r.useMemo)((function(){var e=new Set(w.map((function(e){return e.fides_key})));return _.every((function(t){return e.has(t.fides_key)}))}),[_,w]);return(0,x.jsxs)(s.u_l,{isOpen:i,onClose:a,size:"2xl",isCentered:!0,children:[(0,x.jsx)(s.ZAr,{}),(0,x.jsxs)(s.hzk,{p:8,"data-testid":"confirmation-modal",children:[(0,x.jsxs)(s.xBx,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,x.jsxs)(s.xvT,{fontSize:"2xl",lineHeight:8,fontWeight:"semibold",children:["Configure ",u.toLocaleLowerCase()," systems"]}),(0,x.jsxs)(s.Cts,{bg:"green.500",color:"white",px:1,children:["Assigned to ",w.length," systems"]})]}),(0,x.jsx)(s.fef,{"data-testid":"assign-systems-modal-body",children:S?(0,x.jsx)(s.xvT,{children:"No systems found"}):(0,x.jsxs)(s.Kqy,{spacing:4,children:[(0,x.jsxs)(s.kCb,{justifyContent:"space-between",children:[(0,x.jsx)(s.xvT,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Add or remove destination systems from your data map"}),(0,x.jsx)(s.xuv,{children:(0,x.jsxs)(s.NIc,{display:"flex",alignItems:"center",children:[(0,x.jsx)(s.lXp,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,x.jsx)(s.rsf,{size:"sm",id:"assign-all-systems",isChecked:O,onChange:function(e){if(e.target.checked&&n){var t=_.map((function(e){return{fides_key:e.fides_key,type:"system"}}));f("dataFlowSystems",t),C(t)}else C([])},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,x.jsx)(g.Z,{search:y,onChange:j,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,x.jsx)(v,{flowType:u,allSystems:_,dataFlowSystems:w,onChange:C})]})}),(0,x.jsx)(s.mzw,{justifyContent:"flex-start",children:(0,x.jsxs)(s.hE2,{size:"sm",children:[(0,x.jsx)(s.zxk,{variant:"outline",mr:2,onClick:a,"data-testid":"cancel-btn",children:"Cancel"}),S?null:(0,x.jsx)(s.zxk,{colorScheme:"primary",onClick:k,"data-testid":"confirm-btn",children:"Confirm"})]})})]})]})},w=n(24753),C=n(6848),k=n(48466),S=n(51860);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T={dataFlowSystems:[]},z=function(e){var t=e.system,n=e.isIngress,i=e.isSystemTab,c=(0,s.pmc)(),h=n?"Source":"Destination",g="".concat(h,"s"),p=(0,s.qY0)(),j=(0,k.qQ)(),v=(0,a.Z)(j,1)[0];(0,k.K3)();var _=(0,C.C)(S.cS),z=(0,r.useMemo)((function(){var e=n?t.ingress:t.egress;e||(e=[]);var s=_?_.map((function(e){return e.fides_key})):[];return e.filter((function(e){return s.includes(e.fides_key)}))}),[n,t,_]),D=(0,r.useState)(z),F=D[0],Z=D[1];(0,r.useEffect)((function(){Z(z)}),[z]);var L=function(){var e=(0,o.Z)(l().mark((function e(s,r){var i,o,a,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.dataFlowSystems,o=r.resetForm,a=O(O({},t),{},{ingress:n?i:t.ingress,egress:n?t.egress:i}),e.next=5,v(a);case 5:u=e.sent,(0,d.D4)(u)?c((0,w.Vo)("Failed to update data flows")):c((0,w.t5)("".concat(g," updated"))),o({values:{dataFlowSystems:i}});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,x.jsxs)(s.Qdk,{children:[(0,x.jsx)(s.KFZ,{height:"68px",paddingLeft:i?6:2,"data-testid":"data-flow-button-".concat(h),children:(0,x.jsxs)(s.kCb,{alignItems:"center",justifyContent:"start",flex:1,textAlign:"left",children:[(0,x.jsx)(s.xvT,{fontSize:"sm",lineHeight:5,fontWeight:"semibold",mr:2,children:g}),(0,x.jsx)(s.Vp9,{ml:2,backgroundColor:"primary.400",borderRadius:"6px",color:"white",children:F.length}),(0,x.jsx)(s.LZC,{}),(0,x.jsx)(s.XEm,{})]})}),(0,x.jsx)(s.Hk3,{backgroundColor:"gray.50",padding:6,"data-testid":"data-flow-panel-".concat(h),children:(0,x.jsx)(s.Kqy,{borderRadius:"md",backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:(0,x.jsx)(m.J9,{initialValues:T,onSubmit:L,children:function(e){var n=e.isSubmitting,r=e.dirty,i=e.resetForm;return(0,x.jsxs)(m.l0,{children:[(0,x.jsx)(u.Gt,{id:"".concat(t.fides_key,":").concat(h),name:"".concat(h," Data Flow")}),(0,x.jsx)(s.zxk,{colorScheme:"primary",size:"xs",width:"fit-content",onClick:p.onOpen,"data-testid":"assign-systems-btn",rightIcon:(0,x.jsx)(f.A5,{}),marginBottom:4,children:"Configure ".concat(g.toLocaleLowerCase())}),(0,x.jsx)(y,{systems:_,dataFlows:F,onDataFlowSystemChange:Z}),(0,x.jsxs)(s.hE2,{marginTop:6,children:[(0,x.jsx)(s.zxk,{size:"sm",variant:"outline",disabled:!r&&F===z,onClick:function(){Z(z),i({values:{dataFlowSystems:z}})},children:"Cancel"}),(0,x.jsx)(s.zxk,{size:"sm",colorScheme:"primary",type:"submit",isLoading:n,disabled:!r&&F===z,"data-testid":"save-btn",children:"Save"})]}),p.isOpen?(0,x.jsx)(b,{currentSystem:t,systems:_,isOpen:p.isOpen,onClose:p.onClose,dataFlowSystems:F,onDataFlowSystemChange:Z,flowType:h}):null]})}})})})]})},D=function(e){var t=e.system,n=e.isSystemTab;return(0,x.jsxs)(s.UQy,{allowToggle:!0,"data-testid":"data-flow-accordion",children:[(0,x.jsx)(z,{system:t,isIngress:!0,isSystemTab:n}),(0,x.jsx)(z,{system:t,isSystemTab:n})]})}},13861:function(e,t,n){"use strict";n.d(t,{R:function(){return k},Z:function(){return S}});var s=n(28841),r=n(27378),i=n(33571),o=n.n(i),a=n(24246),c=function(e){var t=e.columns,n=e.items,r=e.renderItem,i=(0,s.yo_)(n,t);return(0,a.jsx)(s.xuv,{children:i.map((function(e,n,i){var c=i.length;return(0,a.jsx)(s.xuv,{className:o()["grid-row"],borderBottomWidth:c>1&&n===c-1&&e.length===t?"0.5px":void 0,children:(0,a.jsx)(s.MIq,{columns:t,children:e.map((function(e){return(0,a.jsx)(s.xuv,{className:o()["grid-item"],children:r(e)},JSON.stringify(e))}))})},JSON.stringify(e))}))})},l=n(44845),d=n(55732),u=n(97865),f=n(34707),h=n.n(f),m=n(79894),x=n.n(m),y=n(86677),g=n(6848),p=n(2458),j=n(60709),v=n(78624),b=n(24753),w=n(51860),C=function(e){var t=e.system,n=(0,s.qY0)(),r=n.isOpen,i=n.onOpen,o=n.onClose,c=(0,s.pmc)(),l=(0,g.T)(),f=(0,y.useRouter)(),m=(0,w.DW)(),C=(0,u.Z)(m,1)[0],k=function(){var e=(0,d.Z)(h().mark((function e(){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t.fides_key);case 2:n=e.sent,(0,v.D4)(n)?c((0,b.Vo)((0,v.e$)(n.error))):c((0,b.t5)("Successfully deleted system")),o();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=""===t.name||null==t.name?t.fides_key:t.name;return(0,a.jsxs)(s.xuv,{display:"flex","data-testid":"system-".concat(t.fides_key),children:[(0,a.jsx)(x(),{href:"".concat(j.So,"/configure/").concat(t.fides_key),passHref:!0,children:(0,a.jsxs)(s.xuv,{flexGrow:1,p:4,"data-testid":"system-box",_hover:{cursor:"pointer"},children:[(0,a.jsx)(s.X6q,{as:"h2",fontSize:"16px",mb:2,children:S}),(0,a.jsx)(s.xuv,{color:"gray.600",fontSize:"14px",children:(0,a.jsx)(s.xvT,{children:t.description})})]})}),(0,a.jsxs)(s.v2r,{children:[(0,a.jsx)(s.j2t,{as:s.hU,icon:(0,a.jsx)(s.nXP,{}),"aria-label":"more actions",variant:"unstyled",size:"sm","data-testid":"more-btn",m:1}),(0,a.jsxs)(s.qyq,{children:[(0,a.jsx)(s.sNh,{onClick:function(){l((0,w.db)(t)),f.push("".concat(j.So,"/configure/").concat(t.fides_key))},"data-testid":"edit-btn",children:"Edit"}),(0,a.jsx)(s.sNh,{onClick:i,"data-testid":"delete-btn",children:"Delete"})]})]}),(0,a.jsx)(p.Z,{isOpen:r,onClose:o,onConfirm:k,title:"Delete ".concat(S),message:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.xvT,{children:["You are about to permanently delete the system"," ",(0,a.jsx)(s.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:S}),"."]}),(0,a.jsx)(s.xvT,{children:"Are you sure you would like to continue?"})]})})]})},k=function(e,t){var n,s;return(null===(n=e.name)||void 0===n?void 0:n.toLocaleLowerCase().includes(t.toLocaleLowerCase()))||(null===(s=e.description)||void 0===s?void 0:s.toLocaleLowerCase().includes(t.toLocaleLowerCase()))},S=function(e){var t=e.systems,n=(0,r.useState)(""),i=n[0],o=n[1],d=(0,r.useMemo)((function(){return t?t.filter((function(e){return k(e,i)})):[]}),[t,i]);return t&&t.length?(0,a.jsxs)(s.xuv,{"data-testid":"system-management",children:[(0,a.jsx)(s.xuv,{mb:4,"data-testid":"system-filters",children:(0,a.jsx)(l.Z,{search:i,onChange:o,maxWidth:"30vw",placeholder:"Search system name or description","data-testid":"system-search",withIcon:!0})}),(0,a.jsx)(c,{columns:3,items:d,renderItem:function(e){return(0,a.jsx)(C,{system:e})}})]}):(0,a.jsx)("div",{"data-testid":"empty-state",children:"No systems registered."})}},40397:function(e,t,n){"use strict";n.d(t,{f:function(){return c}});var s=n(6848),r=n(47134),i=n(75846),o=n(45128),a=n(75523),c=function(e){var t=e.includeDatasets,n=e.includeDisabled,c=(0,a.MO)().isLoading,l=(0,r.te)().isLoading,d=(0,i.fd)().isLoading,u=(0,o.LH)({onlyUnlinkedDatasets:!1},{skip:!t}).isLoading,f=(0,s.C)(a.qb),h=(0,s.C)(a.Bd),m=(0,s.C)(r.ZL),x=(0,s.C)(r.H7),y=(0,s.C)(i.U3),g=(0,s.C)(i.jp),p=(0,s.C)(o.Q4);return{allDataCategories:n?f:h,allDataSubjects:n?m:x,allDataUses:n?y:g,allDatasets:t?p:void 0,isLoading:c||l||d||u}}},33167:function(e,t,n){"use strict";n.d(t,{isAPIError:function(){return s.Bw},isErrorResult:function(){return s.D4}});var s=n(60041)},33571:function(e){e.exports={"grid-row":"BorderGrid_grid-row__gzSVf","grid-item":"BorderGrid_grid-item__7gUTW"}}}]);