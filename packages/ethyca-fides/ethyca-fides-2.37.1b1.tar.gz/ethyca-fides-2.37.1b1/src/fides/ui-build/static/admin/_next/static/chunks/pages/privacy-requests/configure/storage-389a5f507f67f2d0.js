(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5979],{6719:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r=n(27378),i=n(25773),o=n(36924),s=n(38097),a=n(50189),c=n(70409),u=n(53782),l=n(53991),d=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=String(e).toLowerCase(),i=String(n.getOptionValue(t)).toLowerCase(),o=String(n.getOptionLabel(t)).toLowerCase();return i===r||o===r},p={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n,r){return!(!e||t.some((function(t){return f(e,t,r)}))||n.some((function(t){return f(e,t,r)})))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}};n(31542),n(92486);var v=(0,r.forwardRef)((function(e,t){var n=function(e){var t=e.allowCreateWhileLoading,n=void 0!==t&&t,i=e.createOptionPosition,s=void 0===i?"last":i,f=e.formatCreateLabel,v=void 0===f?p.formatCreateLabel:f,h=e.isValidNewOption,m=void 0===h?p.isValidNewOption:h,g=e.getNewOptionData,j=void 0===g?p.getNewOptionData:g,b=e.onCreateOption,x=e.options,y=void 0===x?[]:x,w=e.onChange,O=(0,u.Z)(e,d),_=O.getOptionValue,k=void 0===_?o.g:_,C=O.getOptionLabel,S=void 0===C?o.b:C,P=O.inputValue,D=O.isLoading,Z=O.isMulti,E=O.value,z=O.name,A=(0,r.useMemo)((function(){return m(P,(0,l.I)(E),y,{getOptionValue:k,getOptionLabel:S})?j(P,v(P)):void 0}),[v,j,S,k,P,m,y,E]),q=(0,r.useMemo)((function(){return!n&&D||!A?y:"first"===s?[A].concat((0,c.Z)(y)):[].concat((0,c.Z)(y),[A])}),[n,s,D,A,y]),L=(0,r.useCallback)((function(e,t){if("select-option"!==t.action)return w(e,t);var n=Array.isArray(e)?e:[e];if(n[n.length-1]!==A)w(e,t);else if(b)b(P);else{var r=j(P,P),i={action:"create-option",name:z,option:r};w((0,l.D)(Z,[].concat((0,c.Z)((0,l.I)(E)),[r]),r),i)}}),[j,P,Z,z,A,b,w,E]);return(0,a.Z)((0,a.Z)({},O),{},{options:q,onChange:L})}((0,s.u)(e));return r.createElement(o.S,(0,i.Z)({ref:t},n))})),h=n(32916);function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}var g=(0,r.forwardRef)((function(e,t){var n=(0,h.Z)(e);return r.createElement(v,m({ref:t},n))}))},9408:function(e,t,n){"use strict";n.d(t,{HK:function(){return o},VY:function(){return r.V},O3:function(){return a}});var r=n(36653),i=n(78624),o=function(){var e=(0,r.V)().errorAlert;return{handleError:function(t){var n="An unexpected error occurred. Please try again.";(0,i.Ot)(t)?n=t.data.detail:(0,i.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}},s=n(27378),a=function(e){var t=(0,s.useRef)(void 0);return(0,s.useEffect)((function(){var n=function(n){var r;null!==(r=t.current)&&void 0!==r&&r.contains(n.target)||e()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[t,e]),{ref:t}}},36653:function(e,t,n){"use strict";n.d(t,{V:function(){return c}});var r=n(90849),i=n(28841),o=n(24246);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=function(){var e=(0,i.pmc)();return{errorAlert:function(t,n,r){var s=a(a({},r),{},{position:(null===r||void 0===r?void 0:r.position)||"top",render:function(e){var r=e.onClose;return(0,o.jsxs)(i.bZj,{alignItems:"normal",status:"error",children:[(0,o.jsx)(i.zMQ,{}),(0,o.jsxs)(i.xuv,{children:[n&&(0,o.jsx)(i.CdC,{children:n}),(0,o.jsx)(i.XaZ,{children:t})]}),(0,o.jsx)(i.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}});null!==r&&void 0!==r&&r.id&&e.isActive(r.id)?e.update(r.id,s):e(s)},successAlert:function(t,n,r){var s=a(a({},r),{},{position:(null===r||void 0===r?void 0:r.position)||"top",render:function(e){var r=e.onClose;return(0,o.jsxs)(i.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,o.jsx)(i.zMQ,{}),(0,o.jsxs)(i.xuv,{children:[n&&(0,o.jsx)(i.CdC,{children:n}),(0,o.jsx)(i.XaZ,{children:t})]}),(0,o.jsx)(i.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}});null!==r&&void 0!==r&&r.id&&e.isActive(r.id)?e.update(r.id,s):e(s)}}}},56069:function(e,t,n){"use strict";n.d(t,{R:function(){return p}});var r=n(90849),i=n(90089),o=n(28841),s=n(79894),a=n.n(s),c=n(24246),u=["backPath"],l=["onClick"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(e){var t=e.onClick,n=(0,i.Z)(e,l);return(0,c.jsxs)(o.kCb,f(f({alignItems:"center",mt:-4,mb:3,onClick:t,cursor:"pointer"},n),{},{children:[(0,c.jsx)(o.hU,{"aria-label":"Back",icon:(0,c.jsx)(o.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,c.jsx)(o.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]}))};t.Z=function(e){var t=e.backPath,n=(0,i.Z)(e,u);return(0,c.jsxs)(o.kCb,f(f({alignItems:"center",mb:6},n),{},{children:[(0,c.jsx)(a(),{href:t,passHref:!0,children:(0,c.jsx)(o.hU,{"aria-label":"Back",icon:(0,c.jsx)(o.Rpv,{}),mr:2,size:"xs",variant:"outline"})}),(0,c.jsx)(a(),{href:t,passHref:!0,children:(0,c.jsx)(o.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})})]}))}},24330:function(e,t,n){"use strict";n.d(t,{DE:function(){return o},MP:function(){return r},qX:function(){return i}});var r=new Map([["Approved","approved"],["Canceled","canceled"],["Completed","complete"],["Denied","denied"],["Error","error"],["In Progress","in_processing"],["New","pending"],["Paused","paused"],["Unverified","identity_unverified"],["Requires input","requires_input"]]),i={mailgun:"mailgun",twilio_email:"twilio_email",twilio_text:"twilio_text"},o={local:"local",s3:"s3"}},70810:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var r=n(55732),i=n(97865),o=n(34707),s=n.n(o),a=n(28841),c=n(27378),u=n(78624),l=n(9408),d=n(51471),f=n(56069),p=n(60709),v=n(24330),h=n(51365),m=n(34090),g=n(43139),j=n(24246),b=function(e){var t,n,o,d,f,p=e.storageDetails,b=(0,c.useState)(""),x=b[0],y=b[1],w=(0,h.gC)(),O=(0,i.Z)(w,1)[0],_=(0,h.cf)(),k=(0,i.Z)(_,1)[0],C=(0,l.HK)().handleError,S=(0,l.VY)().successAlert,P={type:v.DE.s3,auth_method:null!==(t=null===p||void 0===p||null===(n=p.details)||void 0===n?void 0:n.auth_method)&&void 0!==t?t:"",bucket:null!==(o=null===p||void 0===p||null===(d=p.details)||void 0===d?void 0:d.bucket)&&void 0!==o?o:"",format:null!==(f=null===p||void 0===p?void 0:p.format)&&void 0!==f?f:""},D=function(){var e=(0,r.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({type:v.DE.s3,details:{auth_method:t.auth_method,bucket:t.bucket},format:t.format});case 2:n=e.sent,(0,u.D4)(n)?C(n.error):(y(t.auth_method),S("S3 storage credentials successfully updated."));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,r.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k({details:{aws_access_key_id:t.aws_access_key_id,aws_secret_access_key:t.aws_secret_access_key},type:v.DE.s3});case 2:n=e.sent,(0,u.D4)(n)?C(n.error):S("S3 storage secrets successfully updated.");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"S3 storage configuration"}),(0,j.jsx)(a.Kqy,{children:(0,j.jsx)(m.J9,{initialValues:P,onSubmit:D,enableReinitialize:!0,children:function(e){var t=e.isSubmitting,n=e.handleReset;return(0,j.jsxs)(m.l0,{children:[(0,j.jsxs)(a.Kqy,{mt:5,spacing:5,children:[(0,j.jsx)(g.AP,{name:"format",label:"Format",options:[{label:"json",value:"json"},{label:"csv",value:"csv"}],"data-testid":"format",isRequired:!0}),(0,j.jsx)(g.AP,{name:"auth_method",label:"Auth method",options:[{label:"secret_keys",value:"secret_keys"},{label:"automatic",value:"automatic"}],"data-testid":"auth_method",isRequired:!0}),(0,j.jsx)(g.j0,{"data-testid":"bucket",name:"bucket",label:"Bucket",isRequired:!0})]}),(0,j.jsx)(a.zxk,{onClick:function(){return n()},mt:5,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,j.jsx)(a.zxk,{mt:5,isDisabled:t,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})}})}),"secret_keys"===x?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(a.izJ,{mt:5}),(0,j.jsx)(a.X6q,{fontSize:"md",fontWeight:"semibold",mt:5,children:"Storage destination"}),(0,j.jsx)(a.Kqy,{children:(0,j.jsx)(m.J9,{initialValues:{aws_access_key_id:"",aws_secret_access_key:""},onSubmit:Z,children:function(e){var t=e.isSubmitting,n=e.handleReset;return(0,j.jsxs)(m.l0,{children:[(0,j.jsxs)(a.Kqy,{mt:5,spacing:5,children:[(0,j.jsx)(g.j0,{name:"aws_access_key_id",label:"AWS access key ID"}),(0,j.jsx)(g.j0,{name:"aws_secret_access_key",label:"AWS secret access key",type:"password"})]}),(0,j.jsxs)(a.xuv,{mt:10,children:[(0,j.jsx)(a.zxk,{onClick:function(){return n()},mt:5,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,j.jsx)(a.zxk,{mt:5,isDisabled:t,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null]})},x=function(){var e=(0,l.VY)().successAlert,t=(0,l.HK)().handleError,n=(0,c.useState)(""),o=n[0],m=n[1],g=(0,h.PW)().data,x=(0,h.Au)({type:o}).data,y=(0,h.gC)(),w=(0,i.Z)(y,2),O=w[0],_=w[1].isLoading,k=(0,h.L)(),C=(0,i.Z)(k,1)[0];(0,c.useEffect)((function(){g&&m(g.type)}),[g]);var S=function(){var n=(0,r.Z)(s().mark((function n(r){var i,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r!==v.DE.local){n.next=5;break}return n.next=3,O({type:r,details:{},format:"json"});case 3:i=n.sent,(0,u.D4)(i)?t(i.error):e("Configured storage details successfully.");case 5:return n.next=7,C({storage:{active_default_storage_type:r}});case 7:o=n.sent,(0,u.D4)(o)?t(o.error):m(r);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,j.jsxs)(d.Z,{title:"Configure Privacy Requests - Storage",children:[(0,j.jsx)(f.Z,{backPath:p.fz}),(0,j.jsx)(a.X6q,{mb:5,fontSize:"2xl",fontWeight:"semibold",children:"Configure storage"}),(0,j.jsxs)(a.xuv,{display:"flex",flexDirection:"column",width:"50%",children:[(0,j.jsx)(a.xuv,{mb:5,children:"Fides requires a storage destination to store and share the results of privacy requests. For a production setup, it is highly recommended to have S3 as a storage destination. Ensure you have completed the setup for the storage destination and have the details handy prior to the following steps."}),(0,j.jsxs)(a.xuv,{children:["To configure a Storage destination, first choose a method to store your results. Fides currently supports"," ",(0,j.jsx)(a.xvT,{as:"span",color:"complimentary.500",children:"Local"})," ","and"," ",(0,j.jsx)(a.xvT,{as:"span",color:"complimentary.500",children:"S3"})," ","storage methods."]}),(0,j.jsx)(a.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose storage type to configure"}),(0,j.jsx)(a.FXm,{isDisabled:_,onChange:S,value:o,"data-testid":"privacy-requests-storage-selection",colorScheme:"secondary",p:3,children:(0,j.jsxs)(a.Kqy,{direction:"row",children:[(0,j.jsx)(a.Y8K,{value:"local","data-testid":"option-local",mr:5,children:"Local"},"local"),(0,j.jsx)(a.Y8K,{value:"s3","data-testid":"option-s3",children:"S3"},"s3")]})}),"s3"===o&&x?(0,j.jsx)(b,{storageDetails:x}):null]})]})},y=function(){return(0,j.jsx)(x,{})}},23663:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/storage",function(){return n(70810)}])},76649:function(e,t,n){"use strict";n.d(t,{Ln:function(){return r},uX:function(){return s}});const r=(e,t)=>o(e,t),i=Symbol("SOME"),o=(e,t)=>{if("string"==typeof e)return e===typeof t;if(Array.isArray(e))return i in e?e.some((e=>o(e,t))):!!Array.isArray(t)&&(0===e.length||t.every((t=>e.some((e=>o(e,t))))));if("object"!=typeof t||null===t)return!1;const n=t;return Object.entries(e).every((([e,t])=>o(t,n[e])))},s=e=>t=>r(e,t);class a{static narrow(e){return new a((t=>r(e,t)))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){const t=this.NF,n=e instanceof a?e.NF:e instanceof Function?e:t=>r(e,t);return new a((e=>t(e)&&n(e)))}}new a((e=>!0))}},function(e){e.O(0,[338,3702,9774,2888,179],(function(){return t=23663,e(e.s=t);var t}));var t=e.O();_N_E=t}]);