{"version":3,"file":"lib_index_js.6d260d13830c11b24eef.js","mappings":"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","sources":["webpack://onyx_extension/./src/App.tsx","webpack://onyx_extension/./src/handler.ts","webpack://onyx_extension/./src/icon.ts","webpack://onyx_extension/./src/index.ts"],"sourcesContent":["import React from 'react';\r\nimport { ReactWidget } from '@jupyterlab/apputils';\r\n//import App from '../../react-prototype/src/App'\r\nimport Onyx from 'climb-onyx-ui';\r\n\r\nexport class ReactAppWidget extends ReactWidget {\r\n  constructor(dom: string, tok: string, s3: (path: string) => void) {\r\n    super();\r\n    this.domain = dom;\r\n    this.token = tok;\r\n    this.s3PathHandler= s3;\r\n  }\r\n\r\n  domain: string;\r\n  token: string;\r\n  s3PathHandler: (path: string) => void;\r\n\r\n  render(): JSX.Element {\r\n    return <Onyx domain={this.domain} token={this.token} s3PathHandler={this.s3PathHandler} />;\r\n  }\r\n}\r\n","import { ServerConnection } from '@jupyterlab/services';\nimport { URLExt } from '@jupyterlab/coreutils';\n\n/**\n * Call the API extension\n *\n * @param endPoint API REST end point for the extension\n * @param init Initial values for the request\n * @returns The response body interpreted as JSON\n */\nexport async function requestAPI<T>(\n  endPoint = '',\n  init: RequestInit = {},\n  param: [string, string] = ['', '']\n): Promise<T> {\n  // Make request to Jupyter API\n  const settings = ServerConnection.makeSettings();\n\n  const requestUrl = URLExt.join(settings.baseUrl, 'onyx-extension', endPoint);\n\n  let url = new URL(requestUrl);\n  if (param[0] != '') url.searchParams.append(param[0], param[1]);\n\n  let response: Response;\n  try {\n    response = await ServerConnection.makeRequest(\n      url.toString(),\n      init,\n      settings\n    );\n  } catch (error) {\n    throw new ServerConnection.NetworkError(error as any);\n  }\n\n  let data: any = await response.text();\n\n  if (data.length > 0) {\n    try {\n      data = JSON.parse(data);\n    } catch (error) {\n      console.log('Not a JSON response body.', response);\n    }\n  }\n\n  if (!response.ok) {\n    throw new ServerConnection.ResponseError(response, data.message || data);\n  }\n\n  return data;\n}\n","import { LabIcon } from '@jupyterlab/ui-components';\nimport CHAT_ICON from './../style/icons/dna.svg';\n\nexport const chatIcon = new LabIcon({\n  name: 'jitsi:chat',\n  svgstr: CHAT_ICON\n});\n","import {\r\n  JupyterFrontEnd,\r\n  JupyterFrontEndPlugin\r\n} from '@jupyterlab/application';\r\n\r\nimport {\r\n  ICommandPalette,\r\n  MainAreaWidget,\r\n  WidgetTracker,\r\n  showDialog,\r\n  Dialog\r\n} from '@jupyterlab/apputils';\r\n\r\nimport { IDocumentManager } from '@jupyterlab/docmanager';\r\nimport { HTMLViewer, IHTMLViewerTracker } from '@jupyterlab/htmlviewer';\r\n\r\nimport { ILauncher } from '@jupyterlab/launcher';\r\n\r\nimport { requestAPI } from './handler';\r\nimport { ReactAppWidget } from './App';\r\nimport { chatIcon } from './icon';\r\nimport { Widget } from '@lumino/widgets';\r\n\r\nclass OpenS3FileWidget extends Widget {\r\n  constructor() {\r\n    const body = document.createElement('div');\r\n    const existingLabel = document.createElement('label');\r\n    existingLabel.textContent = 'S3 file name:';\r\n\r\n    const input = document.createElement('input');\r\n    input.value = '';\r\n    input.placeholder = 's3://example-bucket/example-file.html';\r\n\r\n    body.appendChild(existingLabel);\r\n    body.appendChild(input);\r\n\r\n    super({ node: body });\r\n  }\r\n\r\n  get inputNode() {\r\n    return this.node.getElementsByTagName('input')[0];\r\n  }\r\n\r\n  getValue() {\r\n    return this.inputNode.value;\r\n  }\r\n}\r\n\r\n/**\r\n * Initialization data for the onyx_extension extension.\r\n */\r\nconst plugin: JupyterFrontEndPlugin<void> = {\r\n  id: 'onyx_extension:plugin',\r\n  description: 'Onyx-extension.',\r\n  autoStart: true,\r\n  optional: [ILauncher, IHTMLViewerTracker],\r\n  requires: [ICommandPalette, IDocumentManager],\r\n  activate: (\r\n    app: JupyterFrontEnd,\r\n    palette: ICommandPalette,\r\n    documentManager: IDocumentManager,\r\n    launcher: ILauncher | null,\r\n    htmlTracker: IHTMLViewerTracker | null\r\n  ) => {\r\n    console.log('JupyterLab extension @onyx_extension is activated!');\r\n\r\n    const command = 'onyx_extension';\r\n    const s3_command = 's3_onyx_extension';\r\n    const category = 'Onyx';\r\n\r\n    let domain: string;\r\n    let token: string;\r\n\r\n    const s3_open_function = (s3_link: string) => {\r\n      requestAPI<any>('s3', {}, ['s3location', s3_link])\r\n        .then(data => {\r\n          documentManager.open(data['temp_file']);\r\n        })\r\n        .catch(reason => {\r\n          console.error(\r\n            `The onyx_extension server extension appears to be missing.\\n${reason}`\r\n          );\r\n        });\r\n    };\r\n\r\n    requestAPI<any>('settings')\r\n      .then(data => {\r\n        domain = data['domain'];\r\n        token = data['token'];\r\n      })\r\n      .catch(reason => {\r\n        console.error(\r\n          `The onyx_extension server extension appears to be missing.\\n${reason}`\r\n        );\r\n      });\r\n\r\n      \r\n    requestAPI<any>('reroute', {}, ['route', 'https://onyx-test.climb.ac.uk/projects/'])\r\n    .then(data => {\r\n      console.log(data)\r\n    })\r\n    .catch(reason => {\r\n      console.error(\r\n        `The onyx_extension could not redirect.\\n${reason}`\r\n      );\r\n    });\r\n\r\n    // Create a single widget\r\n    let widget: MainAreaWidget<ReactAppWidget>;\r\n\r\n    app.commands.addCommand(command, {\r\n      label: 'Onyx',\r\n      caption: 'Onyx',\r\n      icon: chatIcon,\r\n      execute: () => {\r\n        if (!widget || widget.disposed) {\r\n          const content = new ReactAppWidget(domain, token, s3_open_function);\r\n          content.addClass('onyx-Widget');\r\n          widget = new MainAreaWidget({ content });\r\n          widget.title.label = 'Onyx';\r\n          widget.title.closable = true;\r\n        }\r\n        if (!tracker.has(widget)) {\r\n          tracker.add(widget);\r\n        }\r\n        if (!widget.isAttached) {\r\n          // Attach the widget to the main work area if it's not there\r\n          app.shell.add(widget, 'main');\r\n        }\r\n\r\n        // Activate the widget\r\n        app.shell.activateById(widget.id);\r\n      }\r\n    });\r\n\r\n    palette.addItem({ command, category: category });\r\n\r\n    if (launcher) {\r\n      launcher.add({\r\n        command: command,\r\n        category: category\r\n      });\r\n    }\r\n\r\n    app.commands.addCommand(s3_command, {\r\n      label: 'Onyx open s3 document',\r\n      caption: 'Onyx open s3 document',\r\n      icon: chatIcon,\r\n      execute: () => {\r\n        showDialog({\r\n          body: new OpenS3FileWidget(),\r\n          buttons: [Dialog.cancelButton(), Dialog.okButton({ label: 'GO' })],\r\n          focusNodeSelector: 'input',\r\n          title: 'Open site'\r\n        })\r\n          .then(result => {\r\n            if (result.button.label === 'Cancel') {\r\n              return;\r\n            }\r\n            if (!result.value) {\r\n              return;\r\n            }\r\n            const s3_link = result.value;\r\n            s3_open_function(s3_link);\r\n          })\r\n          .catch(reason => {\r\n            console.error(\r\n              `The onyx_extension server extension appears to be missing.\\n${reason}`\r\n            );\r\n          });\r\n      }\r\n    });\r\n\r\n    palette.addItem({ command: s3_command, category: category });\r\n\r\n    if (launcher) {\r\n      launcher.add({\r\n        command: s3_command,\r\n        category: category\r\n      });\r\n    }\r\n\r\n    if (htmlTracker) {\r\n      htmlTracker.widgetAdded.connect((sender, panel: HTMLViewer) => {\r\n        panel.trusted = true;\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nconst tracker = new WidgetTracker<MainAreaWidget<ReactAppWidget>>({\r\n  namespace: 'onyx_extension'\r\n});\r\n\r\nexport default plugin;\r\n"],"names":[],"sourceRoot":""}