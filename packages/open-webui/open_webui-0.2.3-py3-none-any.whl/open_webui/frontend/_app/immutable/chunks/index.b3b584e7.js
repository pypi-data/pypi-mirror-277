import"./sha256.8dba905a.js";let m;const D=new Uint8Array(16);function F(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(D)}const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function v(t,e=0){return o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]}const C=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),w={randomUUID:C};function T(t,e,n){if(w.randomUUID&&!e&&!t)return w.randomUUID();t=t||{};const s=t.random||(t.rng||F)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){n=n||0;for(let r=0;r<16;++r)e[n+r]=s[r];return e}return v(s)}const E=t=>t.replace(/<\|[a-z]*$/,"").replace(/<\|[a-z]+\|$/,"").replace(/<$/,"").replaceAll(/<\|[a-z]+\|>/g," ").replaceAll("<","&lt;").replaceAll(">","&gt;").trim(),N=t=>t.replaceAll("&lt;","<").replaceAll("&gt;",">"),z=t=>{let e="";return new TransformStream({transform(n,s){e+=n;const r=e.split(t);r.slice(0,-1).forEach(a=>s.enqueue(a)),e=r[r.length-1]},flush(n){e&&n.enqueue(e)}})},$=t=>{const e={messages:{},currentId:null};let n=null,s=null;for(const r of t)s=T(),n!==null&&(e.messages[n].childrenIds=[...e.messages[n].childrenIds,s]),e.messages[s]={...r,id:s,parentId:n,childrenIds:[]},n=s;return e.currentId=s,e},M=()=>{const t=document.createElement("canvas"),e=t.getContext("2d");t.height=1,t.width=1;const n=new ImageData(t.width,t.height),s=n.data;for(let a=0;a<n.data.length;a+=1)a%4!==3?s[a]=Math.floor(256*Math.random()):s[a]=255;e.putImageData(n,0,0);const r=e.getImageData(0,0,t.width,t.height).data;for(let a=0;a<r.length;a+=1)if(r[a]!==s[a])return console.log("canvasPixelTest: Wrong canvas pixel RGB value detected:",r[a],"at:",a,"expected:",s[a]),console.log("canvasPixelTest: Canvas blocking or spoofing is likely"),!1;return!0},O=t=>{const e=document.createElement("canvas"),n=e.getContext("2d");if(e.width=100,e.height=100,!M())return console.log("generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image."),"/user.png";n.fillStyle="#F39C12",n.fillRect(0,0,e.width,e.height),n.fillStyle="#FFFFFF",n.font="40px Helvetica",n.textAlign="center",n.textBaseline="middle";const s=t.trim(),r=s.length>0?s[0]+(s.split(" ").length>1?s[s.lastIndexOf(" ")+1]:""):"";return n.fillText(r.toUpperCase(),e.width/2,e.height/2),e.toDataURL()},V=async t=>{let e=!1;if(!navigator.clipboard){const n=document.createElement("textarea");n.value=t,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{const r=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+r),e=!0}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),e}return e=await navigator.clipboard.writeText(t).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(n=>(console.error("Async: Could not copy text: ",n),!1)),e},W=(t,e)=>e==="0.0.0"?!1:e.localeCompare(t,void 0,{numeric:!0,sensitivity:"case",caseFirst:"upper"})<0,Y=t=>{const e=/\[([^\]]+)\]/g,n=[];let s;for(;(s=e.exec(t))!==null;)n.push({word:s[1],startIndex:s.index,endIndex:e.lastIndex-1});return n},k=t=>{const e=t.split(" "),n=e.findIndex(r=>r.startsWith("#"));return n!==-1&&e.splice(n,1),e.join(" ")},H=t=>t.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"-"),_=t=>"mapping"in t[0]?"openai":"webui",U=t=>{var l,g,p,c,f,y,x,I;const e=t.mapping,n=[];let s="",r=null;for(let u in e){const i=e[u];s=u;try{if(n.length==0&&(i.message==null||((l=i.message.content.parts)==null?void 0:l[0])==""&&i.message.content.text==null))continue;{const h={id:u,parentId:r,childrenIds:i.children||[],role:((p=(g=i.message)==null?void 0:g.author)==null?void 0:p.role)!=="user"?"assistant":"user",content:((y=(f=(c=i.message)==null?void 0:c.content)==null?void 0:f.parts)==null?void 0:y[0])||((I=(x=i.message)==null?void 0:x.content)==null?void 0:I.text)||"",model:"gpt-3.5-turbo",done:!0,context:null};n.push(h),r=s}}catch(h){console.log("Error with",i,`
Error:`,h)}}let a={};return n.forEach(u=>a[u.id]=u),{history:{currentId:s,messages:a},models:["gpt-3.5-turbo"],messages:n,options:{},timestamp:t.create_time,title:t.title??"New Chat"}},b=t=>{const e=t.messages;if(e.length===0||e[e.length-1].childrenIds.length!==0||e[0].parentId!==null)return!1;for(let r of e)if(typeof r.content!="string")return!1;return!0},j=t=>{const e=[];let n=0;for(let s of t){const r=U(s);b(r)?e.push({id:s.id,user_id:"",title:s.title,chat:r,timestamp:s.timestamp}):n++}return console.log(n,"Conversations could not be imported"),e},P=t=>{let e;try{e=new URL(t)}catch{return!1}return e.protocol==="http:"||e.protocol==="https:"},R=t=>{const e=/[\uD800-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g;return t.replace(e,"")},q=t=>t.split(new RegExp("(?<=[.!?])")).map(n=>R(n.trim())).filter(n=>n!==""),B=(t,e)=>new File([t],e,{type:t.type}),S=(t,e,n)=>{const s=new Date,r=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0");return t=t.replace("{{CURRENT_DATE}}",r),e&&(t=t.replace("{{USER_NAME}}",e)),n&&(t=t.replace("{{CURRENT_LOCATION}}",n)),t},L=(t,e)=>(t=t.replace(/{{prompt}}|{{prompt:start:(\d+)}}|{{prompt:end:(\d+)}}|{{prompt:middletruncate:(\d+)}}/g,(n,s,r,a)=>{if(n==="{{prompt}}")return e;if(n.startsWith("{{prompt:start:"))return e.substring(0,s);if(n.startsWith("{{prompt:end:"))return e.slice(-r);if(n.startsWith("{{prompt:middletruncate:")){if(e.length<=a)return e;const d=e.slice(0,Math.ceil(a/2)),l=e.slice(-Math.floor(a/2));return`${d}...${l}`}return""}),t=S(t),t),G=t=>{const e=Math.floor(t/1e9%60),n=Math.floor(t/6e10%60),s=Math.floor(t/36e11%24),r=[];return e>=0&&r.push(`${e}s`),n>0&&r.push(`${n}m`),s>0&&r.push(`${s}h`),r.reverse().join(" ")},J=t=>{const e=new Date,n=new Date(t*1e3),r=(e.getTime()-n.getTime())/(1e3*3600*24),a=e.getDate(),d=e.getMonth(),l=e.getFullYear(),g=n.getDate(),p=n.getMonth(),c=n.getFullYear();return l===c&&d===p&&a===g?"Today":l===c&&d===p&&a-g===1?"Yesterday":r<=7?"Previous 7 days":r<=30?"Previous 30 days":l===c?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()};export{V as a,W as b,M as c,_ as d,j as e,Y as f,O as g,B as h,P as i,$ as j,E as k,L as l,G as m,q as n,N as o,S as p,J as q,k as r,z as s,H as t,v as u,T as v};
//# sourceMappingURL=index.b3b584e7.js.map
