import{s as Zt,E as le,F as ne,G as se,H as oe,w as ct,e as Ht,i as P,d as m,I as Be,x as re,y as Xl,p as bt,f as I,g as M,h as S,L as te,Y as ke,u as K,v as ie,U as Ae,C as It,P as ue,a as G,l as mt,R as Kt,c as J,m as ht,j as f,r as w,n as wt,K as ye,t as yt,W as Fe,z as gt,A as pt,X as Nt,Q as Qe,O as un,o as qe,S as we,B as fn,M as dn}from"./scheduler.e3781972.js";import{S as Gt,i as Jt,a as A,t as j,g as Ft,c as qt,h as Kl,j as xl,k as Ne,f as Ot,b as st,d as ot,m as rt,e as it}from"./index.2a4758a9.js";import{g as mn}from"./globals.7f7f1b26.js";import{e as ee}from"./each.9b39a839.js";import{a as _t}from"./Toaster.svelte_svelte_type_style_lang.143b8570.js";import{M as hn,m as gn}from"./Messages.61fa6383.js";import{f as Ye}from"./dayjs.min.a430b708.js";import{g as Pe}from"./navigation.ede83164.js";import{p as pn}from"./stores.c70cc432.js";import{p as _n,n as bn,e as Le,c as $l,f as ce,i as Oe,m as tn,a as He,S as Xe,r as Ke,W as en,h as ve,u as ln,j as vn,o as wn,g as Ce,O as Ue,v as xe}from"./index.cc83fece.js";import{f as nn,r as Re,i as $e,h as tl,v as el,p as ll,s as kn,a as nl,j as yn}from"./index.b3b584e7.js";import{q as En,r as Sn,s as In,t as Mn}from"./index.7807fac6.js";import{u as Dn,o as sl,c as Cn,b as Te,k as je,j as Tn,y as Vn}from"./index.442f0a66.js";import{A as Bn,u as Nn,a as On,b as Hn,r as An}from"./AddFilesPlaceholder.c0504c6f.js";import{t as ol}from"./index.5034e3e5.js";import"./sha256.8dba905a.js";import{T as me}from"./Tooltip.c9d840d7.js";import{h as sn,j as Ln,f as We}from"./updater.b09cefa0.js";import{D as on,M as Ve}from"./Dropdown.aa4b1a49.js";import{s as Pn,g as Un,u as Rn,a as jn,M as rn}from"./menu-trigger.0945a056.js";import{S as zn}from"./Switch.31f8d339.js";import"./i18next.16542173.js";import{T as Fn,S as qn,U as Wn,q as Zn}from"./UserMenu.00c27692.js";import{S as Gn}from"./Selector.85db894f.js";import{d as Jn}from"./index.a12474fa.js";import{g as Ee}from"./spread.8a54911c.js";import{f as Qn}from"./FileSaver.min.898eb36f.js";import{b as Yn}from"./index.7dad5de9.js";import"./paths.2a4f5834.js";import{M as Xn}from"./MenuLines.19647519.js";import{o as Kn}from"./index.ed263ccd.js";const xn=n=>({subIds:n&1}),rl=n=>({subIds:n[0]});function $n(n){let t;const e=n[6].default,l=le(e,n,n[5],rl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,[r]){l&&l.p&&(!t||r&33)&&ne(l,e,s,s[5],t?oe(e,s[5],r,xn):se(s[5]),rl)},i(s){t||(A(l,s),t=!0)},o(s){j(l,s),t=!1},d(s){l&&l.d(s)}}}function ts(n,t,e){let l,{$$slots:s={},$$scope:r}=t,{disabled:o=void 0}=t,{open:i=void 0}=t,{onOpenChange:a=void 0}=t;const{updateOption:u,ids:c,states:{subOpen:d}}=Pn({disabled:o,onOpenChange:({next:b})=>(i!==b&&(a==null||a(b),e(2,i=b)),b)}),y=Jn([c.menu,c.trigger],([b,p])=>({menu:b,trigger:p}));return ct(n,y,b=>e(0,l=b)),n.$$set=b=>{"disabled"in b&&e(3,o=b.disabled),"open"in b&&e(2,i=b.open),"onOpenChange"in b&&e(4,a=b.onOpenChange),"$$scope"in b&&e(5,r=b.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&i!==void 0&&d.set(i),n.$$.dirty&8&&u("disabled",o)},[l,y,i,o,a,r,s]}class es extends Gt{constructor(t){super(),Jt(this,t,ts,$n,Zt,{disabled:3,open:2,onOpenChange:4})}}const ls=n=>({builder:n[0]&256}),il=n=>({builder:n[8]}),ns=n=>({builder:n[0]&256}),al=n=>({builder:n[8]}),ss=n=>({builder:n[0]&256}),cl=n=>({builder:n[8]}),os=n=>({builder:n[0]&256}),ul=n=>({builder:n[8]}),rs=n=>({builder:n[0]&256}),fl=n=>({builder:n[8]}),is=n=>({builder:n[0]&256}),dl=n=>({builder:n[8]});function as(n){let t,e,l,s;const r=n[28].default,o=le(r,n,n[27],il);let i=[n[8],n[13]],a={};for(let u=0;u<i.length;u+=1)a=re(a,i[u]);return{c(){t=I("div"),o&&o.c(),this.h()},l(u){t=M(u,"DIV",{});var c=S(t);o&&o.l(c),c.forEach(m),this.h()},h(){te(t,a)},m(u,c){P(u,t,c),o&&o.m(t,null),n[33](t),e=!0,l||(s=[ke(n[8].action(t)),K(t,"m-focusout",n[12]),K(t,"m-keydown",n[12]),K(t,"m-pointermove",n[12])],l=!0)},p(u,c){o&&o.p&&(!e||c[0]&134217984)&&ne(o,r,u,u[27],e?oe(r,u[27],c,ls):se(u[27]),il),te(t,a=Ee(i,[c[0]&256&&u[8],c[0]&8192&&u[13]]))},i(u){e||(A(o,u),e=!0)},o(u){j(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[33](null),l=!1,ie(s)}}}function cs(n){let t,e,l,s,r;const o=n[28].default,i=le(o,n,n[27],al);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=re(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){te(t,u)},m(c,d){P(c,t,d),i&&i.m(t,null),n[32](t),l=!0,s||(r=[ke(n[8].action(t)),K(t,"m-focusout",n[12]),K(t,"m-keydown",n[12]),K(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&ne(i,o,n,n[27],l?oe(o,n[27],d,ns):se(n[27]),al),te(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(A(i,c),e&&e.end(1),l=!0)},o(c){j(i,c),c&&(e=Kl(t,n[5],n[6])),l=!1},d(c){c&&m(t),i&&i.d(c),n[32](null),c&&e&&e.end(),s=!1,ie(r)}}}function us(n){let t,e,l,s,r;const o=n[28].default,i=le(o,n,n[27],cl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=re(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){te(t,u)},m(c,d){P(c,t,d),i&&i.m(t,null),n[31](t),l=!0,s||(r=[ke(n[8].action(t)),K(t,"m-focusout",n[12]),K(t,"m-keydown",n[12]),K(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&ne(i,o,n,n[27],l?oe(o,n[27],d,ss):se(n[27]),cl),te(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(A(i,c),c&&(e||Ae(()=>{e=xl(t,n[3],n[4]),e.start()})),l=!0)},o(c){j(i,c),l=!1},d(c){c&&m(t),i&&i.d(c),n[31](null),s=!1,ie(r)}}}function fs(n){let t,e,l,s,r,o;const i=n[28].default,a=le(i,n,n[27],ul);let u=[n[8],n[13]],c={};for(let d=0;d<u.length;d+=1)c=re(c,u[d]);return{c(){t=I("div"),a&&a.c(),this.h()},l(d){t=M(d,"DIV",{});var y=S(t);a&&a.l(y),y.forEach(m),this.h()},h(){te(t,c)},m(d,y){P(d,t,y),a&&a.m(t,null),n[30](t),s=!0,r||(o=[ke(n[8].action(t)),K(t,"m-focusout",n[12]),K(t,"m-keydown",n[12]),K(t,"m-pointermove",n[12])],r=!0)},p(d,y){n=d,a&&a.p&&(!s||y[0]&134217984)&&ne(a,i,n,n[27],s?oe(i,n[27],y,os):se(n[27]),ul),te(t,c=Ee(u,[y[0]&256&&n[8],y[0]&8192&&n[13]]))},i(d){s||(A(a,d),d&&Ae(()=>{s&&(l&&l.end(1),e=xl(t,n[3],n[4]),e.start())}),s=!0)},o(d){j(a,d),e&&e.invalidate(),d&&(l=Kl(t,n[5],n[6])),s=!1},d(d){d&&m(t),a&&a.d(d),n[30](null),d&&l&&l.end(),r=!1,ie(o)}}}function ds(n){let t,e,l,s,r;const o=n[28].default,i=le(o,n,n[27],fl);let a=[n[8],n[13]],u={};for(let c=0;c<a.length;c+=1)u=re(u,a[c]);return{c(){t=I("div"),i&&i.c(),this.h()},l(c){t=M(c,"DIV",{});var d=S(t);i&&i.l(d),d.forEach(m),this.h()},h(){te(t,u)},m(c,d){P(c,t,d),i&&i.m(t,null),n[29](t),l=!0,s||(r=[ke(n[8].action(t)),K(t,"m-focusout",n[12]),K(t,"m-keydown",n[12]),K(t,"m-pointermove",n[12])],s=!0)},p(c,d){n=c,i&&i.p&&(!l||d[0]&134217984)&&ne(i,o,n,n[27],l?oe(o,n[27],d,rs):se(n[27]),fl),te(t,u=Ee(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(c){l||(A(i,c),c&&Ae(()=>{l&&(e||(e=Ne(t,n[1],n[2],!0)),e.run(1))}),l=!0)},o(c){j(i,c),c&&(e||(e=Ne(t,n[1],n[2],!1)),e.run(0)),l=!1},d(c){c&&m(t),i&&i.d(c),n[29](null),c&&e&&e.end(),s=!1,ie(r)}}}function ms(n){let t;const e=n[28].default,l=le(e,n,n[27],dl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r[0]&134217984)&&ne(l,e,s,s[27],t?oe(e,s[27],r,is):se(s[27]),dl)},i(s){t||(A(l,s),t=!0)},o(s){j(l,s),t=!1},d(s){l&&l.d(s)}}}function hs(n){let t,e,l,s;const r=[ms,ds,fs,us,cs,as],o=[];function i(a,u){return a[7]&&a[9]?0:a[1]&&a[9]?1:a[3]&&a[5]&&a[9]?2:a[3]&&a[9]?3:a[5]&&a[9]?4:a[9]?5:-1}return~(t=i(n))&&(e=o[t]=r[t](n)),{c(){e&&e.c(),l=Ht()},l(a){e&&e.l(a),l=Ht()},m(a,u){~t&&o[t].m(a,u),P(a,l,u),s=!0},p(a,u){let c=t;t=i(a),t===c?~t&&o[t].p(a,u):(e&&(Ft(),j(o[c],1,1,()=>{o[c]=null}),qt()),~t?(e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),A(e,1),e.m(l.parentNode,l)):e=null)},i(a){s||(A(e),s=!0)},o(a){j(e),s=!1},d(a){a&&m(l),~t&&o[t].d(a)}}}function gs(n,t,e){let l;const s=["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"];let r=Be(t,s),o,i,{$$slots:a={},$$scope:u}=t,{transition:c=void 0}=t,{transitionConfig:d=void 0}=t,{inTransition:y=void 0}=t,{inTransitionConfig:b=void 0}=t,{outTransition:p=void 0}=t,{outTransitionConfig:_=void 0}=t,{asChild:h=!1}=t,{id:v=void 0}=t,{side:E="right"}=t,{align:N="start"}=t,{sideOffset:D=0}=t,{alignOffset:V=0}=t,{collisionPadding:T=8}=t,{avoidCollisions:B=!0}=t,{collisionBoundary:C=void 0}=t,{sameWidth:Q=!1}=t,{fitViewport:R=!1}=t,{strategy:L="absolute"}=t,{overlap:O=!1}=t,{el:ut=void 0}=t;const{elements:{subMenu:$},states:{subOpen:lt},ids:Mt,getAttrs:Qt}=Un();ct(n,$,F=>e(26,o=F)),ct(n,lt,F=>e(9,i=F));const Lt=sn(),Et=Qt("sub-content");function Pt(F){bt[F?"unshift":"push"](()=>{ut=F,e(0,ut)})}function Tt(F){bt[F?"unshift":"push"](()=>{ut=F,e(0,ut)})}function Wt(F){bt[F?"unshift":"push"](()=>{ut=F,e(0,ut)})}function Xt(F){bt[F?"unshift":"push"](()=>{ut=F,e(0,ut)})}function Yt(F){bt[F?"unshift":"push"](()=>{ut=F,e(0,ut)})}return n.$$set=F=>{t=re(re({},t),Xl(F)),e(13,r=Be(t,s)),"transition"in F&&e(1,c=F.transition),"transitionConfig"in F&&e(2,d=F.transitionConfig),"inTransition"in F&&e(3,y=F.inTransition),"inTransitionConfig"in F&&e(4,b=F.inTransitionConfig),"outTransition"in F&&e(5,p=F.outTransition),"outTransitionConfig"in F&&e(6,_=F.outTransitionConfig),"asChild"in F&&e(7,h=F.asChild),"id"in F&&e(14,v=F.id),"side"in F&&e(15,E=F.side),"align"in F&&e(16,N=F.align),"sideOffset"in F&&e(17,D=F.sideOffset),"alignOffset"in F&&e(18,V=F.alignOffset),"collisionPadding"in F&&e(19,T=F.collisionPadding),"avoidCollisions"in F&&e(20,B=F.avoidCollisions),"collisionBoundary"in F&&e(21,C=F.collisionBoundary),"sameWidth"in F&&e(22,Q=F.sameWidth),"fitViewport"in F&&e(23,R=F.fitViewport),"strategy"in F&&e(24,L=F.strategy),"overlap"in F&&e(25,O=F.overlap),"el"in F&&e(0,ut=F.el),"$$scope"in F&&e(27,u=F.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&v&&Mt.menu.set(v),n.$$.dirty[0]&67108864&&e(8,l=o),n.$$.dirty[0]&256&&Object.assign(l,Et),n.$$.dirty[0]&67076096&&Rn({side:E,align:N,sideOffset:D,alignOffset:V,collisionPadding:T,avoidCollisions:B,collisionBoundary:C,sameWidth:Q,fitViewport:R,strategy:L,overlap:O})},[ut,c,d,y,b,p,_,h,l,i,$,lt,Lt,r,v,E,N,D,V,T,B,C,Q,R,L,O,o,u,a,Pt,Tt,Wt,Xt,Yt]}class ps extends Gt{constructor(t){super(),Jt(this,t,gs,hs,Zt,{transition:1,transitionConfig:2,inTransition:3,inTransitionConfig:4,outTransition:5,outTransitionConfig:6,asChild:7,id:14,side:15,align:16,sideOffset:17,alignOffset:18,collisionPadding:19,avoidCollisions:20,collisionBoundary:21,sameWidth:22,fitViewport:23,strategy:24,overlap:25,el:0},null,[-1,-1])}}const _s=n=>({builder:n&4}),ml=n=>({builder:n[2]}),bs=n=>({builder:n&4}),hl=n=>({builder:n[2]});function vs(n){let t,e,l,s;const r=n[13].default,o=le(r,n,n[12],ml);let i=[n[2],n[6]],a={};for(let u=0;u<i.length;u+=1)a=re(a,i[u]);return{c(){t=I("div"),o&&o.c(),this.h()},l(u){t=M(u,"DIV",{});var c=S(t);o&&o.l(c),c.forEach(m),this.h()},h(){te(t,a)},m(u,c){P(u,t,c),o&&o.m(t,null),n[14](t),e=!0,l||(s=[ke(n[2].action(t)),K(t,"m-click",n[5]),K(t,"m-focusin",n[5]),K(t,"m-focusout",n[5]),K(t,"m-keydown",n[5]),K(t,"m-pointerleave",n[5]),K(t,"m-pointermove",n[5])],l=!0)},p(u,c){o&&o.p&&(!e||c&4100)&&ne(o,r,u,u[12],e?oe(r,u[12],c,_s):se(u[12]),ml),te(t,a=Ee(i,[c&4&&u[2],c&64&&u[6]]))},i(u){e||(A(o,u),e=!0)},o(u){j(o,u),e=!1},d(u){u&&m(t),o&&o.d(u),n[14](null),l=!1,ie(s)}}}function ws(n){let t;const e=n[13].default,l=le(e,n,n[12],hl);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4100)&&ne(l,e,s,s[12],t?oe(e,s[12],r,bs):se(s[12]),hl)},i(s){t||(A(l,s),t=!0)},o(s){j(l,s),t=!1},d(s){l&&l.d(s)}}}function ks(n){let t,e,l,s;const r=[ws,vs],o=[];function i(a,u){return a[1]?0:1}return t=i(n),e=o[t]=r[t](n),{c(){e.c(),l=Ht()},l(a){e.l(a),l=Ht()},m(a,u){o[t].m(a,u),P(a,l,u),s=!0},p(a,[u]){let c=t;t=i(a),t===c?o[t].p(a,u):(Ft(),j(o[c],1,1,()=>{o[c]=null}),qt(),e=o[t],e?e.p(a,u):(e=o[t]=r[t](a),e.c()),A(e,1),e.m(l.parentNode,l))},i(a){s||(A(e),s=!0)},o(a){j(e),s=!1},d(a){a&&m(l),o[t].d(a)}}}function ys(n,t,e){let l,s;const r=["disabled","asChild","id","el"];let o=Be(t,r),i,a,{$$slots:u={},$$scope:c}=t,{disabled:d=!1}=t,{asChild:y=!1}=t,{id:b=void 0}=t,{el:p=void 0}=t;const{elements:{subTrigger:_},ids:h,getAttrs:v,options:E}=jn();ct(n,_,T=>e(11,a=T));const{disabled:N}=E;ct(n,N,T=>e(10,i=T));const D=sn();function V(T){bt[T?"unshift":"push"](()=>{p=T,e(0,p)})}return n.$$set=T=>{t=re(re({},t),Xl(T)),e(6,o=Be(t,r)),"disabled"in T&&e(7,d=T.disabled),"asChild"in T&&e(1,y=T.asChild),"id"in T&&e(8,b=T.id),"el"in T&&e(0,p=T.el),"$$scope"in T&&e(12,c=T.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&b&&h.trigger.set(b),n.$$.dirty&2048&&e(2,l=a),n.$$.dirty&1152&&e(9,s={...v("sub-trigger"),...Ln(d||i)}),n.$$.dirty&516&&Object.assign(l,s)},[p,y,l,_,N,D,o,d,b,s,i,a,c,u,V]}class Es extends Gt{constructor(t){super(),Jt(this,t,ys,ks,Zt,{disabled:7,asChild:1,id:8,el:0})}}function gl(n,t,e){const l=n.slice();return l[11]=t[e],l[13]=e,l}function pl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">/</div>',r,o,i,a,u,c,d='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',y,b,p=n[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",_,h=ee(n[1]),v=[];for(let E=0;E<h.length;E+=1)v[E]=_l(gl(n,h,E));return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=G(),o=I("div"),i=I("div");for(let E=0;E<v.length;E+=1)v[E].c();a=G(),u=I("div"),c=I("div"),c.innerHTML=d,y=G(),b=I("div"),_=mt(p),this.h()},l(E){t=M(E,"DIV",{class:!0});var N=S(t);e=M(N,"DIV",{class:!0});var D=S(e);l=M(D,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-1ynv172"&&(l.innerHTML=s),r=J(D),o=M(D,"DIV",{class:!0});var V=S(o);i=M(V,"DIV",{class:!0});var T=S(i);for(let Q=0;Q<v.length;Q+=1)v[Q].l(T);T.forEach(m),a=J(V),u=M(V,"DIV",{class:!0});var B=S(u);c=M(B,"DIV",{"data-svelte-h":!0}),Kt(c)!=="svelte-cdi12d"&&(c.innerHTML=d),y=J(B),b=M(B,"DIV",{class:!0});var C=S(b);_=ht(C,p),C.forEach(m),B.forEach(m),V.forEach(m),D.forEach(m),N.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(b,"class","line-clamp-1"),f(u,"class","px-2 pb-1 text-xs text-gray-600 bg-white rounded-br-xl flex items-center space-x-1"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(E,N){P(E,t,N),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i);for(let D=0;D<v.length;D+=1)v[D]&&v[D].m(i,null);w(o,a),w(o,u),w(u,c),w(u,y),w(u,b),w(b,_)},p(E,N){if(N&19){h=ee(E[1]);let D;for(D=0;D<h.length;D+=1){const V=gl(E,h,D);v[D]?v[D].p(V,N):(v[D]=_l(V),v[D].c(),v[D].m(i,null))}for(;D<v.length;D+=1)v[D].d(1);v.length=h.length}N&4&&p!==(p=E[2].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&wt(_,p)},d(E){E&&m(t),ye(v,E)}}}function _l(n){let t,e,l=n[11].command+"",s,r,o,i=n[11].title+"",a,u,c,d,y;function b(){return n[9](n[11])}function p(){return n[10](n[13])}return{c(){t=I("button"),e=I("div"),s=mt(l),r=G(),o=I("div"),a=mt(i),u=G(),this.h()},l(_){t=M(_,"BUTTON",{class:!0,type:!0});var h=S(t);e=M(h,"DIV",{class:!0});var v=S(e);s=ht(v,l),v.forEach(m),r=J(h),o=M(h,"DIV",{class:!0});var E=S(o);a=ht(E,i),E.forEach(m),u=J(h),h.forEach(m),this.h()},h(){f(e,"class","font-medium text-black"),f(o,"class","text-xs text-gray-600"),f(t,"class",c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(_,h){P(_,t,h),w(t,e),w(e,s),w(t,r),w(t,o),w(o,a),w(t,u),d||(y=[K(t,"click",b),K(t,"mousemove",p),K(t,"focus",Is)],d=!0)},p(_,h){n=_,h&2&&l!==(l=n[11].command+"")&&wt(s,l),h&2&&i!==(i=n[11].title+"")&&wt(a,i),h&1&&c!==(c="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",c)},d(_){_&&m(t),d=!1,ie(y)}}}function Ss(n){let t,e=n[1].length>0&&pl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),P(l,t,s)},p(l,[s]){l[1].length>0?e?e.p(l,s):(e=pl(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:It,o:It,d(l){l&&m(t),e&&e.d(l)}}}const Is=()=>{};function Ms(n,t,e){let l,s;ct(n,_n,p=>e(8,s=p));const r=ue("i18n");ct(n,r,p=>e(2,l=p));let{prompt:o=""}=t,i=0,a=[];const u=()=>{e(0,i=Math.max(0,i-1))},c=()=>{e(0,i=Math.min(i+1,a.length-1))},d=async p=>{let _=p.content;if(p.content.includes("{{CLIPBOARD}}")){const E=await navigator.clipboard.readText().catch(N=>(_t.error(l.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));_=p.content.replaceAll("{{CLIPBOARD}}",E)}e(5,o=_);const h=document.getElementById("chat-textarea");await yt(),h.style.height="",h.style.height=Math.min(h.scrollHeight,200)+"px",h==null||h.focus(),await yt();const v=nn(o);if(v.length>0){const E=v.at(0);h.setSelectionRange(E==null?void 0:E.startIndex,E.endIndex+1)}},y=p=>{d(p)},b=p=>{e(0,i=p)};return n.$$set=p=>{"prompt"in p&&e(5,o=p.prompt)},n.$$.update=()=>{n.$$.dirty&288&&e(1,a=s.filter(p=>p.command.includes(o)).sort((p,_)=>p.title.localeCompare(_.title))),n.$$.dirty&32&&o&&e(0,i=0)},[i,a,l,r,d,o,u,c,s,y,b]}class Ds extends Gt{constructor(t){super(),Jt(this,t,Ms,Ss,Zt,{prompt:5,selectUp:6,selectDown:7})}get selectUp(){return this.$$.ctx[6]}get selectDown(){return this.$$.ctx[7]}}function bl(n,t,e){const l=n.slice();return l[19]=t[e],l[21]=e,l}function vl(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">#</div>',r,o,i,a,u,c,d=ee(n[3]),y=[];for(let h=0;h<d.length;h+=1)y[h]=wl(bl(n,d,h));function b(h,v){var E,N;if(v&1&&(u=null),v&1&&(c=null),u==null&&(u=!!h[0].split(" ").some(Os)),u)return Bs;if(c==null&&(c=!!((N=(E=h[0].split(" "))==null?void 0:E.at(0))!=null&&N.substring(1).startsWith("http"))),c)return Vs}let p=b(n,-1),_=p&&p(n);return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=G(),o=I("div"),i=I("div");for(let h=0;h<y.length;h+=1)y[h].c();a=G(),_&&_.c(),this.h()},l(h){t=M(h,"DIV",{class:!0});var v=S(t);e=M(v,"DIV",{class:!0});var E=S(e);l=M(E,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-czbw16"&&(l.innerHTML=s),r=J(E),o=M(E,"DIV",{class:!0});var N=S(o);i=M(N,"DIV",{class:!0});var D=S(i);for(let V=0;V<y.length;V+=1)y[V].l(D);a=J(D),_&&_.l(D),D.forEach(m),N.forEach(m),E.forEach(m),v.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(h,v){P(h,t,v),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(i,null);w(i,a),_&&_.m(i,null)},p(h,v){if(v&46){d=ee(h[3]);let E;for(E=0;E<d.length;E+=1){const N=bl(h,d,E);y[E]?y[E].p(N,v):(y[E]=wl(N),y[E].c(),y[E].m(i,a))}for(;E<y.length;E+=1)y[E].d(1);y.length=d.length}p===(p=b(h,v))&&_?_.p(h,v):(_&&_.d(1),_=p&&p(h),_&&(_.c(),_.m(i,null)))},d(h){h&&m(t),ye(y,h),_&&_.d()}}}function Cs(n){let t,e,l=n[19].name+"",s,r,o=n[19].filename+"",i,a,u,c,d=n[19].title+"",y;return{c(){t=I("div"),e=mt("#"),s=mt(l),r=mt(" ("),i=mt(o),a=mt(")"),u=G(),c=I("div"),y=mt(d),this.h()},l(b){t=M(b,"DIV",{class:!0});var p=S(t);e=ht(p,"#"),s=ht(p,l),r=ht(p," ("),i=ht(p,o),a=ht(p,")"),p.forEach(m),u=J(b),c=M(b,"DIV",{class:!0});var _=S(c);y=ht(_,d),_.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(c,"class","text-xs text-gray-600 line-clamp-1")},m(b,p){P(b,t,p),w(t,e),w(t,s),w(t,r),w(t,i),w(t,a),P(b,u,p),P(b,c,p),w(c,y)},p(b,p){p&8&&l!==(l=b[19].name+"")&&wt(s,l),p&8&&o!==(o=b[19].filename+"")&&wt(i,o),p&8&&d!==(d=b[19].title+"")&&wt(y,d)},d(b){b&&(m(t),m(u),m(c))}}}function Ts(n){var a;let t,e=(((a=n[19])==null?void 0:a.title)??`#${n[19].name}`)+"",l,s,r,o=n[1].t("Collection")+"",i;return{c(){t=I("div"),l=mt(e),s=G(),r=I("div"),i=mt(o),this.h()},l(u){t=M(u,"DIV",{class:!0});var c=S(t);l=ht(c,e),c.forEach(m),s=J(u),r=M(u,"DIV",{class:!0});var d=S(r);i=ht(d,o),d.forEach(m),this.h()},h(){f(t,"class","font-medium text-black line-clamp-1"),f(r,"class","text-xs text-gray-600 line-clamp-1")},m(u,c){P(u,t,c),w(t,l),P(u,s,c),P(u,r,c),w(r,i)},p(u,c){var d;c&8&&e!==(e=(((d=u[19])==null?void 0:d.title)??`#${u[19].name}`)+"")&&wt(l,e),c&2&&o!==(o=u[1].t("Collection")+"")&&wt(i,o)},d(u){u&&(m(t),m(s),m(r))}}}function wl(n){let t,e,l,s;function r(c,d){return c[19].type==="collection"?Ts:Cs}let o=r(n),i=o(n);function a(){return n[14](n[19])}function u(){return n[15](n[21])}return{c(){t=I("button"),i.c(),this.h()},l(c){t=M(c,"BUTTON",{class:!0,type:!0});var d=S(t);i.l(d),d.forEach(m),this.h()},h(){f(t,"class",e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(c,d){P(c,t,d),i.m(t,null),l||(s=[K(t,"click",a),K(t,"mousemove",u),K(t,"focus",Hs)],l=!0)},p(c,d){n=c,o===(o=r(n))&&i?i.p(n,d):(i.d(1),i=o(n),i&&(i.c(),i.m(t,null))),d&4&&e!==(e="px-3 py-1.5 rounded-xl w-full text-left "+(n[21]===n[2]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",e)},d(c){c&&m(t),i.d(),l=!1,ie(s)}}}function Vs(n){var d,y;let t,e,l=((y=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:y.substring(1))+"",s,r,o,i=n[1].t("Web")+"",a,u,c;return{c(){t=I("button"),e=I("div"),s=mt(l),r=G(),o=I("div"),a=mt(i),this.h()},l(b){t=M(b,"BUTTON",{class:!0,type:!0});var p=S(t);e=M(p,"DIV",{class:!0});var _=S(e);s=ht(_,l),_.forEach(m),r=J(p),o=M(p,"DIV",{class:!0});var h=S(o);a=ht(h,i),h.forEach(m),p.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(b,p){P(b,t,p),w(t,e),w(e,s),w(t,r),w(t,o),w(o,a),u||(c=K(t,"click",n[17]),u=!0)},p(b,p){var _,h;p&1&&l!==(l=((h=(_=b[0].split(" "))==null?void 0:_.at(0))==null?void 0:h.substring(1))+"")&&wt(s,l),p&2&&i!==(i=b[1].t("Web")+"")&&wt(a,i)},d(b){b&&m(t),u=!1,c()}}}function Bs(n){var d,y;let t,e,l=((y=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:y.substring(1))+"",s,r,o,i=n[1].t("Youtube")+"",a,u,c;return{c(){t=I("button"),e=I("div"),s=mt(l),r=G(),o=I("div"),a=mt(i),this.h()},l(b){t=M(b,"BUTTON",{class:!0,type:!0});var p=S(t);e=M(p,"DIV",{class:!0});var _=S(e);s=ht(_,l),_.forEach(m),r=J(p),o=M(p,"DIV",{class:!0});var h=S(o);a=ht(h,i),h.forEach(m),p.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(o,"class","text-xs text-gray-600 line-clamp-1"),f(t,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-100 selected-command-option-button"),f(t,"type","button")},m(b,p){P(b,t,p),w(t,e),w(e,s),w(t,r),w(t,o),w(o,a),u||(c=K(t,"click",n[16]),u=!0)},p(b,p){var _,h;p&1&&l!==(l=((h=(_=b[0].split(" "))==null?void 0:_.at(0))==null?void 0:h.substring(1))+"")&&wt(s,l),p&2&&i!==(i=b[1].t("Youtube")+"")&&wt(a,i)},d(b){b&&m(t),u=!1,c()}}}function Ns(n){var s,r;let t=n[3].length>0||((r=(s=n[0].split(" "))==null?void 0:s.at(0))==null?void 0:r.substring(1).startsWith("http")),e,l=t&&vl(n);return{c(){l&&l.c(),e=Ht()},l(o){l&&l.l(o),e=Ht()},m(o,i){l&&l.m(o,i),P(o,e,i)},p(o,[i]){var a,u;i&9&&(t=o[3].length>0||((u=(a=o[0].split(" "))==null?void 0:a.at(0))==null?void 0:u.substring(1).startsWith("http"))),t?l?l.p(o,i):(l=vl(o),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:It,o:It,d(o){o&&m(e),l&&l.d(o)}}}const Os=n=>n.substring(1).startsWith("https://www.youtube.com")||n.substring(1).startsWith("https://youtu.be"),Hs=()=>{};function As(n,t,e){let l,s,r;ct(n,bn,T=>e(13,s=T));const o=ue("i18n");ct(n,o,T=>e(1,r=T));let{prompt:i=""}=t;const a=Fe();let u=0,c=[],d=[],y=[];const b=()=>{e(2,u=Math.max(0,u-1))},p=()=>{e(2,u=Math.min(u+1,c.length-1))},_=async T=>{a("select",T),e(0,i=Re(i));const B=document.getElementById("chat-textarea");await yt(),B==null||B.focus(),await yt()},h=async T=>{a("url",T),e(0,i=Re(i));const B=document.getElementById("chat-textarea");await yt(),B==null||B.focus(),await yt()},v=async T=>{a("youtube",T),e(0,i=Re(i));const B=document.getElementById("chat-textarea");await yt(),B==null||B.focus(),await yt()},E=T=>{console.log(T),_(T)},N=T=>{e(2,u=T)},D=()=>{var B,C;const T=(C=(B=i.split(" "))==null?void 0:B.at(0))==null?void 0:C.substring(1);$e(T)?v(T):_t.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},V=()=>{var B,C;const T=(C=(B=i.split(" "))==null?void 0:B.at(0))==null?void 0:C.substring(1);$e(T)?h(T):_t.error(r.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return n.$$set=T=>{"prompt"in T&&e(0,i=T.prompt)},n.$$.update=()=>{n.$$.dirty&8194&&e(11,y=[...s.length>0?[{name:"All Documents",type:"collection",title:r.t("All Documents"),collection_names:s.map(T=>T.collection_name)}]:[],...s.reduce((T,B,C,Q)=>{var R;return[...new Set([...T,...(((R=B==null?void 0:B.content)==null?void 0:R.tags)??[]).map(L=>L.name)])]},[]).map(T=>({name:T,type:"collection",collection_names:s.filter(B=>{var C;return(((C=B==null?void 0:B.content)==null?void 0:C.tags)??[]).map(Q=>Q.name).includes(T)}).map(B=>B.collection_name)}))]),n.$$.dirty&2049&&e(12,l=y.filter(T=>{var B,C;return T.name.includes(((C=(B=i.split(" "))==null?void 0:B.at(0))==null?void 0:C.substring(1))??"")}).sort((T,B)=>T.name.localeCompare(B.name))),n.$$.dirty&8193&&e(10,d=s.filter(T=>{var B,C;return T.name.includes(((C=(B=i.split(" "))==null?void 0:B.at(0))==null?void 0:C.substring(1))??"")}).sort((T,B)=>T.title.localeCompare(B.title))),n.$$.dirty&5120&&e(3,c=[...l,...d]),n.$$.dirty&4097&&i&&(e(2,u=0),console.log(l))},[i,r,u,c,o,_,h,v,b,p,d,y,l,s,E,N,D,V]}class Ls extends Gt{constructor(t){super(),Jt(this,t,As,Ns,Zt,{prompt:0,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function kl(n,t,e){const l=n.slice();return l[16]=t[e],l[18]=e,l}function yl(n){let t,e=n[2].length>0&&El(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),P(l,t,s)},p(l,s){l[2].length>0?e?e.p(l,s):(e=El(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function El(n){let t,e,l,s='<div class="text-lg font-semibold mt-2">@</div>',r,o,i,a=ee(n[2]),u=[];for(let c=0;c<a.length;c+=1)u[c]=Sl(kl(n,a,c));return{c(){t=I("div"),e=I("div"),l=I("div"),l.innerHTML=s,r=G(),o=I("div"),i=I("div");for(let c=0;c<u.length;c+=1)u[c].c();this.h()},l(c){t=M(c,"DIV",{class:!0});var d=S(t);e=M(d,"DIV",{class:!0});var y=S(e);l=M(y,"DIV",{class:!0,"data-svelte-h":!0}),Kt(l)!=="svelte-1ourwwn"&&(l.innerHTML=s),r=J(y),o=M(y,"DIV",{class:!0});var b=S(o);i=M(b,"DIV",{class:!0});var p=S(i);for(let _=0;_<u.length;_+=1)u[_].l(p);p.forEach(m),b.forEach(m),y.forEach(m),d.forEach(m),this.h()},h(){f(l,"class","bg-gray-100 dark:bg-gray-700 w-10 rounded-l-xl text-center"),f(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5"),f(o,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white"),f(e,"class","flex w-full px-2"),f(t,"class","md:px-2 mb-3 text-left w-full absolute bottom-0 left-0 right-0")},m(c,d){P(c,t,d),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(i,null)},p(c,d){if(d&22){a=ee(c[2]);let y;for(y=0;y<a.length;y+=1){const b=kl(c,a,y);u[y]?u[y].p(b,d):(u[y]=Sl(b),u[y].c(),u[y].m(i,null))}for(;y<u.length;y+=1)u[y].d(1);u.length=a.length}},d(c){c&&m(t),ye(u,c)}}}function Sl(n){let t,e,l=n[16].name+"",s,r,o,i,a;function u(){return n[11](n[16])}function c(){return n[12](n[18])}return{c(){t=I("button"),e=I("div"),s=mt(l),r=G(),this.h()},l(d){t=M(d,"BUTTON",{class:!0,type:!0});var y=S(t);e=M(y,"DIV",{class:!0});var b=S(e);s=ht(b,l),b.forEach(m),r=J(y),y.forEach(m),this.h()},h(){f(e,"class","font-medium text-black line-clamp-1"),f(t,"class",o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":"")),f(t,"type","button")},m(d,y){P(d,t,y),w(t,e),w(e,s),w(t,r),i||(a=[K(t,"click",u),K(t,"mousemove",c),K(t,"focus",Us)],i=!0)},p(d,y){n=d,y&4&&l!==(l=n[16].name+"")&&wt(s,l),y&2&&o!==(o="px-3 py-1.5 rounded-xl w-full text-left "+(n[18]===n[1]?" bg-gray-100 selected-command-option-button":""))&&f(t,"class",o)},d(d){d&&m(t),i=!1,ie(a)}}}function Ps(n){let t=n[0].charAt(0)==="@",e,l=t&&yl(n);return{c(){l&&l.c(),e=Ht()},l(s){l&&l.l(s),e=Ht()},m(s,r){l&&l.m(s,r),P(s,e,r)},p(s,[r]){r&1&&(t=s[0].charAt(0)==="@"),t?l?l.p(s,r):(l=yl(s),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:It,o:It,d(s){s&&m(e),l&&l.d(s)}}}const Us=()=>{};function Rs(n,t,e){let l;ct(n,Le,v=>e(10,l=v));const s=ue("i18n");ct(n,s,v=>e(13,v));const r=Fe();let{prompt:o=""}=t,{user:i=null}=t,{chatInputPlaceholder:a=""}=t,{messages:u=[]}=t,c=0,d=[];const y=()=>{e(1,c=Math.max(0,c-1))},b=()=>{e(1,c=Math.min(c+1,d.length-1))},p=async v=>{e(0,o=""),r("select",v)},_=v=>{p(v)},h=v=>{e(1,c=v)};return n.$$set=v=>{"prompt"in v&&e(0,o=v.prompt),"user"in v&&e(5,i=v.user),"chatInputPlaceholder"in v&&e(6,a=v.chatInputPlaceholder),"messages"in v&&e(7,u=v.messages)},n.$$.update=()=>{n.$$.dirty&1025&&e(2,d=l.filter(v=>{var E,N;return v.name.includes(((N=(E=o.split(" "))==null?void 0:E.at(0))==null?void 0:N.substring(1))??"")}).sort((v,E)=>v.name.localeCompare(E.name))),n.$$.dirty&1&&o&&e(1,c=0)},[o,c,d,s,p,i,a,u,y,b,l,_,h]}class js extends Gt{constructor(t){super(),Jt(this,t,Rs,Ps,Zt,{prompt:0,user:5,chatInputPlaceholder:6,messages:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function zs(n){let t,e;return{c(){t=gt("svg"),e=gt("path"),this.h()},l(l){t=pt(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=S(t);e=pt(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M6 18 18 6M6 6l12 12"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width",n[1]),f(t,"stroke","currentColor"),f(t,"class",n[0])},m(l,s){P(l,t,s),w(t,e)},p(l,[s]){s&2&&f(t,"stroke-width",l[1]),s&1&&f(t,"class",l[0])},i:It,o:It,d(l){l&&m(t)}}}function Fs(n,t,e){let{className:l="size-3.5"}=t,{strokeWidth:s="2"}=t;return n.$$set=r=>{"className"in r&&e(0,l=r.className),"strokeWidth"in r&&e(1,s=r.strokeWidth)},[l,s]}class qs extends Gt{constructor(t){super(),Jt(this,t,Fs,zs,Zt,{className:0,strokeWidth:1})}}function Ws(n){let t,e,l;return{c(){t=gt("svg"),e=gt("path"),l=gt("path"),this.h()},l(s){t=pt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=pt(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),l=pt(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),f(e,"clip-rule","evenodd"),f(l,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(s,r){P(s,t,r),w(t,e),w(t,l)},p(s,[r]){r&1&&f(t,"class",s[0])},i:It,o:It,d(s){s&&m(t)}}}function Zs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Gs extends Gt{constructor(t){super(),Jt(this,t,Zs,Ws,Zt,{className:0})}}function Js(n){let t,e;return{c(){t=gt("svg"),e=gt("path"),this.h()},l(l){t=pt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(t);e=pt(s,"path",{d:!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class",n[0])},m(l,s){P(l,t,s),w(t,e)},p(l,[s]){s&1&&f(t,"class",l[0])},i:It,o:It,d(l){l&&m(t)}}}function Qs(n,t,e){let{className:l="size-4"}=t;return n.$$set=s=>{"className"in s&&e(0,l=s.className)},[l]}class Ys extends Gt{constructor(t){super(),Jt(this,t,Qs,Js,Zt,{className:0})}}function Xs(n){let t;const e=n[7].default,l=le(e,n,n[12],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&4096)&&ne(l,e,s,s[12],t?oe(e,s[12],r,null):se(s[12]),null)},i(s){t||(A(l,s),t=!0)},o(s){j(l,s),t=!1},d(s){l&&l.d(s)}}}function Ks(n){let t,e;return t=new me({props:{content:n[5].t("More"),$$slots:{default:[Xs]},$$scope:{ctx:n}}}),{c(){st(t.$$.fragment)},l(l){ot(t.$$.fragment,l)},m(l,s){rt(t,l,s),e=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("More")),s&4096&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){j(t.$$.fragment,l),e=!1},d(l){it(t,l)}}}function Il(n){let t,e,l,s,r,o=n[5].t("Web Search")+"",i,a,u,c,d,y,b;l=new Ys({});function p(h){n[8](h)}let _={};return n[0]!==void 0&&(_.state=n[0]),u=new zn({props:_}),bt.push(()=>Ot(u,"state",p)),{c(){t=I("div"),e=I("div"),st(l.$$.fragment),s=G(),r=I("div"),i=mt(o),a=G(),st(u.$$.fragment),d=G(),y=I("hr"),this.h()},l(h){t=M(h,"DIV",{class:!0});var v=S(t);e=M(v,"DIV",{class:!0});var E=S(e);ot(l.$$.fragment,E),s=J(E),r=M(E,"DIV",{class:!0});var N=S(r);i=ht(N,o),N.forEach(m),E.forEach(m),a=J(v),ot(u.$$.fragment,v),v.forEach(m),d=J(h),y=M(h,"HR",{class:!0}),this.h()},h(){f(r,"class","flex items-center"),f(e,"class","flex-1 flex items-center gap-2"),f(t,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),f(y,"class","border-gray-100 dark:border-gray-800 my-1")},m(h,v){P(h,t,v),w(t,e),rt(l,e,null),w(e,s),w(e,r),w(r,i),w(t,a),rt(u,t,null),P(h,d,v),P(h,y,v),b=!0},p(h,v){(!b||v&32)&&o!==(o=h[5].t("Web Search")+"")&&wt(i,o);const E={};!c&&v&1&&(c=!0,E.state=h[0],Nt(()=>c=!1)),u.$set(E)},i(h){b||(A(l.$$.fragment,h),A(u.$$.fragment,h),b=!0)},o(h){j(l.$$.fragment,h),j(u.$$.fragment,h),b=!1},d(h){h&&(m(t),m(d),m(y)),it(l),it(u)}}}function xs(n){let t,e,l,s=n[5].t("Upload Files")+"",r,o;return t=new Gs({}),{c(){st(t.$$.fragment),e=G(),l=I("div"),r=mt(s),this.h()},l(i){ot(t.$$.fragment,i),e=J(i),l=M(i,"DIV",{class:!0});var a=S(l);r=ht(a,s),a.forEach(m),this.h()},h(){f(l,"class","flex items-center")},m(i,a){rt(t,i,a),P(i,e,a),P(i,l,a),w(l,r),o=!0},p(i,a){(!o||a&32)&&s!==(s=i[5].t("Upload Files")+"")&&wt(r,s)},i(i){o||(A(t.$$.fragment,i),o=!0)},o(i){j(t.$$.fragment,i),o=!1},d(i){i&&(m(e),m(l)),it(t,i)}}}function $s(n){var r,o;let t,e,l,s=((o=(r=n[4])==null?void 0:r.features)==null?void 0:o.enable_web_search)&&Il(n);return e=new Ve({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[xs]},$$scope:{ctx:n}}}),e.$on("click",n[9]),{c(){s&&s.c(),t=G(),st(e.$$.fragment)},l(i){s&&s.l(i),t=J(i),ot(e.$$.fragment,i)},m(i,a){s&&s.m(i,a),P(i,t,a),rt(e,i,a),l=!0},p(i,a){var c,d;(d=(c=i[4])==null?void 0:c.features)!=null&&d.enable_web_search?s?(s.p(i,a),a&16&&A(s,1)):(s=Il(i),s.c(),A(s,1),s.m(t.parentNode,t)):s&&(Ft(),j(s,1,1,()=>{s=null}),qt());const u={};a&4128&&(u.$$scope={dirty:a,ctx:i}),e.$set(u)},i(i){l||(A(s),A(e.$$.fragment,i),l=!0)},o(i){j(s),j(e.$$.fragment,i),l=!1},d(i){i&&m(t),s&&s.d(i),it(e,i)}}}function to(n){let t,e,l;return e=new rn({props:{class:"w-full max-w-[190px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:We,$$slots:{default:[$s]},$$scope:{ctx:n}}}),{c(){t=I("div"),st(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{slot:!0});var r=S(t);ot(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){P(s,t,r),rt(e,t,null),l=!0},p(s,r){const o={};r&4147&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),l=!1},d(s){s&&m(t),it(e)}}}function eo(n){let t,e,l;function s(o){n[10](o)}let r={$$slots:{content:[to],default:[Ks]},$$scope:{ctx:n}};return n[3]!==void 0&&(r.show=n[3]),t=new on({props:r}),bt.push(()=>Ot(t,"show",s)),t.$on("change",n[11]),{c(){st(t.$$.fragment)},l(o){ot(t.$$.fragment,o)},m(o,i){rt(t,o,i),l=!0},p(o,[i]){const a={};i&4147&&(a.$$scope={dirty:i,ctx:o}),!e&&i&8&&(e=!0,a.show=o[3],Nt(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){it(t,o)}}}function lo(n,t,e){let l,s;ct(n,$l,h=>e(4,l=h));let{$$slots:r={},$$scope:o}=t;const i=ue("i18n");ct(n,i,h=>e(5,s=h));let{uploadFilesHandler:a}=t,{webSearchEnabled:u}=t,{onClose:c}=t,d=!1;function y(h){u=h,e(0,u)}const b=()=>{a()};function p(h){d=h,e(3,d)}const _=h=>{h.detail===!1&&c()};return n.$$set=h=>{"uploadFilesHandler"in h&&e(1,a=h.uploadFilesHandler),"webSearchEnabled"in h&&e(0,u=h.webSearchEnabled),"onClose"in h&&e(2,c=h.onClose),"$$scope"in h&&e(12,o=h.$$scope)},[u,a,c,d,l,s,i,r,y,b,p,_,o]}class no extends Gt{constructor(t){super(),Jt(this,t,lo,eo,Zt,{uploadFilesHandler:1,webSearchEnabled:0,onClose:2})}}function Ml(n,t,e){const l=n.slice();return l[71]=t[e],l[73]=e,l}function Dl(n){let t,e,l,s,r,o,i;return r=new Bn({}),{c(){t=I("div"),e=I("div"),l=I("div"),s=I("div"),st(r.$$.fragment),this.h()},l(a){t=M(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var u=S(t);e=M(u,"DIV",{class:!0});var c=S(e);l=M(c,"DIV",{class:!0});var d=S(l);s=M(d,"DIV",{class:!0});var y=S(s);ot(r.$$.fragment,y),y.forEach(m),d.forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){f(s,"class","max-w-md"),f(l,"class","m-auto pt-64 flex flex-col justify-center"),f(e,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),f(t,"class",o="fixed "+(n[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"),f(t,"id","dropzone"),f(t,"role","region"),f(t,"aria-label","Drag and Drop Container")},m(a,u){P(a,t,u),w(t,e),w(e,l),w(l,s),rt(r,s,null),i=!0},p(a,u){(!i||u[0]&16777216&&o!==(o="fixed "+(a[24]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" w-full h-full flex z-50 touch-none pointer-events-none"))&&f(t,"class",o)},i(a){i||(A(r.$$.fragment,a),i=!0)},o(a){j(r.$$.fragment,a),i=!1},d(a){a&&m(t),it(r)}}}function Cl(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){t=I("div"),e=I("button"),e.innerHTML=l,this.h()},l(o){t=M(o,"DIV",{class:!0});var i=S(t);e=M(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-a2mahu"&&(e.innerHTML=l),i.forEach(m),this.h()},h(){f(e,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full"),f(t,"class","absolute -top-12 left-0 right-0 flex justify-center z-30")},m(o,i){P(o,t,i),w(t,e),s||(r=K(e,"click",n[32]),s=!0)},p:It,d(o){o&&m(t),s=!1,r()}}}function so(n){let t,e,l;function s(o){n[36](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ls({props:r}),n[35](t),bt.push(()=>Ot(t,"prompt",s)),t.$on("youtube",n[37]),t.$on("url",n[38]),t.$on("select",n[39]),{c(){st(t.$$.fragment)},l(o){ot(t.$$.fragment,o)},m(o,i){rt(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Nt(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){n[35](null),it(t,o)}}}function oo(n){let t,e,l;function s(o){n[34](o)}let r={};return n[1]!==void 0&&(r.prompt=n[1]),t=new Ds({props:r}),n[33](t),bt.push(()=>Ot(t,"prompt",s)),{c(){st(t.$$.fragment)},l(o){ot(t.$$.fragment,o)},m(o,i){rt(t,o,i),l=!0},p(o,i){const a={};!e&&i[0]&2&&(e=!0,a.prompt=o[1],Nt(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){n[33](null),it(t,o)}}}function Tl(n){let t,e,l,s,r,o,i,a,u=n[0].name+"",c,d,y,b,p,_,h,v;return p=new qs({}),{c(){t=I("div"),e=I("div"),l=I("img"),r=G(),o=I("div"),i=mt("Talking to "),a=I("span"),c=mt(u),d=G(),y=I("div"),b=I("button"),st(p.$$.fragment),this.h()},l(E){t=M(E,"DIV",{class:!0});var N=S(t);e=M(N,"DIV",{class:!0});var D=S(e);l=M(D,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),r=J(D),o=M(D,"DIV",{});var V=S(o);i=ht(V,"Talking to "),a=M(V,"SPAN",{class:!0});var T=S(a);c=ht(T,u),T.forEach(m),V.forEach(m),D.forEach(m),d=J(N),y=M(N,"DIV",{});var B=S(y);b=M(B,"BUTTON",{class:!0});var C=S(b);ot(p.$$.fragment,C),C.forEach(m),B.forEach(m),N.forEach(m),this.h()},h(){var E,N,D;f(l,"crossorigin","anonymous"),f(l,"alt","model profile"),f(l,"class","size-5 max-w-[28px] object-cover rounded-full"),we(l.src,s=((D=(N=(E=n[11].find(n[45]))==null?void 0:E.info)==null?void 0:N.meta)==null?void 0:D.profile_image_url)??(n[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`))||f(l,"src",s),f(a,"class","font-medium"),f(e,"class","flex items-center gap-2 text-sm dark:text-gray-500"),f(b,"class","flex items-center"),f(t,"class","px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900")},m(E,N){P(E,t,N),w(t,e),w(e,l),w(e,r),w(e,o),w(o,i),w(o,a),w(a,c),w(t,d),w(t,y),w(y,b),rt(p,b,null),_=!0,h||(v=K(b,"click",n[46]),h=!0)},p(E,N){var D,V,T;(!_||N[0]&4196353&&!we(l.src,s=((T=(V=(D=E[11].find(E[45]))==null?void 0:D.info)==null?void 0:V.meta)==null?void 0:T.profile_image_url)??(E[22].language==="dg-DG"?"/doge.png":`${He}/static/favicon.png`)))&&f(l,"src",s),(!_||N[0]&1)&&u!==(u=E[0].name+"")&&wt(c,u)},i(E){_||(A(p.$$.fragment,E),_=!0)},o(E){j(p.$$.fragment,E),_=!1},d(E){E&&m(t),it(p),h=!1,v()}}}function Vl(n){let t,e,l=ee(n[3]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Nl(Ml(n,l,o));const r=o=>j(s[o],1,1,()=>{s[o]=null});return{c(){t=I("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){t=M(o,"DIV",{class:!0});var i=S(t);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(m),this.h()},h(){f(t,"class","mx-2 mt-2 mb-1 flex flex-wrap gap-2")},m(o,i){P(o,t,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null);e=!0},p(o,i){if(i[0]&5243017){l=ee(o[3]);let a;for(a=0;a<l.length;a+=1){const u=Ml(o,l,a);s[a]?(s[a].p(u,i),A(s[a],1)):(s[a]=Nl(u),s[a].c(),A(s[a],1),s[a].m(t,null))}for(Ft(),a=l.length;a<s.length;a+=1)r(a);qt()}},i(o){if(!e){for(let i=0;i<l.length;i+=1)A(s[i]);e=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)j(s[i]);e=!1},d(o){o&&m(t),ye(s,o)}}}function ro(n){var b;let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375Z"></path><path d="M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25ZM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6Z"></path></svg>',s,r,o,i=(((b=n[71])==null?void 0:b.title)??`#${n[71].name}`)+"",a,u,c,d=n[22].t("Collection")+"",y;return{c(){t=I("div"),e=I("div"),e.innerHTML=l,s=G(),r=I("div"),o=I("div"),a=mt(i),u=G(),c=I("div"),y=mt(d),this.h()},l(p){t=M(p,"DIV",{class:!0});var _=S(t);e=M(_,"DIV",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-1h7831u"&&(e.innerHTML=l),s=J(_),r=M(_,"DIV",{class:!0});var h=S(r);o=M(h,"DIV",{class:!0});var v=S(o);a=ht(v,i),v.forEach(m),u=J(h),c=M(h,"DIV",{class:!0});var E=S(c);y=ht(E,d),E.forEach(m),h.forEach(m),_.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(o,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(c,"class","text-gray-500 text-sm"),f(r,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(p,_){P(p,t,_),w(t,e),w(t,s),w(t,r),w(r,o),w(o,a),w(r,u),w(r,c),w(c,y)},p(p,_){var h;_[0]&8&&i!==(i=(((h=p[71])==null?void 0:h.title)??`#${p[71].name}`)+"")&&wt(a,i),_[0]&4194304&&d!==(d=p[22].t("Collection")+"")&&wt(y,d)},i:It,o:It,d(p){p&&m(t)}}}function io(n){let t,e,l,s,r,o=n[71].name+"",i,a,u,c=n[22].t("Document")+"",d;function y(_,h){return _[71].upload_status?uo:co}let b=y(n),p=b(n);return{c(){t=I("div"),e=I("div"),p.c(),l=G(),s=I("div"),r=I("div"),i=mt(o),a=G(),u=I("div"),d=mt(c),this.h()},l(_){t=M(_,"DIV",{class:!0});var h=S(t);e=M(h,"DIV",{class:!0});var v=S(e);p.l(v),v.forEach(m),l=J(h),s=M(h,"DIV",{class:!0});var E=S(s);r=M(E,"DIV",{class:!0});var N=S(r);i=ht(N,o),N.forEach(m),a=J(E),u=M(E,"DIV",{class:!0});var D=S(u);d=ht(D,c),D.forEach(m),E.forEach(m),h.forEach(m),this.h()},h(){f(e,"class","p-2.5 bg-red-400 text-white rounded-lg"),f(r,"class","dark:text-gray-100 text-sm font-medium line-clamp-1"),f(u,"class","text-gray-500 text-sm"),f(s,"class","flex flex-col justify-center -space-y-0.5"),f(t,"class","h-16 w-[15rem] flex items-center space-x-3 px-2.5 dark:bg-gray-600 rounded-xl border border-gray-200 dark:border-none")},m(_,h){P(_,t,h),w(t,e),p.m(e,null),w(t,l),w(t,s),w(s,r),w(r,i),w(s,a),w(s,u),w(u,d)},p(_,h){b!==(b=y(_))&&(p.d(1),p=b(_),p&&(p.c(),p.m(e,null))),h[0]&8&&o!==(o=_[71].name+"")&&wt(i,o),h[0]&4194304&&c!==(c=_[22].t("Document")+"")&&wt(d,c)},i:It,o:It,d(_){_&&m(t),p.d()}}}function ao(n){let t,e,l,s,r,o=(n[0]?n[20].length===0:n[7].length!==n[20].length)&&Bl(n);return{c(){t=I("div"),e=I("img"),s=G(),o&&o.c(),this.h()},l(i){t=M(i,"DIV",{class:!0});var a=S(t);e=M(a,"IMG",{src:!0,alt:!0,class:!0}),s=J(a),o&&o.l(a),a.forEach(m),this.h()},h(){we(e.src,l=n[71].url)||f(e,"src",l),f(e,"alt","input"),f(e,"class","h-16 w-16 rounded-xl object-cover"),f(t,"class","relative")},m(i,a){P(i,t,a),w(t,e),w(t,s),o&&o.m(t,null),r=!0},p(i,a){(!r||a[0]&8&&!we(e.src,l=i[71].url))&&f(e,"src",l),(i[0]?i[20].length===0:i[7].length!==i[20].length)?o?(o.p(i,a),a[0]&1048705&&A(o,1)):(o=Bl(i),o.c(),A(o,1),o.m(t,null)):o&&(Ft(),j(o,1,1,()=>{o=null}),qt())},i(i){r||(A(o),r=!0)},o(i){j(o),r=!1},d(i){i&&m(t),o&&o.d()}}}function co(n){let t,e,l,s,r,o;return{c(){t=gt("svg"),e=gt("style"),l=mt(`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),s=gt("circle"),r=gt("circle"),o=gt("circle"),this.h()},l(i){t=pt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=S(t);e=pt(a,"style",{});var u=S(e);l=ht(u,`.spinner_qM83 {
																animation: spinner_8HQG 1.05s infinite;
															}
															.spinner_oXPr {
																animation-delay: 0.1s;
															}
															.spinner_ZTLf {
																animation-delay: 0.2s;
															}
															@keyframes spinner_8HQG {
																0%,
																57.14% {
																	animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																	transform: translate(0);
																}
																28.57% {
																	animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																	transform: translateY(-6px);
																}
																100% {
																	transform: translate(0);
																}
															}
														`),u.forEach(m),s=pt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(m),r=pt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(m),o=pt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-6 h-6 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){P(i,t,a),w(t,e),w(e,l),w(t,s),w(t,r),w(t,o)},d(i){i&&m(t)}}}function uo(n){let t,e,l;return{c(){t=gt("svg"),e=gt("path"),l=gt("path"),this.h()},l(s){t=pt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=pt(r,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),l=pt(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z"),f(e,"clip-rule","evenodd"),f(l,"d","M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","w-6 h-6")},m(s,r){P(s,t,r),w(t,e),w(t,l)},d(s){s&&m(t)}}}function Bl(n){let t,e;return t=new me({props:{className:" absolute top-1 left-1",content:n[22].t("{{ models }}",{models:[...n[0]?[n[0]]:n[7]].filter(n[50]).join(", ")}),$$slots:{default:[fo]},$$scope:{ctx:n}}}),{c(){st(t.$$.fragment)},l(l){ot(t.$$.fragment,l)},m(l,s){rt(t,l,s),e=!0},p(l,s){const r={};s[0]&5243009&&(r.content=l[22].t("{{ models }}",{models:[...l[0]?[l[0]]:l[7]].filter(l[50]).join(", ")})),s[2]&4096&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){j(t.$$.fragment,l),e=!1},d(l){it(t,l)}}}function fo(n){let t,e;return{c(){t=gt("svg"),e=gt("path"),this.h()},l(l){t=pt(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=S(t);e=pt(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),s.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4 fill-yellow-300")},m(l,s){P(l,t,s),w(t,e)},p:It,d(l){l&&m(t)}}}function Nl(n){let t,e,l,s,r,o,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,u,c,d;const y=[ao,io,ro],b=[];function p(h,v){return h[71].type==="image"?0:h[71].type==="doc"?1:h[71].type==="collection"?2:-1}~(e=p(n))&&(l=b[e]=y[e](n));function _(){return n[51](n[73])}return{c(){t=I("div"),l&&l.c(),s=G(),r=I("div"),o=I("button"),o.innerHTML=i,a=G(),this.h()},l(h){t=M(h,"DIV",{class:!0});var v=S(t);l&&l.l(v),s=J(v),r=M(v,"DIV",{class:!0});var E=S(r);o=M(E,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Kt(o)!=="svelte-3nr9d3"&&(o.innerHTML=i),E.forEach(m),a=J(v),v.forEach(m),this.h()},h(){f(o,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),f(o,"type","button"),f(r,"class","absolute -top-1 -right-1"),f(t,"class","relative group")},m(h,v){P(h,t,v),~e&&b[e].m(t,null),w(t,s),w(t,r),w(r,o),w(t,a),u=!0,c||(d=K(o,"click",_),c=!0)},p(h,v){n=h;let E=e;e=p(n),e===E?~e&&b[e].p(n,v):(l&&(Ft(),j(b[E],1,1,()=>{b[E]=null}),qt()),~e?(l=b[e],l?l.p(n,v):(l=b[e]=y[e](n),l.c()),A(l,1),l.m(t,s)):l=null)},i(h){u||(A(l),u=!0)},o(h){j(l),u=!1},d(h){h&&m(t),~e&&b[e].d(),c=!1,d()}}}function mo(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){t=I("button"),t.innerHTML=e,this.h()},l(l){t=M(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-wy6pwi"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-none focus:outline-none"),f(t,"type","button")},m(l,s){P(l,t,s)},p:It,d(l){l&&m(t)}}}function ho(n){let t,e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',l,s;return{c(){t=I("button"),t.innerHTML=e,this.h()},l(r){t=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-tod56q"&&(t.innerHTML=e),this.h()},h(){f(t,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,o){P(r,t,o),l||(s=K(t,"click",function(){fn(n[6])&&n[6].apply(this,arguments)}),l=!0)},p(r,o){n=r},i:It,o:It,d(r){r&&m(t),l=!1,s()}}}function go(n){let t,e,l,s;return t=new me({props:{content:n[22].t("Record voice"),$$slots:{default:[bo]},$$scope:{ctx:n}}}),l=new me({props:{content:n[22].t("Send message"),$$slots:{default:[vo]},$$scope:{ctx:n}}}),{c(){st(t.$$.fragment),e=G(),st(l.$$.fragment)},l(r){ot(t.$$.fragment,r),e=J(r),ot(l.$$.fragment,r)},m(r,o){rt(t,r,o),P(r,e,o),rt(l,r,o),s=!0},p(r,o){const i={};o[0]&4194304&&(i.content=r[22].t("Record voice")),o[0]&2097408|o[2]&4096&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o[0]&4194304&&(a.content=r[22].t("Send message")),o[0]&2|o[2]&4096&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(A(t.$$.fragment,r),A(l.$$.fragment,r),s=!0)},o(r){j(t.$$.fragment,r),j(l.$$.fragment,r),s=!1},d(r){r&&m(e),it(t,r),it(l,r)}}}function Ol(n){let t,e,l;function s(i,a){return i[21]?_o:po}let r=s(n),o=r(n);return{c(){t=I("button"),o.c(),this.h()},l(i){t=M(i,"BUTTON",{id:!0,class:!0,type:!0});var a=S(t);o.l(a),a.forEach(m),this.h()},h(){f(t,"id","voice-input-button"),f(t,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),f(t,"type","button")},m(i,a){P(i,t,a),o.m(t,null),e||(l=K(t,"click",n[62]),e=!0)},p(i,a){r!==(r=s(i))&&(o.d(1),o=r(i),o&&(o.c(),o.m(t,null)))},d(i){i&&m(t),o.d(),e=!1,l()}}}function po(n){let t,e,l;return{c(){t=gt("svg"),e=gt("path"),l=gt("path"),this.h()},l(s){t=pt(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var r=S(t);e=pt(r,"path",{d:!0}),S(e).forEach(m),l=pt(r,"path",{d:!0}),S(l).forEach(m),r.forEach(m),this.h()},h(){f(e,"d","M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"),f(l,"d","M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 20 20"),f(t,"fill","currentColor"),f(t,"class","w-5 h-5 translate-y-[0.5px]")},m(s,r){P(s,t,r),w(t,e),w(t,l)},d(s){s&&m(t)}}}function _o(n){let t,e,l,s,r,o;return{c(){t=gt("svg"),e=gt("style"),l=mt(`.spinner_qM83 {
															animation: spinner_8HQG 1.05s infinite;
														}
														.spinner_oXPr {
															animation-delay: 0.1s;
														}
														.spinner_ZTLf {
															animation-delay: 0.2s;
														}
														@keyframes spinner_8HQG {
															0%,
															57.14% {
																animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																transform: translate(0);
															}
															28.57% {
																animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																transform: translateY(-6px);
															}
															100% {
																transform: translate(0);
															}
														}
													`),s=gt("circle"),r=gt("circle"),o=gt("circle"),this.h()},l(i){t=pt(i,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=S(t);e=pt(a,"style",{});var u=S(e);l=ht(u,`.spinner_qM83 {
															animation: spinner_8HQG 1.05s infinite;
														}
														.spinner_oXPr {
															animation-delay: 0.1s;
														}
														.spinner_ZTLf {
															animation-delay: 0.2s;
														}
														@keyframes spinner_8HQG {
															0%,
															57.14% {
																animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
																transform: translate(0);
															}
															28.57% {
																animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
																transform: translateY(-6px);
															}
															100% {
																transform: translate(0);
															}
														}
													`),u.forEach(m),s=pt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(m),r=pt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(r).forEach(m),o=pt(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(m),a.forEach(m),this.h()},h(){f(s,"class","spinner_qM83"),f(s,"cx","4"),f(s,"cy","12"),f(s,"r","2.5"),f(r,"class","spinner_qM83 spinner_oXPr"),f(r,"cx","12"),f(r,"cy","12"),f(r,"r","2.5"),f(o,"class","spinner_qM83 spinner_ZTLf"),f(o,"cx","20"),f(o,"cy","12"),f(o,"r","2.5"),f(t,"class","w-5 h-5 translate-y-[0.5px]"),f(t,"fill","currentColor"),f(t,"viewBox","0 0 24 24"),f(t,"xmlns","http://www.w3.org/2000/svg")},m(i,a){P(i,t,a),w(t,e),w(e,l),w(t,s),w(t,r),w(t,o)},d(i){i&&m(t)}}}function bo(n){let t,e=n[8]&&Ol(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),P(l,t,s)},p(l,s){l[8]?e?e.p(l,s):(e=Ol(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){l&&m(t),e&&e.d(l)}}}function vo(n){let t,e,l,s,r;return{c(){t=I("button"),e=gt("svg"),l=gt("path"),this.h()},l(o){t=M(o,"BUTTON",{id:!0,class:!0,type:!0});var i=S(t);e=pt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(e);l=pt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"fill-rule","evenodd"),f(l,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),f(l,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16"),f(e,"fill","currentColor"),f(e,"class","w-5 h-5"),f(t,"id","send-message-button"),f(t,"class",s=(n[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),f(t,"type","submit"),t.disabled=r=n[1]===""},m(o,i){P(o,t,i),w(t,e),w(e,l)},p(o,i){i[0]&2&&s!==(s=(o[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&f(t,"class",s),i[0]&2&&r!==(r=o[1]==="")&&(t.disabled=r)},d(o){o&&m(t)}}}function wo(n){let t,e,l,s,r,o,i,a,u,c,d,y,b,p,_,h,v,E,N,D,V,T,B,C,Q,R,L,O,ut,$,lt,Mt,Qt,Lt,Et,Pt,Tt,Wt,Xt,Yt,F=n[22].t("LLMs can make mistakes. Verify important information.")+"",W,et,Rt,jt,ft=n[17]&&Dl(n),Ut=n[2]===!1&&n[9].length>0&&Cl(n);const he=[oo,so],xt=[];function ge(g,H){return H[0]&2&&(a=null),H[0]&2&&(u=null),a==null&&(a=g[1].charAt(0)==="/"),a?0:(u==null&&(u=g[1].charAt(0)==="#"),u?1:-1)}~(c=ge(n,[-1,-1,-1]))&&(d=xt[c]=he[c](n));function Se(g){n[41](g)}function Ie(g){n[42](g)}function Me(g){n[43](g)}let fe={messages:n[9]};n[1]!==void 0&&(fe.prompt=n[1]),n[18]!==void 0&&(fe.user=n[18]),n[19]!==void 0&&(fe.chatInputPlaceholder=n[19]),b=new js({props:fe}),n[40](b),bt.push(()=>Ot(b,"prompt",Se)),bt.push(()=>Ot(b,"user",Ie)),bt.push(()=>Ot(b,"chatInputPlaceholder",Me)),b.$on("select",n[44]);let Dt=n[0]!==void 0&&Tl(n),Ct=n[3].length>0&&Vl(n);function De(g){n[54](g)}let pe={uploadFilesHandler:n[52],onClose:n[53],$$slots:{default:[mo]},$$scope:{ctx:n}};n[4]!==void 0&&(pe.webSearchEnabled=n[4]),O=new no({props:pe}),bt.push(()=>Ot(O,"webSearchEnabled",De));const _e=[go,ho],$t=[];function be(g,H){return H[0]&512&&(Et=null),Et==null&&(Et=g[9].length==0||g[9].at(-1).done==!0),Et?0:1}return Pt=be(n,[-1,-1,-1]),Tt=$t[Pt]=_e[Pt](n),{c(){ft&&ft.c(),t=G(),e=I("div"),l=I("div"),s=I("div"),r=I("div"),Ut&&Ut.c(),o=G(),i=I("div"),d&&d.c(),y=G(),st(b.$$.fragment),v=G(),Dt&&Dt.c(),E=G(),N=I("div"),D=I("div"),V=I("div"),T=I("input"),B=G(),C=I("form"),Ct&&Ct.c(),Q=G(),R=I("div"),L=I("div"),st(O.$$.fragment),$=G(),lt=I("textarea"),Qt=G(),Lt=I("div"),Tt.c(),Xt=G(),Yt=I("div"),W=mt(F),this.h()},l(g){ft&&ft.l(g),t=J(g),e=M(g,"DIV",{class:!0});var H=S(e);l=M(H,"DIV",{class:!0});var Y=S(l);s=M(Y,"DIV",{class:!0});var q=S(s);r=M(q,"DIV",{class:!0});var z=S(r);Ut&&Ut.l(z),z.forEach(m),o=J(q),i=M(q,"DIV",{class:!0});var Z=S(i);d&&d.l(Z),y=J(Z),ot(b.$$.fragment,Z),v=J(Z),Dt&&Dt.l(Z),Z.forEach(m),q.forEach(m),Y.forEach(m),E=J(H),N=M(H,"DIV",{class:!0});var kt=S(N);D=M(kt,"DIV",{class:!0});var St=S(D);V=M(St,"DIV",{class:!0});var vt=S(V);T=M(vt,"INPUT",{type:!0}),B=J(vt),C=M(vt,"FORM",{dir:!0,class:!0});var zt=S(C);Ct&&Ct.l(zt),Q=J(zt),R=M(zt,"DIV",{class:!0});var Vt=S(R);L=M(Vt,"DIV",{class:!0});var k=S(L);ot(O.$$.fragment,k),k.forEach(m),$=J(Vt),lt=M(Vt,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),S(lt).forEach(m),Qt=J(Vt),Lt=M(Vt,"DIV",{class:!0});var X=S(Lt);Tt.l(X),X.forEach(m),Vt.forEach(m),zt.forEach(m),Xt=J(vt),Yt=M(vt,"DIV",{class:!0});var x=S(Yt);W=ht(x,F),x.forEach(m),vt.forEach(m),St.forEach(m),kt.forEach(m),H.forEach(m),this.h()},h(){var g;f(r,"class","relative"),f(i,"class","w-full relative"),f(s,"class","flex flex-col max-w-6xl px-2.5 md:px-6 w-full"),f(l,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),f(T,"type","file"),T.hidden=!0,T.multiple=!0,f(L,"class","ml-1 self-end mb-2 flex space-x-1"),f(lt,"id","chat-textarea"),f(lt,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-3 rounded-xl resize-none h-[48px] svelte-141e0sl"),f(lt,"placeholder",Mt=n[19]!==""?n[19]:n[21]?n[22].t("Listening..."):n[22].t("Send a Message")),f(lt,"rows","1"),f(Lt,"class","self-end mb-2 flex space-x-1 mr-1"),f(R,"class","flex"),f(C,"dir",Wt=((g=n[23])==null?void 0:g.chatDirection)??"LTR"),f(C,"class","flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),f(Yt,"class","mt-1.5 text-xs text-gray-500 text-center"),f(V,"class","pb-2"),f(D,"class","max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0"),f(N,"class","bg-white dark:bg-gray-900"),f(e,"class","w-full")},m(g,H){ft&&ft.m(g,H),P(g,t,H),P(g,e,H),w(e,l),w(l,s),w(s,r),Ut&&Ut.m(r,null),w(s,o),w(s,i),~c&&xt[c].m(i,null),w(i,y),rt(b,i,null),w(i,v),Dt&&Dt.m(i,null),w(e,E),w(e,N),w(N,D),w(D,V),w(V,T),n[47](T),w(V,B),w(V,C),Ct&&Ct.m(C,null),w(C,Q),w(C,R),w(R,L),rt(O,L,null),w(R,$),w(R,lt),n[55](lt),Qe(lt,n[1]),w(R,Qt),w(R,Lt),$t[Pt].m(Lt,null),w(V,Xt),w(V,Yt),w(Yt,W),et=!0,Rt||(jt=[K(T,"change",n[48]),K(T,"change",n[49]),K(lt,"input",n[56]),K(lt,"keypress",n[57]),K(lt,"keydown",n[58]),K(lt,"input",n[59]),K(lt,"focus",n[60]),K(lt,"paste",n[61]),K(C,"submit",un(n[63]))],Rt=!0)},p(g,H){var kt;g[17]?ft?(ft.p(g,H),H[0]&131072&&A(ft,1)):(ft=Dl(g),ft.c(),A(ft,1),ft.m(t.parentNode,t)):ft&&(Ft(),j(ft,1,1,()=>{ft=null}),qt()),g[2]===!1&&g[9].length>0?Ut?Ut.p(g,H):(Ut=Cl(g),Ut.c(),Ut.m(r,null)):Ut&&(Ut.d(1),Ut=null);let Y=c;c=ge(g,H),c===Y?~c&&xt[c].p(g,H):(d&&(Ft(),j(xt[Y],1,1,()=>{xt[Y]=null}),qt()),~c?(d=xt[c],d?d.p(g,H):(d=xt[c]=he[c](g),d.c()),A(d,1),d.m(i,y)):d=null);const q={};H[0]&512&&(q.messages=g[9]),!p&&H[0]&2&&(p=!0,q.prompt=g[1],Nt(()=>p=!1)),!_&&H[0]&262144&&(_=!0,q.user=g[18],Nt(()=>_=!1)),!h&&H[0]&524288&&(h=!0,q.chatInputPlaceholder=g[19],Nt(()=>h=!1)),b.$set(q),g[0]!==void 0?Dt?(Dt.p(g,H),H[0]&1&&A(Dt,1)):(Dt=Tl(g),Dt.c(),A(Dt,1),Dt.m(i,null)):Dt&&(Ft(),j(Dt,1,1,()=>{Dt=null}),qt()),g[3].length>0?Ct?(Ct.p(g,H),H[0]&8&&A(Ct,1)):(Ct=Vl(g),Ct.c(),A(Ct,1),Ct.m(C,Q)):Ct&&(Ft(),j(Ct,1,1,()=>{Ct=null}),qt());const z={};H[0]&4096&&(z.uploadFilesHandler=g[52]),H[0]&1024&&(z.onClose=g[53]),H[2]&4096&&(z.$$scope={dirty:H,ctx:g}),!ut&&H[0]&16&&(ut=!0,z.webSearchEnabled=g[4],Nt(()=>ut=!1)),O.$set(z),(!et||H[0]&6815744&&Mt!==(Mt=g[19]!==""?g[19]:g[21]?g[22].t("Listening..."):g[22].t("Send a Message")))&&f(lt,"placeholder",Mt),H[0]&2&&Qe(lt,g[1]);let Z=Pt;Pt=be(g,H),Pt===Z?$t[Pt].p(g,H):(Ft(),j($t[Z],1,1,()=>{$t[Z]=null}),qt(),Tt=$t[Pt],Tt?Tt.p(g,H):(Tt=$t[Pt]=_e[Pt](g),Tt.c()),A(Tt,1),Tt.m(Lt,null)),(!et||H[0]&8388608&&Wt!==(Wt=((kt=g[23])==null?void 0:kt.chatDirection)??"LTR"))&&f(C,"dir",Wt),(!et||H[0]&4194304)&&F!==(F=g[22].t("LLMs can make mistakes. Verify important information.")+"")&&wt(W,F)},i(g){et||(A(ft),A(d),A(b.$$.fragment,g),A(Dt),A(Ct),A(O.$$.fragment,g),A(Tt),et=!0)},o(g){j(ft),j(d),j(b.$$.fragment,g),j(Dt),j(Ct),j(O.$$.fragment,g),j(Tt),et=!1},d(g){g&&(m(t),m(e)),ft&&ft.d(g),Ut&&Ut.d(),~c&&xt[c].d(),n[40](null),it(b),Dt&&Dt.d(),n[47](null),Ct&&Ct.d(),it(O),n[55](null),$t[Pt].d(),Rt=!1,ie(jt)}}}function ko(n,t,e){let l,s,r,o,i;ct(n,ce,k=>e(23,s=k)),ct(n,Le,k=>e(11,r=k)),ct(n,Oe,k=>e(24,o=k)),ct(n,tn,k=>e(25,i=k));const a=ue("i18n");ct(n,a,k=>e(22,l=k));let{submitPrompt:u}=t,{stopResponse:c}=t,{autoScroll:d=!0}=t,{atSelectedModel:y}=t,{selectedModels:b}=t,p,_,h,v,E,N,D=!1,V=null,T="",{files:B=[]}=t,{speechRecognitionEnabled:C=!0}=t,{webSearchEnabled:Q=!1}=t,{prompt:R=""}=t,{messages:L=[]}=t,O,ut=[],$,lt=[],Mt=!1;const Qt=-45,Lt=()=>{const k=document.getElementById("messages-container");k.scrollTop=k.scrollHeight},Et=async()=>{const k=await navigator.mediaDevices.getUserMedia({audio:!0});$=new MediaRecorder(k),$.onstart=()=>{e(21,Mt=!0),console.log("Recording started")},$.ondataavailable=X=>lt.push(X.data),$.onstop=async()=>{e(21,Mt=!1),console.log("Recording stopped");const X=new Blob(lt,{type:"audio/wav"}),x=tl(X,"recording.wav"),U=await ol(localStorage.token,x).catch(tt=>(_t.error(tt),null));U&&(e(1,R=U.text),await yt(),p==null||p.focus(),R!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(R,V)),lt=[]},$.start(),Pt(k)},Pt=k=>{const X=new AudioContext,x=X.createMediaStreamSource(k),U=X.createAnalyser();U.minDecibels=Qt,x.connect(U);const tt=U.frequencyBinCount,nt=new Uint8Array(tt);let Bt=Date.now();const at=()=>{if(U.getByteFrequencyData(nt),nt.some(dt=>dt>0)&&(Bt=Date.now()),Mt&&Date.now()-Bt>3e3){$.stop(),X.close();return}window.requestAnimationFrame(at)};window.requestAnimationFrame(at)},Tt=()=>{var k;if(Mt)O&&O.stop(),$&&$.stop();else if(e(21,Mt=!0),((k=s==null?void 0:s.audio)==null?void 0:k.STTEngine)??!1)Et();else if("SpeechRecognition"in window||"webkitSpeechRecognition"in window){O=new(window.SpeechRecognition||window.webkitSpeechRecognition),O.continuous=!0;const X=3e3;let x;O.start(),O.onresult=async U=>{clearTimeout(x),console.log(U);const tt=U.results[Object.keys(U.results).length-1][0].transcript;e(1,R=`${R}${tt}`),await yt(),p==null||p.focus(),x=setTimeout(()=>{console.log("Speech recognition turned off due to inactivity."),O.stop()},X)},O.onend=function(){console.log("recognition ended"),e(21,Mt=!1),R!==""&&(s==null?void 0:s.speechAutoSend)===!0&&u(R,V)},O.onerror=function(U){console.log(U),_t.error(l.t("Speech recognition error: {{error}}",{error:U.error})),e(21,Mt=!1)}}else _t.error(l.t("SpeechRecognition API is not supported in this browser."))},Wt=async k=>{console.log(k);const X={type:"doc",name:k.name,collection_name:"",upload_status:!1,error:""};try{if(e(3,B=[...B,X]),["audio/mpeg","audio/wav"].includes(k.type)){const U=await ol(localStorage.token,k).catch(tt=>(_t.error(tt),null));if(U){console.log(U);const tt=new Blob([U.text],{type:"text/plain"});k=tl(tt,`${k.name}.txt`)}}const x=await Nn(localStorage.token,"",k);x&&(X.upload_status=!0,X.collection_name=x.collection_name,e(3,B))}catch(x){e(3,B=B.filter(U=>U.name!==k.name)),_t.error(x)}},Xt=async k=>{console.log(k);const X={type:"doc",name:k,collection_name:"",upload_status:!1,url:k,error:""};try{e(3,B=[...B,X]);const x=await On(localStorage.token,"",k);x&&(X.upload_status=!0,X.collection_name=x.collection_name,e(3,B))}catch(x){e(3,B=B.filter(U=>U.name!==k)),_t.error(x)}},Yt=async k=>{console.log(k);const X={type:"doc",name:k,collection_name:"",upload_status:!1,url:k,error:""};try{e(3,B=[...B,X]);const x=await Hn(localStorage.token,k);x&&(X.upload_status=!0,X.collection_name=x.collection_name,e(3,B))}catch(x){e(3,B=B.filter(U=>U.name!==k)),_t.error(x)}};qe(()=>{window.setTimeout(()=>p==null?void 0:p.focus(),0);const k=document.querySelector("body"),X=nt=>{nt.key==="Escape"&&(console.log("Escape"),e(17,D=!1))},x=nt=>{nt.preventDefault(),e(17,D=!0)},U=()=>{e(17,D=!1)},tt=async nt=>{var Bt,at;if(nt.preventDefault(),console.log(nt),(Bt=nt.dataTransfer)!=null&&Bt.files){const dt=Array.from((at=nt.dataTransfer)==null?void 0:at.files);dt&&dt.length>0?dt.forEach(At=>{if(console.log(At,At.name.split(".").at(-1)),["image/gif","image/webp","image/jpeg","image/png"].includes(At.type)){if(ut.length===0){_t.error(l.t("Selected model(s) do not support image inputs"));return}let de=new FileReader;de.onload=ae=>{e(3,B=[...B,{type:"image",url:`${ae.target.result}`}])},de.readAsDataURL(At)}else Xe.includes(At.type)||Ke.includes(At.name.split(".").at(-1))||_t.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:At.type})),Wt(At)}):_t.error(l.t("File not found."))}e(17,D=!1)};return window.addEventListener("keydown",X),k==null||k.addEventListener("dragover",x),k==null||k.addEventListener("drop",tt),k==null||k.addEventListener("dragleave",U),()=>{window.removeEventListener("keydown",X),k==null||k.removeEventListener("dragover",x),k==null||k.removeEventListener("drop",tt),k==null||k.removeEventListener("dragleave",U)}});const F=()=>{e(2,d=!0),Lt()};function W(k){bt[k?"unshift":"push"](()=>{h=k,e(13,h)})}function et(k){R=k,e(1,R)}function Rt(k){bt[k?"unshift":"push"](()=>{v=k,e(14,v)})}function jt(k){R=k,e(1,R)}const ft=k=>{console.log(k),Yt(k.detail)},Ut=k=>{console.log(k),Xt(k.detail)},he=k=>{var X;console.log(k),e(3,B=[...B,{type:((X=k==null?void 0:k.detail)==null?void 0:X.type)??"doc",...k.detail,upload_status:!0}])};function xt(k){bt[k?"unshift":"push"](()=>{E=k,e(15,E)})}function ge(k){R=k,e(1,R)}function Se(k){V=k,e(18,V)}function Ie(k){T=k,e(19,T)}const Me=k=>{e(0,y=k.detail),p==null||p.focus()},fe=k=>k.id===y.id,Dt=()=>{e(0,y=void 0)};function Ct(k){bt[k?"unshift":"push"](()=>{_=k,e(12,_)})}function De(){N=this.files,e(16,N)}const pe=async()=>{N&&N.length>0?Array.from(N).forEach(X=>{if(["image/gif","image/webp","image/jpeg","image/png"].includes(X.type)){if(ut.length===0){_t.error(l.t("Selected model(s) do not support image inputs")),e(16,N=null),e(12,_.value="",_);return}let x=new FileReader;x.onload=U=>{e(3,B=[...B,{type:"image",url:`${U.target.result}`}]),e(16,N=null),e(12,_.value="",_)},x.readAsDataURL(X)}else Xe.includes(X.type)||Ke.includes(X.name.split(".").at(-1))?(Wt(X),e(12,_.value="",_)):(_t.error(l.t("Unknown File Type '{{file_type}}', but accepting and treating as plain text",{file_type:X.type})),Wt(X),e(12,_.value="",_))}):_t.error(l.t("File not found."))},_e=k=>!ut.includes(k),$t=k=>{B.splice(k,1),e(3,B)},be=()=>{_.click()},g=async()=>{await yt(),p==null||p.focus()};function H(k){Q=k,e(4,Q)}function Y(k){bt[k?"unshift":"push"](()=>{p=k,e(10,p),e(1,R)})}function q(){R=this.value,e(1,R)}const z=k=>{(!i||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(k.key==="Enter"&&!k.shiftKey&&k.preventDefault(),R!==""&&k.key==="Enter"&&!k.shiftKey&&u(R,V))},Z=async k=>{var x;const X=k.ctrlKey||k.metaKey;if(R===""&&X&&k.key.toLowerCase()==="r"){k.preventDefault(),console.log("regenerate");const U=[...document.getElementsByClassName("regenerate-response-button")].at(-1);U==null||U.click()}if(R===""&&k.key=="ArrowUp"){k.preventDefault();const U=[...document.getElementsByClassName("user-message")].at(-1),tt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(U),U.scrollIntoView({block:"center"}),tt==null||tt.click()}if(["/","#","@"].includes(R.charAt(0))&&k.key==="ArrowUp"&&(k.preventDefault(),(h||v||E).selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(R.charAt(0))&&k.key==="ArrowDown"&&(k.preventDefault(),(h||v||E).selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),["/","#","@"].includes(R.charAt(0))&&k.key==="Enter"){k.preventDefault();const U=[...document.getElementsByClassName("selected-command-option-button")].at(-1);k.shiftKey?e(1,R=`${R}
`):U?U==null||U.click():(x=document.getElementById("send-message-button"))==null||x.click()}if(["/","#","@"].includes(R.charAt(0))&&k.key==="Tab"){k.preventDefault();const U=[...document.getElementsByClassName("selected-command-option-button")].at(-1);U==null||U.click()}else if(k.key==="Tab"){const U=nn(R);if(U.length>0){const tt=U.at(0),nt=R;e(1,R=R.substring(0,(tt==null?void 0:tt.endIndex)+1)),await yt(),k.target.scrollTop=k.target.scrollHeight,e(1,R=nt),await yt(),k.preventDefault(),k.target.setSelectionRange(tt==null?void 0:tt.startIndex,tt.endIndex+1)}k.target.style.height="",k.target.style.height=Math.min(k.target.scrollHeight,200)+"px"}k.key==="Escape"&&(console.log("Escape"),e(0,y=void 0))},kt=k=>{k.target.style.height="",k.target.style.height=Math.min(k.target.scrollHeight,200)+"px",e(18,V=null)},St=k=>{k.target.style.height="",k.target.style.height=Math.min(k.target.scrollHeight,200)+"px"},vt=k=>{const X=k.clipboardData||window.clipboardData;if(X&&X.items){for(const x of X.items)if(x.type.indexOf("image")!==-1){const U=x.getAsFile(),tt=new FileReader;tt.onload=function(nt){e(3,B=[...B,{type:"image",url:`${nt.target.result}`}])},tt.readAsDataURL(U)}}},zt=()=>{Tt()},Vt=()=>{u(R,V)};return n.$$set=k=>{"submitPrompt"in k&&e(5,u=k.submitPrompt),"stopResponse"in k&&e(6,c=k.stopResponse),"autoScroll"in k&&e(2,d=k.autoScroll),"atSelectedModel"in k&&e(0,y=k.atSelectedModel),"selectedModels"in k&&e(7,b=k.selectedModels),"files"in k&&e(3,B=k.files),"speechRecognitionEnabled"in k&&e(8,C=k.speechRecognitionEnabled),"webSearchEnabled"in k&&e(4,Q=k.webSearchEnabled),"prompt"in k&&e(1,R=k.prompt),"messages"in k&&e(9,L=k.messages)},n.$$.update=()=>{n.$$.dirty[0]&2177&&e(20,ut=[...y?[y]:b].filter(k=>{var X,x,U,tt;return((tt=(U=(x=(X=r.find(nt=>nt.id===k))==null?void 0:X.info)==null?void 0:x.meta)==null?void 0:U.capabilities)==null?void 0:tt.vision)??!0})),n.$$.dirty[0]&1026&&R&&p&&(e(10,p.style.height="",p),e(10,p.style.height=Math.min(p.scrollHeight,200)+"px",p))},[y,R,d,B,Q,u,c,b,C,L,p,r,_,h,v,E,N,D,V,T,ut,Mt,l,s,o,i,a,Lt,Tt,Wt,Xt,Yt,F,W,et,Rt,jt,ft,Ut,he,xt,ge,Se,Ie,Me,fe,Dt,Ct,De,pe,_e,$t,be,g,H,Y,q,z,Z,kt,St,vt,zt,Vt]}class yo extends Gt{constructor(t){super(),Jt(this,t,ko,wo,Zt,{submitPrompt:5,stopResponse:6,autoScroll:2,atSelectedModel:0,selectedModels:7,files:3,speechRecognitionEnabled:8,webSearchEnabled:4,prompt:1,messages:9},null,[-1,-1,-1])}}function Hl(n,t,e){const l=n.slice();return l[12]=t[e],l[13]=t,l[14]=e,l}function Eo(n){let t,e,l;return e=new me({props:{content:n[4].t("Remove Model"),$$slots:{default:[Io]},$$scope:{ctx:n}}}),{c(){t=I("div"),st(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);ot(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center disabled:text-gray-600 disabled:hover:text-gray-600 mr-2")},m(s,r){P(s,t,r),rt(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Remove Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),l=!1},d(s){s&&m(t),it(e)}}}function So(n){let t,e,l;return e=new me({props:{content:n[4].t("Add Model"),$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){t=I("div"),st(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);ot(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"class","self-center mr-2 disabled:text-gray-600 disabled:hover:text-gray-600")},m(s,r){P(s,t,r),rt(e,t,null),l=!0},p(s,r){const o={};r&16&&(o.content=s[4].t("Add Model")),r&32771&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),l=!1},d(s){s&&m(t),it(e)}}}function Io(n){let t,e,l,s,r;function o(){return n[10](n[14])}return{c(){t=I("button"),e=gt("svg"),l=gt("path"),this.h()},l(i){t=M(i,"BUTTON",{});var a=S(t);e=pt(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=S(e);l=pt(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),u.forEach(m),a.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M19.5 12h-15"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),t.disabled=n[1]},m(i,a){P(i,t,a),w(t,e),w(e,l),s||(r=K(t,"click",o),s=!0)},p(i,a){n=i,a&2&&(t.disabled=n[1])},d(i){i&&m(t),s=!1,r()}}}function Mo(n){let t,e,l,s,r;return{c(){t=I("button"),e=gt("svg"),l=gt("path"),this.h()},l(o){t=M(o,"BUTTON",{class:!0});var i=S(t);e=pt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(e);l=pt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),a.forEach(m),i.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M12 6v12m6-6H6"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","2"),f(e,"stroke","currentColor"),f(e,"class","size-3.5"),f(t,"class",""),t.disabled=n[1]},m(o,i){P(o,t,i),w(t,e),w(e,l),s||(r=K(t,"click",n[9]),s=!0)},p(o,i){i&2&&(t.disabled=o[1])},d(o){o&&m(t),s=!1,r()}}}function Al(n){let t,e,l,s,r,o,i,a,u,c;function d(h){n[8](h,n[12],n[13],n[14])}let y={placeholder:n[4].t("Select a model"),items:n[3].map(Pl)};n[12]!==void 0&&(y.value=n[12]),s=new Gn({props:y}),bt.push(()=>Ot(s,"value",d));const b=[So,Eo],p=[];function _(h,v){return h[14]===0?0:1}return i=_(n),a=p[i]=b[i](n),{c(){t=I("div"),e=I("div"),l=I("div"),st(s.$$.fragment),o=G(),a.c(),u=G(),this.h()},l(h){t=M(h,"DIV",{class:!0});var v=S(t);e=M(v,"DIV",{class:!0});var E=S(e);l=M(E,"DIV",{class:!0});var N=S(l);ot(s.$$.fragment,N),N.forEach(m),E.forEach(m),o=J(v),a.l(v),u=J(v),v.forEach(m),this.h()},h(){f(l,"class","mr-1 max-w-full"),f(e,"class","overflow-hidden w-full"),f(t,"class","flex w-full max-w-fit")},m(h,v){P(h,t,v),w(t,e),w(e,l),rt(s,l,null),w(t,o),p[i].m(t,null),w(t,u),c=!0},p(h,v){n=h;const E={};v&16&&(E.placeholder=n[4].t("Select a model")),v&8&&(E.items=n[3].map(Pl)),!r&&v&1&&(r=!0,E.value=n[12],Nt(()=>r=!1)),s.$set(E),a.p(n,v)},i(h){c||(A(s.$$.fragment,h),A(a),c=!0)},o(h){j(s.$$.fragment,h),j(a),c=!1},d(h){h&&m(t),it(s),p[i].d()}}}function Ll(n){let t,e,l=n[4].t("Set as default")+"",s,r,o;return{c(){t=I("div"),e=I("button"),s=mt(l),this.h()},l(i){t=M(i,"DIV",{class:!0});var a=S(t);e=M(a,"BUTTON",{});var u=S(e);s=ht(u,l),u.forEach(m),a.forEach(m),this.h()},h(){f(t,"class","text-left mt-0.5 ml-1 text-[0.7rem] text-gray-500")},m(i,a){P(i,t,a),w(t,e),w(e,s),r||(o=K(e,"click",n[7]),r=!0)},p(i,a){a&16&&l!==(l=i[4].t("Set as default")+"")&&wt(s,l)},d(i){i&&m(t),r=!1,o()}}}function Do(n){let t,e,l,s,r=ee(n[0]),o=[];for(let u=0;u<r.length;u+=1)o[u]=Al(Hl(n,r,u));const i=u=>j(o[u],1,1,()=>{o[u]=null});let a=n[2]&&!n[5]&&Ll(n);return{c(){t=I("div");for(let u=0;u<o.length;u+=1)o[u].c();e=G(),a&&a.c(),l=Ht(),this.h()},l(u){t=M(u,"DIV",{class:!0});var c=S(t);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),e=J(u),a&&a.l(u),l=Ht(),this.h()},h(){f(t,"class","flex flex-col w-full items-center md:items-start")},m(u,c){P(u,t,c);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(t,null);P(u,e,c),a&&a.m(u,c),P(u,l,c),s=!0},p(u,[c]){if(c&27){r=ee(u[0]);let d;for(d=0;d<r.length;d+=1){const y=Hl(u,r,d);o[d]?(o[d].p(y,c),A(o[d],1)):(o[d]=Al(y),o[d].c(),A(o[d],1),o[d].m(t,null))}for(Ft(),d=r.length;d<o.length;d+=1)i(d);qt()}u[2]&&!u[5]?a?a.p(u,c):(a=Ll(u),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i(u){if(!s){for(let c=0;c<r.length;c+=1)A(o[c]);s=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)j(o[c]);s=!1},d(u){u&&(m(t),m(e),m(l)),ye(o,u),a&&a.d(u)}}}const Pl=n=>({value:n.id,label:n.name,model:n});function Co(n,t,e){let l,s,r,o;ct(n,Le,_=>e(3,l=_)),ct(n,ce,_=>e(11,r=_)),ct(n,tn,_=>e(5,o=_));const i=ue("i18n");ct(n,i,_=>e(4,s=_));let{selectedModels:a=[""]}=t,{disabled:u=!1}=t,{showSetDefault:c=!0}=t;const d=async()=>{if(a.filter(h=>h==="").length){_t.error(s.t("Choose a model before saving..."));return}ce.set({...r,models:a}),await Dn(localStorage.token,{ui:r}),_t.success(s.t("Default model updated"))};function y(_,h,v,E){v[E]=_,e(0,a),e(3,l)}const b=()=>{e(0,a=[...a,""])},p=_=>{a.splice(_,1),e(0,a),e(3,l)};return n.$$set=_=>{"selectedModels"in _&&e(0,a=_.selectedModels),"disabled"in _&&e(1,u=_.disabled),"showSetDefault"in _&&e(2,c=_.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&a.length>0&&l.length>0&&e(0,a=a.map(_=>l.map(h=>h.id).includes(_)?_:""))},[a,u,c,l,s,o,i,d,y,b,p]}class To extends Gt{constructor(t){super(),Jt(this,t,Co,Do,Zt,{selectedModels:0,disabled:1,showSetDefault:2})}}function Vo(n){let t;const e=n[10].default,l=le(e,n,n[16],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,r){l&&l.m(s,r),t=!0},p(s,r){l&&l.p&&(!t||r&65536)&&ne(l,e,s,s[16],t?oe(e,s[16],r,null):se(s[16]),null)},i(s){t||(A(l,s),t=!0)},o(s){j(l,s),t=!1},d(s){l&&l.d(s)}}}function Bo(n){let t,e,l,s,r=n[3].t("Share")+"",o;return{c(){t=gt("svg"),e=gt("path"),l=G(),s=I("div"),o=mt(r),this.h()},l(i){t=pt(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(t);e=pt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(e).forEach(m),a.forEach(m),l=J(i),s=M(i,"DIV",{class:!0});var u=S(s);o=ht(u,r),u.forEach(m),this.h()},h(){f(e,"fill-rule","evenodd"),f(e,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),f(e,"clip-rule","evenodd"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 0 24 24"),f(t,"fill","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){P(i,t,a),w(t,e),P(i,l,a),P(i,s,a),w(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Share")+"")&&wt(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function No(n){let t,e,l,s,r=n[3].t("Download")+"",o;return{c(){t=gt("svg"),e=gt("path"),l=G(),s=I("div"),o=mt(r),this.h()},l(i){t=pt(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(t);e=pt(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(e).forEach(m),a.forEach(m),l=J(i),s=M(i,"DIV",{class:!0});var u=S(s);o=ht(u,r),u.forEach(m),this.h()},h(){f(e,"stroke-linecap","round"),f(e,"stroke-linejoin","round"),f(e,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(t,"stroke-width","1.5"),f(t,"stroke","currentColor"),f(t,"class","size-4"),f(s,"class","flex items-center")},m(i,a){P(i,t,a),w(t,e),P(i,l,a),P(i,s,a),w(s,o)},p(i,a){a&8&&r!==(r=i[3].t("Download")+"")&&wt(o,r)},d(i){i&&(m(t),m(l),m(s))}}}function Oo(n){let t,e=n[3].t("Export chat (.json)")+"",l;return{c(){t=I("div"),l=mt(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=ht(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){P(s,t,r),w(t,l)},p(s,r){r&8&&e!==(e=s[3].t("Export chat (.json)")+"")&&wt(l,e)},d(s){s&&m(t)}}}function Ho(n){let t,e=n[3].t("Plain text (.txt)")+"",l;return{c(){t=I("div"),l=mt(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=ht(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){P(s,t,r),w(t,l)},p(s,r){r&8&&e!==(e=s[3].t("Plain text (.txt)")+"")&&wt(l,e)},d(s){s&&m(t)}}}function Ao(n){let t,e=n[3].t("PDF document (.pdf)")+"",l;return{c(){t=I("div"),l=mt(e),this.h()},l(s){t=M(s,"DIV",{class:!0});var r=S(t);l=ht(r,e),r.forEach(m),this.h()},h(){f(t,"class","flex items-center line-clamp-1")},m(s,r){P(s,t,r),w(t,l)},p(s,r){r&8&&e!==(e=s[3].t("PDF document (.pdf)")+"")&&wt(l,e)},d(s){s&&m(t)}}}function Lo(n){let t,e,l,s,r,o;return t=new Ve({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Oo]},$$scope:{ctx:n}}}),t.$on("click",n[12]),l=new Ve({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),l.$on("click",n[13]),r=new Ve({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Ao]},$$scope:{ctx:n}}}),r.$on("click",n[14]),{c(){st(t.$$.fragment),e=G(),st(l.$$.fragment),s=G(),st(r.$$.fragment)},l(i){ot(t.$$.fragment,i),e=J(i),ot(l.$$.fragment,i),s=J(i),ot(r.$$.fragment,i)},m(i,a){rt(t,i,a),P(i,e,a),rt(l,i,a),P(i,s,a),rt(r,i,a),o=!0},p(i,a){const u={};a&65544&&(u.$$scope={dirty:a,ctx:i}),t.$set(u);const c={};a&65544&&(c.$$scope={dirty:a,ctx:i}),l.$set(c);const d={};a&65544&&(d.$$scope={dirty:a,ctx:i}),r.$set(d)},i(i){o||(A(t.$$.fragment,i),A(l.$$.fragment,i),A(r.$$.fragment,i),o=!0)},o(i){j(t.$$.fragment,i),j(l.$$.fragment,i),j(r.$$.fragment,i),o=!1},d(i){i&&(m(e),m(s)),it(t,i),it(l,i),it(r,i)}}}function Po(n){let t,e,l,s;return t=new Es({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[No]},$$scope:{ctx:n}}}),l=new ps({props:{class:"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:We,sideOffset:8,$$slots:{default:[Lo]},$$scope:{ctx:n}}}),{c(){st(t.$$.fragment),e=G(),st(l.$$.fragment)},l(r){ot(t.$$.fragment,r),e=J(r),ot(l.$$.fragment,r)},m(r,o){rt(t,r,o),P(r,e,o),rt(l,r,o),s=!0},p(r,o){const i={};o&65544&&(i.$$scope={dirty:o,ctx:r}),t.$set(i);const a={};o&65544&&(a.$$scope={dirty:o,ctx:r}),l.$set(a)},i(r){s||(A(t.$$.fragment,r),A(l.$$.fragment,r),s=!0)},o(r){j(t.$$.fragment,r),j(l.$$.fragment,r),s=!1},d(r){r&&m(e),it(t,r),it(l,r)}}}function Uo(n){let t,e,l,s,r,o,i,a,u;return t=new Ve({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[Bo]},$$scope:{ctx:n}}}),t.$on("click",n[11]),l=new es({props:{$$slots:{default:[Po]},$$scope:{ctx:n}}}),a=new Fn({props:{chatId:n[1].id}}),{c(){st(t.$$.fragment),e=G(),st(l.$$.fragment),s=G(),r=I("hr"),o=G(),i=I("div"),st(a.$$.fragment),this.h()},l(c){ot(t.$$.fragment,c),e=J(c),ot(l.$$.fragment,c),s=J(c),r=M(c,"HR",{class:!0}),o=J(c),i=M(c,"DIV",{class:!0});var d=S(i);ot(a.$$.fragment,d),d.forEach(m),this.h()},h(){f(r,"class","border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5"),f(i,"class","flex p-1")},m(c,d){rt(t,c,d),P(c,e,d),rt(l,c,d),P(c,s,d),P(c,r,d),P(c,o,d),P(c,i,d),rt(a,i,null),u=!0},p(c,d){const y={};d&65544&&(y.$$scope={dirty:d,ctx:c}),t.$set(y);const b={};d&65544&&(b.$$scope={dirty:d,ctx:c}),l.$set(b);const p={};d&2&&(p.chatId=c[1].id),a.$set(p)},i(c){u||(A(t.$$.fragment,c),A(l.$$.fragment,c),A(a.$$.fragment,c),u=!0)},o(c){j(t.$$.fragment,c),j(l.$$.fragment,c),j(a.$$.fragment,c),u=!1},d(c){c&&(m(e),m(s),m(r),m(o),m(i)),it(t,c),it(l,c),it(a)}}}function Ro(n){let t,e,l;return e=new rn({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:We,$$slots:{default:[Uo]},$$scope:{ctx:n}}}),{c(){t=I("div"),st(e.$$.fragment),this.h()},l(s){t=M(s,"DIV",{slot:!0});var r=S(t);ot(e.$$.fragment,r),r.forEach(m),this.h()},h(){f(t,"slot","content")},m(s,r){P(s,t,r),rt(e,t,null),l=!0},p(s,r){const o={};r&65547&&(o.$$scope={dirty:r,ctx:s}),e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),l=!1},d(s){s&&m(t),it(e)}}}function jo(n){let t,e;return t=new on({props:{$$slots:{content:[Ro],default:[Vo]},$$scope:{ctx:n}}}),t.$on("change",n[15]),{c(){st(t.$$.fragment)},l(l){ot(t.$$.fragment,l)},m(l,s){rt(t,l,s),e=!0},p(l,[s]){const r={};s&65547&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){j(t.$$.fragment,l),e=!1},d(l){it(t,l)}}}function zo(n,t,e){let l,{$$slots:s={},$$scope:r}=t;const{saveAs:o}=Qn,i=ue("i18n");ct(n,i,V=>e(3,l=V));let{shareEnabled:a=!1}=t,{shareHandler:u}=t,{downloadHandler:c}=t,{chat:d}=t,{onClose:y=()=>{}}=t;const b=async()=>{const V=d.chat;console.log("download",d);const T=V.messages.reduce((C,Q,R,L)=>`${C}### ${Q.role.toUpperCase()}
${Q.content}

`,"");let B=new Blob([T],{type:"text/plain"});o(B,`chat-${V.title}.txt`)},p=async()=>{const V=d.chat;console.log("download",d);const T=await Yn(V),B=window.URL.createObjectURL(T),C=document.createElement("a");C.href=B,C.download=`chat-${V.title}.pdf`,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(B)},_=async()=>{let V=new Blob([JSON.stringify([d])],{type:"application/json"});o(V,`chat-export-${Date.now()}.json`)},h=()=>{u()},v=()=>{_()},E=()=>{b()},N=()=>{p()},D=V=>{V.detail===!1&&y()};return n.$$set=V=>{"shareEnabled"in V&&e(8,a=V.shareEnabled),"shareHandler"in V&&e(0,u=V.shareHandler),"downloadHandler"in V&&e(9,c=V.downloadHandler),"chat"in V&&e(1,d=V.chat),"onClose"in V&&e(2,y=V.onClose),"$$scope"in V&&e(16,r=V.$$scope)},[u,d,y,l,i,b,p,_,a,c,s,h,v,E,N,D,r]}class Fo extends Gt{constructor(t){super(),Jt(this,t,zo,jo,Zt,{shareEnabled:8,shareHandler:0,downloadHandler:9,chat:1,onClose:2})}}function Ul(n){let t,e,l;function s(o){n[15](o)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),t=new To({props:r}),bt.push(()=>Ot(t,"selectedModels",s)),{c(){st(t.$$.fragment)},l(o){ot(t.$$.fragment,o)},m(o,i){rt(t,o,i),l=!0},p(o,i){const a={};i&4&&(a.showSetDefault=!o[2]),!e&&i&1&&(e=!0,a.selectedModels=o[0],Nt(()=>e=!1)),t.$set(a)},i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){j(t.$$.fragment,o),l=!1},d(o){it(t,o)}}}function Rl(n){let t,e;return t=new Fo({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[16],downloadHandler:n[17],$$slots:{default:[qo]},$$scope:{ctx:n}}}),{c(){st(t.$$.fragment)},l(l){ot(t.$$.fragment,l)},m(l,s){rt(t,l,s),e=!0},p(l,s){const r={};s&8&&(r.chat=l[3]),s&4&&(r.shareEnabled=l[2]),s&32&&(r.shareHandler=l[16]),s&64&&(r.downloadHandler=l[17]),s&2097152&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){j(t.$$.fragment,l),e=!1},d(l){it(t,l)}}}function qo(n){let t,e='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){t=I("button"),t.innerHTML=e,this.h()},l(l){t=M(l,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-9m6068"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"id","chat-context-menu-button")},m(l,s){P(l,t,s)},p:It,d(l){l&&m(t)}}}function Wo(n){let t,e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"></path><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"></path></svg>',s,r,o;return{c(){t=I("button"),e=I("div"),e.innerHTML=l,this.h()},l(i){t=M(i,"BUTTON",{id:!0,class:!0});var a=S(t);e=M(a,"DIV",{class:!0,"data-svelte-h":!0}),Kt(e)!=="svelte-1fcii9y"&&(e.innerHTML=l),a.forEach(m),this.h()},h(){f(e,"class","m-auto self-center"),f(t,"id","new-chat-button"),f(t,"class",s="flex "+(n[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")},m(i,a){P(i,t,a),w(t,e),r||(o=K(t,"click",n[18]),r=!0)},p(i,a){a&256&&s!==(s="flex "+(i[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition")&&f(t,"class",s)},d(i){i&&m(t),r=!1,o()}}}function jl(n){let t,e;return t=new Wn({props:{className:"max-w-[200px]",role:n[10].role,$$slots:{default:[Zo]},$$scope:{ctx:n}}}),t.$on("show",n[19]),{c(){st(t.$$.fragment)},l(l){ot(t.$$.fragment,l)},m(l,s){rt(t,l,s),e=!0},p(l,s){const r={};s&1024&&(r.role=l[10].role),s&2098176&&(r.$$scope={dirty:s,ctx:l}),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){j(t.$$.fragment,l),e=!1},d(l){it(t,l)}}}function Zo(n){let t,e,l,s;return{c(){t=I("button"),e=I("div"),l=I("img"),this.h()},l(r){t=M(r,"BUTTON",{class:!0,"aria-label":!0});var o=S(t);e=M(o,"DIV",{class:!0});var i=S(e);l=M(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(m),o.forEach(m),this.h()},h(){we(l.src,s=n[10].profile_image_url)||f(l,"src",s),f(l,"class","size-6 object-cover rounded-full"),f(l,"alt","User profile"),f(l,"draggable","false"),f(e,"class","self-center"),f(t,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(t,"aria-label","User Menu")},m(r,o){P(r,t,o),w(t,e),w(e,l)},p(r,o){o&1024&&!we(l.src,s=r[10].profile_image_url)&&f(l,"src",s)},d(r){r&&m(t)}}}function Go(n){let t,e,l,s,r,o,i,a,u,c,d,y,b,p,_,h,v,E,N,D,V;function T(L){n[13](L)}let B={chatId:n[7]};n[5]!==void 0&&(B.show=n[5]),t=new qn({props:B}),bt.push(()=>Ot(t,"show",T)),c=new Xn({});let C=n[4]&&Ul(n),Q=n[2]&&Rl(n);v=new me({props:{content:n[9].t("New Chat"),$$slots:{default:[Wo]},$$scope:{ctx:n}}});let R=n[10]!==void 0&&jl(n);return{c(){st(t.$$.fragment),l=G(),s=I("nav"),r=I("div"),o=I("div"),i=I("div"),a=I("button"),u=I("div"),st(c.$$.fragment),y=G(),b=I("div"),C&&C.c(),p=G(),_=I("div"),Q&&Q.c(),h=G(),st(v.$$.fragment),E=G(),R&&R.c(),this.h()},l(L){ot(t.$$.fragment,L),l=J(L),s=M(L,"NAV",{id:!0,class:!0});var O=S(s);r=M(O,"DIV",{class:!0});var ut=S(r);o=M(ut,"DIV",{class:!0});var $=S(o);i=M($,"DIV",{class:!0});var lt=S(i);a=M(lt,"BUTTON",{id:!0,class:!0});var Mt=S(a);u=M(Mt,"DIV",{class:!0});var Qt=S(u);ot(c.$$.fragment,Qt),Qt.forEach(m),Mt.forEach(m),lt.forEach(m),y=J($),b=M($,"DIV",{class:!0});var Lt=S(b);C&&C.l(Lt),Lt.forEach(m),p=J($),_=M($,"DIV",{class:!0});var Et=S(_);Q&&Q.l(Et),h=J(Et),ot(v.$$.fragment,Et),E=J(Et),R&&R.l(Et),Et.forEach(m),$.forEach(m),ut.forEach(m),O.forEach(m),this.h()},h(){f(u,"class","m-auto self-center"),f(a,"id","sidebar-toggle-button"),f(a,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-850 transition"),f(i,"class",d=(n[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(b,"class","flex-1 overflow-hidden max-w-full"),f(_,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),f(o,"class","flex items-center w-full max-w-full"),f(r,"class","flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]"),f(s,"id","nav"),f(s,"class","sticky py-2.5 top-0 flex flex-row justify-center z-30")},m(L,O){rt(t,L,O),P(L,l,O),P(L,s,O),w(s,r),w(r,o),w(o,i),w(i,a),w(a,u),rt(c,u,null),w(o,y),w(o,b),C&&C.m(b,null),w(o,p),w(o,_),Q&&Q.m(_,null),w(_,h),rt(v,_,null),w(_,E),R&&R.m(_,null),N=!0,D||(V=K(a,"click",n[14]),D=!0)},p(L,[O]){const ut={};O&128&&(ut.chatId=L[7]),!e&&O&32&&(e=!0,ut.show=L[5],Nt(()=>e=!1)),t.$set(ut),(!N||O&256&&d!==(d=(L[8]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&f(i,"class",d),L[4]?C?(C.p(L,O),O&16&&A(C,1)):(C=Ul(L),C.c(),A(C,1),C.m(b,null)):C&&(Ft(),j(C,1,1,()=>{C=null}),qt()),L[2]?Q?(Q.p(L,O),O&4&&A(Q,1)):(Q=Rl(L),Q.c(),A(Q,1),Q.m(_,h)):Q&&(Ft(),j(Q,1,1,()=>{Q=null}),qt());const $={};O&512&&($.content=L[9].t("New Chat")),O&2097410&&($.$$scope={dirty:O,ctx:L}),v.$set($),L[10]!==void 0?R?(R.p(L,O),O&1024&&A(R,1)):(R=jl(L),R.c(),A(R,1),R.m(_,null)):R&&(Ft(),j(R,1,1,()=>{R=null}),qt())},i(L){N||(A(t.$$.fragment,L),A(c.$$.fragment,L),A(C),A(Q),A(v.$$.fragment,L),A(R),N=!0)},o(L){j(t.$$.fragment,L),j(c.$$.fragment,L),j(C),j(Q),j(v.$$.fragment,L),j(R),N=!1},d(L){L&&(m(l),m(s)),it(t,L),it(c),C&&C.d(),Q&&Q.d(),it(v),R&&R.d(),D=!1,V()}}}function Jo(n,t,e){let l,s,r,o,i;ct(n,en,C=>e(20,l=C)),ct(n,ve,C=>e(7,s=C)),ct(n,Oe,C=>e(8,r=C)),ct(n,ln,C=>e(10,i=C));const a=ue("i18n");ct(n,a,C=>e(9,o=C));let{initNewChat:u}=t,{title:c=l}=t,{shareEnabled:d=!1}=t,{chat:y}=t,{selectedModels:b}=t,{showModelSelector:p=!0}=t,_=!1,h=!1;function v(C){_=C,e(5,_)}const E=()=>{Oe.set(!r)};function N(C){b=C,e(0,b)}const D=()=>{e(5,_=!_)},V=()=>{e(6,h=!h)},T=()=>{u()},B=C=>{C.detail==="archived-chat"&&vn.set(!0)};return n.$$set=C=>{"initNewChat"in C&&e(1,u=C.initNewChat),"title"in C&&e(12,c=C.title),"shareEnabled"in C&&e(2,d=C.shareEnabled),"chat"in C&&e(3,y=C.chat),"selectedModels"in C&&e(0,b=C.selectedModels),"showModelSelector"in C&&e(4,p=C.showModelSelector)},[b,u,d,y,p,_,h,s,r,o,i,a,c,v,E,N,D,V,T,B]}class Qo extends Gt{constructor(t){super(),Jt(this,t,Jo,Go,Zt,{initNewChat:1,title:12,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Yo(n){let t,e,l,s,r,o,i;return a(),{feed:u,reset:a};function a(){t=!0,e="",l=0,s=-1,r=void 0,o=void 0,i=""}function u(d){e=e?e+d:d,t&&Xo(e)&&(e=e.slice(an.length)),t=!1;const y=e.length;let b=0,p=!1;for(;b<y;){p&&(e[b]===`
`&&++b,p=!1);let _=-1,h=s,v;for(let E=l;_<0&&E<y;++E)v=e[E],v===":"&&h<0?h=E-b:v==="\r"?(p=!0,_=E-b):v===`
`&&(_=E-b);if(_<0){l=y-b,s=h;break}else l=0,s=-1;c(e,b,h,_),b+=_+1}b===y?e="":b>0&&(e=e.slice(b))}function c(d,y,b,p){if(p===0){i.length>0&&(n({type:"event",id:r,event:o||void 0,data:i.slice(0,-1)}),i="",r=void 0),o=void 0;return}const _=b<0,h=d.slice(y,y+(_?p:b));let v=0;_?v=p:d[y+b+1]===" "?v=b+2:v=b+1;const E=y+v,N=p-v,D=d.slice(E,E+N).toString();if(h==="data")i+=D?"".concat(D,`
`):`
`;else if(h==="event")o=D;else if(h==="id"&&!D.includes("\0"))r=D;else if(h==="retry"){const V=parseInt(D,10);Number.isNaN(V)||n({type:"reconnect-interval",value:V})}}}const an=[239,187,191];function Xo(n){return an.every((t,e)=>n.charCodeAt(e)===t)}class Ko extends TransformStream{constructor(){let t;super({start(e){t=Yo(l=>{l.type==="event"&&e.enqueue(l)})},transform(e){t.feed(e)}})}}async function xo(n,t){const e=n.pipeThrough(new TextDecoderStream).pipeThrough(new Ko).getReader();let l=$o(e);return t&&(l=tr(l)),l}async function*$o(n){var t,e,l;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const o=s.data;if(o.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(o);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.citations){yield{done:!1,value:"",citations:i.citations};continue}yield{done:!1,value:((l=(e=(t=i.choices)==null?void 0:t[0])==null?void 0:e.delta)==null?void 0:l.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*tr(n){for await(const t of n){if(t.done){yield t;return}if(t.citations){yield t;continue}let e=t.value;if(e.length<5){yield{done:!1,value:e};continue}for(;e!="";){const l=Math.min(Math.floor(Math.random()*3)+1,e.length);yield{done:!1,value:e.slice(0,l)},(document==null?void 0:document.visibilityState)!=="hidden"&&await er(5),e=e.slice(l)}}}const er=n=>new Promise(t=>setTimeout(t,n));function zl(n){let t,e=n[2]&&Fl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),P(l,t,s)},p(l,s){l[2]?e?(e.p(l,s),s&4&&A(e,1)):(e=Fl(l),e.c(),A(e,1),e.m(t.parentNode,t)):e&&(Ft(),j(e,1,1,()=>{e=null}),qt())},d(l){l&&m(t),e&&e.d(l)}}}function Fl(n){let t,e,l,s,r=n[1].type+"",o,i,a,u,c,d=n[1].content+"",y,b,p,_,h,v,E=n[1].url&&ql(),N=n[1].url&&Wl(),D=n[1].dismissible&&Zl(n);return{c(){t=I("div"),e=I("div"),l=I("div"),s=I("div"),o=mt(r),a=G(),E&&E.c(),u=G(),c=I("div"),y=mt(d),b=G(),N&&N.c(),p=G(),_=I("div"),D&&D.c(),this.h()},l(V){t=M(V,"DIV",{class:!0});var T=S(t);e=M(T,"DIV",{class:!0});var B=S(e);l=M(B,"DIV",{class:!0});var C=S(l);s=M(C,"DIV",{class:!0});var Q=S(s);o=ht(Q,r),Q.forEach(m),a=J(C),E&&E.l(C),C.forEach(m),u=J(B),c=M(B,"DIV",{class:!0});var R=S(c);y=ht(R,d),R.forEach(m),B.forEach(m),b=J(T),N&&N.l(T),p=J(T),_=M(T,"DIV",{class:!0});var L=S(_);D&&D.l(L),L.forEach(m),T.forEach(m),this.h()},h(){f(s,"class",i="text-xs font-black "+(n[3][n[1].type]??n[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),f(l,"class","flex justify-between self-start"),f(c,"class","flex-1 text-xs text-gray-700 dark:text-white"),f(e,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),f(_,"class","flex self-start"),f(t,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-40")},m(V,T){P(V,t,T),w(t,e),w(e,l),w(l,s),w(s,o),w(l,a),E&&E.m(l,null),w(e,u),w(e,c),w(c,y),w(t,b),N&&N.m(t,null),w(t,p),w(t,_),D&&D.m(_,null),v=!0},p(V,T){(!v||T&2)&&r!==(r=V[1].type+"")&&wt(o,r),(!v||T&2&&i!==(i="text-xs font-black "+(V[3][V[1].type]??V[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&f(s,"class",i),V[1].url?E||(E=ql(),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!v||T&2)&&d!==(d=V[1].content+"")&&wt(y,d),V[1].url?N||(N=Wl(),N.c(),N.m(t,p)):N&&(N.d(1),N=null),V[1].dismissible?D?D.p(V,T):(D=Zl(V),D.c(),D.m(_,null)):D&&(D.d(1),D=null)},i(V){v||(V&&Ae(()=>{v&&(h||(h=Ne(t,Ye,{delay:100,duration:300},!0)),h.run(1))}),v=!0)},o(V){V&&(h||(h=Ne(t,Ye,{delay:100,duration:300},!1)),h.run(0)),v=!1},d(V){V&&m(t),E&&E.d(),N&&N.d(),D&&D.d(),V&&h&&h.end()}}}function ql(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=I("div"),t.innerHTML=e,this.h()},l(l){t=M(l,"DIV",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-1ofrdjc"&&(t.innerHTML=e),this.h()},h(){f(t,"class","flex md:hidden group w-fit md:items-center")},m(l,s){P(l,t,s)},d(l){l&&m(t)}}}function Wl(n){let t,e='<a class="text-gray-700 dark:text-white text-xs font-bold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){t=I("div"),t.innerHTML=e,this.h()},l(l){t=M(l,"DIV",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-15ujvd1"&&(t.innerHTML=e),this.h()},h(){f(t,"class","hidden md:flex group w-fit md:items-center")},m(l,s){P(l,t,s)},d(l){l&&m(t)}}}function Zl(n){let t,e="",l,s;return{c(){t=I("button"),t.textContent=e,this.h()},l(r){t=M(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Kt(t)!=="svelte-17pf3tf"&&(t.textContent=e),this.h()},h(){f(t,"class","-mt-[3px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white h-1")},m(r,o){P(r,t,o),l||(s=K(t,"click",n[5]),l=!0)},p:It,d(r){r&&m(t),l=!1,s()}}}function lr(n){let t,e=!n[0]&&zl(n);return{c(){e&&e.c(),t=Ht()},l(l){e&&e.l(l),t=Ht()},m(l,s){e&&e.m(l,s),P(l,t,s)},p(l,[s]){l[0]?e&&(e.d(1),e=null):e?e.p(l,s):(e=zl(l),e.c(),e.m(t.parentNode,t))},i:It,o:It,d(l){l&&m(t),e&&e.d(l)}}}function nr(n,t,e){const l=Fe();let{banner:s={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=t,{dismissed:r=!1}=t,o=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=c=>{e(0,r=!0),l("dismiss",c)};qe(()=>{e(2,o=!0)});const u=()=>{a(s.id)};return n.$$set=c=>{"banner"in c&&e(1,s=c.banner),"dismissed"in c&&e(0,r=c.dismissed)},[r,s,o,i,a,u]}class sr extends Gt{constructor(t){super(),Jt(this,t,nr,lr,Zt,{banner:1,dismissed:0})}}const{document:ze}=mn;function Gl(n,t,e){const l=n.slice();return l[62]=t[e],l}function Jl(n){let t,e,l,s,r,o,i,a,u,c,d,y,b,p,_,h,v,E,N,D,V,T,B,C,Q,R;function L(W){n[25](W)}function O(W){n[26](W)}let ut={title:n[10],shareEnabled:n[13].length>0,chat:n[9],initNewChat:n[19]};n[6]!==void 0&&(ut.selectedModels=n[6]),n[5]!==void 0&&(ut.showModelSelector=n[5]),e=new Qo({props:ut}),bt.push(()=>Ot(e,"selectedModels",L)),bt.push(()=>Ot(e,"showModelSelector",O));let $=n[17].length>0&&n[13].length===0&&!n[14]&&n[6].length<=1&&Ql(n);function lt(W){n[29](W)}function Mt(W){n[30](W)}function Qt(W){n[31](W)}function Lt(W){n[32](W)}let Et={chatId:n[14],selectedModels:n[6],processing:rr,bottomPadding:n[12].length>0,sendPrompt:n[21],continueGeneration:n[24],regenerateResponse:n[23]};n[1]!==void 0&&(Et.history=n[1]),n[13]!==void 0&&(Et.messages=n[13]),n[3]!==void 0&&(Et.autoScroll=n[3]),n[11]!==void 0&&(Et.prompt=n[11]),c=new hn({props:Et}),bt.push(()=>Ot(c,"history",lt)),bt.push(()=>Ot(c,"messages",Mt)),bt.push(()=>Ot(c,"autoScroll",Qt)),bt.push(()=>Ot(c,"prompt",Lt));function Pt(W){n[35](W)}function Tt(W){n[36](W)}function Wt(W){n[37](W)}function Xt(W){n[38](W)}function Yt(W){n[39](W)}let F={selectedModels:n[6],messages:n[13],submitPrompt:n[20],stopResponse:n[22]};return n[12]!==void 0&&(F.files=n[12]),n[11]!==void 0&&(F.prompt=n[11]),n[3]!==void 0&&(F.autoScroll=n[3]),n[8]!==void 0&&(F.webSearchEnabled=n[8]),n[7]!==void 0&&(F.atSelectedModel=n[7]),v=new yo({props:F}),bt.push(()=>Ot(v,"files",Pt)),bt.push(()=>Ot(v,"prompt",Tt)),bt.push(()=>Ot(v,"autoScroll",Wt)),bt.push(()=>Ot(v,"webSearchEnabled",Xt)),bt.push(()=>Ot(v,"atSelectedModel",Yt)),{c(){t=I("div"),st(e.$$.fragment),r=G(),$&&$.c(),o=G(),i=I("div"),a=I("div"),u=I("div"),st(c.$$.fragment),h=G(),st(v.$$.fragment),this.h()},l(W){t=M(W,"DIV",{class:!0});var et=S(t);ot(e.$$.fragment,et),r=J(et),$&&$.l(et),o=J(et),i=M(et,"DIV",{class:!0});var Rt=S(i);a=M(Rt,"DIV",{class:!0,id:!0});var jt=S(a);u=M(jt,"DIV",{class:!0});var ft=S(u);ot(c.$$.fragment,ft),ft.forEach(m),jt.forEach(m),h=J(Rt),ot(v.$$.fragment,Rt),Rt.forEach(m),et.forEach(m),this.h()},h(){f(u,"class",_="h-full w-full flex flex-col "+(n[0]?"py-4":"pt-2 pb-4")),f(a,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full"),f(a,"id","messages-container"),f(i,"class","flex flex-col flex-auto"),f(t,"class",B="min-h-screen max-h-screen "+(n[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col")},m(W,et){P(W,t,et),rt(e,t,null),w(t,r),$&&$.m(t,null),w(t,o),w(t,i),w(i,a),w(a,u),rt(c,u,null),n[33](a),w(i,h),rt(v,i,null),C=!0,Q||(R=K(a,"scroll",n[34]),Q=!0)},p(W,et){const Rt={};et[0]&1024&&(Rt.title=W[10]),et[0]&8192&&(Rt.shareEnabled=W[13].length>0),et[0]&512&&(Rt.chat=W[9]),!l&&et[0]&64&&(l=!0,Rt.selectedModels=W[6],Nt(()=>l=!1)),!s&&et[0]&32&&(s=!0,Rt.showModelSelector=W[5],Nt(()=>s=!1)),e.$set(Rt),W[17].length>0&&W[13].length===0&&!W[14]&&W[6].length<=1?$?($.p(W,et),et[0]&155712&&A($,1)):($=Ql(W),$.c(),A($,1),$.m(t,o)):$&&(Ft(),j($,1,1,()=>{$=null}),qt());const jt={};et[0]&16384&&(jt.chatId=W[14]),et[0]&64&&(jt.selectedModels=W[6]),et[0]&4096&&(jt.bottomPadding=W[12].length>0),!d&&et[0]&2&&(d=!0,jt.history=W[1],Nt(()=>d=!1)),!y&&et[0]&8192&&(y=!0,jt.messages=W[13],Nt(()=>y=!1)),!b&&et[0]&8&&(b=!0,jt.autoScroll=W[3],Nt(()=>b=!1)),!p&&et[0]&2048&&(p=!0,jt.prompt=W[11],Nt(()=>p=!1)),c.$set(jt),(!C||et[0]&1&&_!==(_="h-full w-full flex flex-col "+(W[0]?"py-4":"pt-2 pb-4")))&&f(u,"class",_);const ft={};et[0]&64&&(ft.selectedModels=W[6]),et[0]&8192&&(ft.messages=W[13]),!E&&et[0]&4096&&(E=!0,ft.files=W[12],Nt(()=>E=!1)),!N&&et[0]&2048&&(N=!0,ft.prompt=W[11],Nt(()=>N=!1)),!D&&et[0]&8&&(D=!0,ft.autoScroll=W[3],Nt(()=>D=!1)),!V&&et[0]&256&&(V=!0,ft.webSearchEnabled=W[8],Nt(()=>V=!1)),!T&&et[0]&128&&(T=!0,ft.atSelectedModel=W[7],Nt(()=>T=!1)),v.$set(ft),(!C||et[0]&65536&&B!==(B="min-h-screen max-h-screen "+(W[16]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&f(t,"class",B)},i(W){C||(A(e.$$.fragment,W),A($),A(c.$$.fragment,W),A(v.$$.fragment,W),C=!0)},o(W){j(e.$$.fragment,W),j($),j(c.$$.fragment,W),j(v.$$.fragment,W),C=!1},d(W){W&&m(t),it(e),$&&$.d(),it(c),n[33](null),it(v),Q=!1,R()}}}function Ql(n){let t,e,l,s,r=ee(n[17].filter(n[27])),o=[];for(let a=0;a<r.length;a+=1)o[a]=Yl(Gl(n,r,a));const i=a=>j(o[a],1,1,()=>{o[a]=null});return{c(){t=I("div"),e=I("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){t=M(a,"DIV",{class:!0});var u=S(t);e=M(u,"DIV",{class:!0});var c=S(e);for(let d=0;d<o.length;d+=1)o[d].l(c);c.forEach(m),u.forEach(m),this.h()},h(){f(e,"class","flex flex-col gap-1 w-full"),f(t,"class",l="absolute top-[4.25rem] w-full "+(n[16]?"md:max-w-[calc(100%-260px)]":""))},m(a,u){P(a,t,u),w(t,e);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null);s=!0},p(a,u){if(u[0]&131072){r=ee(a[17].filter(a[27]));let c;for(c=0;c<r.length;c+=1){const d=Gl(a,r,c);o[c]?(o[c].p(d,u),A(o[c],1)):(o[c]=Yl(d),o[c].c(),A(o[c],1),o[c].m(e,null))}for(Ft(),c=r.length;c<o.length;c+=1)i(c);qt()}(!s||u[0]&65536&&l!==(l="absolute top-[4.25rem] w-full "+(a[16]?"md:max-w-[calc(100%-260px)]":"")))&&f(t,"class",l)},i(a){if(!s){for(let u=0;u<r.length;u+=1)A(o[u]);s=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)j(o[u]);s=!1},d(a){a&&m(t),ye(o,a)}}}function Yl(n){let t,e;return t=new sr({props:{banner:n[62]}}),t.$on("dismiss",n[28]),{c(){st(t.$$.fragment)},l(l){ot(t.$$.fragment,l)},m(l,s){rt(t,l,s),e=!0},p(l,s){const r={};s[0]&131072&&(r.banner=l[62]),t.$set(r)},i(l){e||(A(t.$$.fragment,l),e=!0)},o(l){j(t.$$.fragment,l),e=!1},d(l){it(t,l)}}}function or(n){let t,e,l,s;ze.title=t=`
		`+(n[10]?`${n[10].length>30?`${n[10].slice(0,30)}...`:n[10]} | ${n[15]}`:`${n[15]}`)+`
	`;let r=(!n[0]||n[2]&&n[0])&&Jl(n);return{c(){e=G(),r&&r.c(),l=Ht()},l(o){dn("svelte-1123lr8",ze.head).forEach(m),e=J(o),r&&r.l(o),l=Ht()},m(o,i){P(o,e,i),r&&r.m(o,i),P(o,l,i),s=!0},p(o,i){(!s||i[0]&33792)&&t!==(t=`
		`+(o[10]?`${o[10].length>30?`${o[10].slice(0,30)}...`:o[10]} | ${o[15]}`:`${o[15]}`)+`
	`)&&(ze.title=t),!o[0]||o[2]&&o[0]?r?(r.p(o,i),i[0]&5&&A(r,1)):(r=Jl(o),r.c(),A(r,1),r.m(l.parentNode,l)):r&&(Ft(),j(r,1,1,()=>{r=null}),qt())},i(o){s||(A(r),s=!0)},o(o){j(r),s=!1},d(o){o&&(m(e),m(l)),r&&r.d(o)}}}let rr="";function ir(n,t,e){let l,s,r,o,i,a,u,c,d,y;ct(n,ve,g=>e(14,l=g)),ct(n,ce,g=>e(42,s=g)),ct(n,Le,g=>e(43,r=g)),ct(n,ln,g=>e(45,i=g)),ct(n,pn,g=>e(46,a=g)),ct(n,$l,g=>e(47,u=g)),ct(n,en,g=>e(15,c=g)),ct(n,Oe,g=>e(16,d=g)),ct(n,wn,g=>e(17,y=g));const b=ue("i18n");ct(n,b,g=>e(44,o=g));let{chatIdProp:p=""}=t,_=!1,h=!1,v=!0,E,N=!0,D=[""],V,T=!1,B=null,C="",Q="",R=[],L=[],O={messages:{},currentId:null};qe(async()=>{l?(s.saveChatHistory??!0)||await Pe("/"):await ut()});const ut=async()=>{var Y;window.history.replaceState(O.state,"","/"),await ve.set(""),e(3,v=!0),e(10,C=""),e(13,L=[]),e(1,O={messages:{},currentId:null}),a.url.searchParams.get("models")?e(6,D=(Y=a.url.searchParams.get("models"))==null?void 0:Y.split(",")):s!=null&&s.models?e(6,D=s==null?void 0:s.models):u!=null&&u.default_models?(console.log((u==null?void 0:u.default_models.split(","))??""),e(6,D=u==null?void 0:u.default_models.split(","))):e(6,D=[""]),a.url.searchParams.get("q")&&(e(11,Q=a.url.searchParams.get("q")??""),Q&&(await yt(),Lt(Q))),e(6,D=D.map(q=>r.map(z=>z.id).includes(q)?q:""));const g=await sl(localStorage.token);g?ce.set(g.ui):ce.set(JSON.parse(localStorage.getItem("settings")??"{}"));const H=document.getElementById("chat-textarea");setTimeout(()=>H==null?void 0:H.focus(),0)},$=async()=>{if(ve.set(p),e(9,B=await Tn(localStorage.token,l).catch(async g=>(await Pe("/"),null))),B){await ft();const g=B.chat;if(g){console.log(g),e(6,D=((g==null?void 0:g.models)??void 0)!==void 0?g.models:[g.models??""]),e(1,O=((g==null?void 0:g.history)??void 0)!==void 0?g.history:yn(g.messages)),e(10,C=g.title);const H=await sl(localStorage.token);return H?await ce.set(H.ui):await ce.set(JSON.parse(localStorage.getItem("settings")??"{}")),await ce.set({...s,system:g.system??s.system,params:g.options??s.params}),e(3,v=!0),await yt(),L.length>0&&e(1,O.messages[L.at(-1).id].done=!0,O),await yt(),!0}else return null}},lt=async()=>{await yt(),E&&e(4,E.scrollTop=E.scrollHeight,E)},Mt=g=>{const H=O.messages[g];return H.parentId?[...Mt(H.parentId),H]:[H]},Qt=async(g,H)=>{await gn.run({querySelector:".mermaid"});const Y=await Kn(localStorage.token,{model:g,messages:H.map(q=>({id:q.id,role:q.role,content:q.content,timestamp:q.timestamp})),chat_id:l}).catch(q=>(console.error(q),null));if(Y!==null)for(const q of Y.messages)e(1,O.messages[q.id]={...O.messages[q.id],...O.messages[q.id].content!==q.content?{originalContent:O.messages[q.id].content}:{},...q},O)},Lt=async(g,H=null)=>{if(console.log("submitPrompt",l),e(6,D=D.map(Y=>r.map(q=>q.id).includes(Y)?Y:"")),D.includes(""))_t.error(o.t("Model not selected"));else if(L.length!=0&&L.at(-1).done!=!0)console.log("wait");else if(R.length>0&&R.filter(Y=>Y.upload_status===!1).length>0)_t.error(o.t("Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready."));else{document.getElementById("chat-textarea").style.height="";let Y=el(),q={id:Y,parentId:L.length!==0?L.at(-1).id:null,childrenIds:[],role:"user",user:H??void 0,content:g,files:R.length>0?R:void 0,timestamp:Math.floor(Date.now()/1e3),models:D.filter((z,Z)=>D.indexOf(z)===Z)};e(1,O.messages[Y]=q,O),e(1,O.currentId=Y,O),L.length!==0&&O.messages[L.at(-1).id].childrenIds.push(Y),await yt(),L.length==1&&(s.saveChatHistory??!0?(e(9,B=await Cn(localStorage.token,{id:l,title:o.t("New Chat"),models:D,system:s.system??void 0,options:{...s.params??{}},messages:L,history:O,tags:[],timestamp:Date.now()})),await Ce.set(await Te(localStorage.token)),await ve.set(B.id)):await ve.set("local"),await yt()),e(11,Q=""),document.getElementById("chat-textarea").style.height="",e(12,R=[]),await Et(g,Y)}},Et=async(g,H,Y=null)=>{const q=JSON.parse(JSON.stringify(l));await Promise.all((Y?[Y]:V!==void 0?[V.id]:D).map(async z=>{var kt,St,vt;console.log("modelId",z);const Z=r.filter(zt=>zt.id===z).at(0);if(Z){L.some(x=>{var U;return(U=x.files)==null?void 0:U.some(tt=>tt.type==="image")})&&!(((vt=(St=(kt=Z.info)==null?void 0:kt.meta)==null?void 0:St.capabilities)==null?void 0:vt.vision)??!0)&&_t.error(o.t("Model {{modelName}} is not vision capable",{modelName:Z.name??Z.id}));let Vt=el(),k={parentId:H,id:Vt,childrenIds:[],role:"assistant",content:"",model:Z.id,modelName:Z.name??Z.id,userContext:null,timestamp:Math.floor(Date.now()/1e3)};e(1,O.messages[Vt]=k,O),e(1,O.currentId=Vt,O),H!==null&&e(1,O.messages[H].childrenIds=[...O.messages[H].childrenIds,Vt],O),await yt();let X=null;if(((s==null?void 0:s.memory)??!1)&&X===null){const x=await Zn(localStorage.token,g).catch(U=>(_t.error(U),null));x&&(x.documents[0].length>0&&(X=x.documents.reduce((U,tt,nt)=>{const Bt=x.metadatas[nt][0].created_at,at=new Date(Bt*1e3).toISOString().split("T")[0];return U.push(`${nt+1}. [${at}]. ${tt[0]}`),U},[])),console.log(X))}k.userContext=X,T&&await Pt(Z.id,H,Vt),(Z==null?void 0:Z.owned_by)==="openai"?await Wt(Z,g,Vt,q):Z&&await Tt(Z,g,Vt,q)}else _t.error(o.t("Model {{modelId}} not found",{modelId:z}))})),await Ce.set(await Te(localStorage.token))},Pt=async(g,H,Y)=>{const q=O.messages[Y];q.status={done:!1,action:"web_search",description:o.t("Generating search query")},e(13,L),e(1,O);const z=O.messages[H].content;let Z=z;if(z.length>100&&(Z=await Rt(g,z),!Z)){_t.warning(o.t("No search query generated")),q.status={...q.status,done:!0,error:!0,description:"No search query generated"},e(13,L),e(1,O);return}q.status={...q.status,description:o.t("Searching the web for '{{searchQuery}}'",{searchQuery:Z})},e(13,L),e(1,O);const kt=await An(localStorage.token,Z).catch(St=>(console.log(St),_t.error(St),null));kt?(q.status={...q.status,done:!0,description:o.t("Searched {{count}} sites",{count:kt.filenames.length}),urls:kt.filenames},((q==null?void 0:q.files)??!0)&&(q.files=[]),q.files.push({collection_name:kt.collection_name,name:Z,type:"web_search_results",urls:kt.filenames}),e(13,L),e(1,O)):(q.status={...q.status,done:!0,error:!0,description:"No search results found"},e(13,L),e(1,O))},Tt=async(g,H,Y,q)=>{var Vt,k,X,x;g=g.id;const z=O.messages[Y];await yt(),lt();const Z=[s.system||((z==null?void 0:z.userContext)??null)?{role:"system",content:`${ll((s==null?void 0:s.system)??"",i.name)}${(z==null?void 0:z.userContext)??null?`

User Context:
${((z==null?void 0:z.userContext)??[]).join(`
`)}`:""}`}:void 0,...L].filter(U=>{var tt;return(tt=U==null?void 0:U.content)==null?void 0:tt.trim()}).map((U,tt,nt)=>{var dt;const Bt={role:U.role,content:U.content},at=(dt=U.files)==null?void 0:dt.filter(At=>At.type==="image").map(At=>At.url.slice(At.url.indexOf(",")+1));return at&&at.length>0&&U.role==="user"&&(Bt.images=at),Bt});let kt=-1;Z.forEach((U,tt)=>{U.images&&(kt=tt)}),Z.forEach((U,tt)=>{tt!==kt&&delete U.images});const St=L.filter(U=>(U==null?void 0:U.files)??null).map(U=>U.files.filter(tt=>["doc","collection","web_search_results"].includes(tt.type))).flat(1),[vt,zt]=await En(localStorage.token,{model:g,messages:Z,options:{...s.params??{},stop:((Vt=s==null?void 0:s.params)==null?void 0:Vt.stop)??void 0?s.params.stop.map(U=>decodeURIComponent(JSON.parse('"'+U.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:((k=s==null?void 0:s.params)==null?void 0:k.max_tokens)??void 0,repeat_penalty:((X=s==null?void 0:s.params)==null?void 0:X.frequency_penalty)??void 0},format:s.requestFormat??void 0,keep_alive:s.keepAlive??void 0,docs:St.length>0?St:void 0,citations:St.length>0,chat_id:l});if(vt&&vt.ok){console.log("controller",zt);const U=vt.body.pipeThrough(new TextDecoderStream).pipeThrough(kn(`
`)).getReader();for(;;){const{value:tt,done:nt}=await U.read();if(nt||h||q!==l){if(z.done=!0,e(13,L),e(1,O),h)zt.abort("User: Stop Response");else{const Bt=Mt(Y);await Qt(g,Bt)}break}try{let Bt=tt.split(`
`);for(const at of Bt)if(at!==""){console.log(at);let dt=JSON.parse(at);if("citations"in dt){z.citations=dt.citations;continue}if("detail"in dt)throw dt;if(dt.done==!1){if(z.content==""&&dt.message.content==`
`)continue;z.content+=dt.message.content,e(13,L),e(1,O)}else{if(z.done=!0,z.content==""&&(z.error={code:400,content:"Oops! No text generated from Ollama, Please try again."}),z.context=dt.context??null,z.info={total_duration:dt.total_duration,load_duration:dt.load_duration,sample_count:dt.sample_count,sample_duration:dt.sample_duration,prompt_eval_count:dt.prompt_eval_count,prompt_eval_duration:dt.prompt_eval_duration,eval_count:dt.eval_count,eval_duration:dt.eval_duration},e(13,L),e(1,O),s.notificationEnabled&&!document.hasFocus()){const At=new Notification(selectedModelfile?`${selectedModelfile.title.charAt(0).toUpperCase()+selectedModelfile.title.slice(1)}`:`${g}`,{body:z.content,icon:(selectedModelfile==null?void 0:selectedModelfile.imageUrl)??`${He}/static/favicon.png`})}s.responseAutoCopy&&nl(z.content),s.responseAutoPlayback&&(await yt(),(x=document.getElementById(`speak-button-${z.id}`))==null||x.click())}}}catch(Bt){console.log(Bt),"detail"in Bt&&_t.error(Bt.detail);break}v&&lt()}l==q&&(s.saveChatHistory??!0)&&(e(9,B=await je(localStorage.token,q,{messages:L,history:O,models:D})),await Ce.set(await Te(localStorage.token)))}else{if(vt!==null){const U=await vt.json();console.log(U),"detail"in U?(_t.error(U.detail),z.error={content:U.detail}):(_t.error(U.error),z.error={content:U.error})}else _t.error(o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),z.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})};z.done=!0,e(13,L),e(1,O)}if(h=!1,await yt(),v&&lt(),L.length==2&&L.at(1).content!==""){window.history.replaceState(O.state,"",`/c/${q}`);const U=await et(H);await jt(q,U)}},Wt=async(g,H,Y,q)=>{var kt,St,vt,zt,Vt,k,X,x,U,tt;const z=O.messages[Y],Z=L.filter(nt=>(nt==null?void 0:nt.files)??null).map(nt=>nt.files.filter(Bt=>["doc","collection","web_search_results"].includes(Bt.type))).flat(1);console.log(Z),lt();try{const[nt,Bt]=await Sn(localStorage.token,{model:g.id,stream:!0,stream_options:((vt=(St=(kt=g.info)==null?void 0:kt.meta)==null?void 0:St.capabilities)==null?void 0:vt.usage)??!1?{include_usage:!0}:void 0,messages:[s.system||((z==null?void 0:z.userContext)??null)?{role:"system",content:`${ll((s==null?void 0:s.system)??"",i.name)}${(z==null?void 0:z.userContext)??null?`

User Context:
${((z==null?void 0:z.userContext)??[]).join(`
`)}`:""}`}:void 0,...L].filter(at=>{var dt;return(dt=at==null?void 0:at.content)==null?void 0:dt.trim()}).map((at,dt,At)=>{var de;return{role:at.role,...((de=at.files)==null?void 0:de.filter(ae=>ae.type==="image").length)>0&&at.role==="user"?{content:[{type:"text",text:At.length-1!==dt?at.content:(at==null?void 0:at.raContent)??at.content},...at.files.filter(ae=>ae.type==="image").map(ae=>({type:"image_url",image_url:{url:ae.url}}))]}:{content:At.length-1!==dt?at.content:(at==null?void 0:at.raContent)??at.content}}}),seed:((zt=s==null?void 0:s.params)==null?void 0:zt.seed)??void 0,stop:((Vt=s==null?void 0:s.params)==null?void 0:Vt.stop)??void 0?s.params.stop.map(at=>decodeURIComponent(JSON.parse('"'+at.replace(/\"/g,'\\"')+'"'))):void 0,temperature:((k=s==null?void 0:s.params)==null?void 0:k.temperature)??void 0,top_p:((X=s==null?void 0:s.params)==null?void 0:X.top_p)??void 0,frequency_penalty:((x=s==null?void 0:s.params)==null?void 0:x.frequency_penalty)??void 0,max_tokens:((U=s==null?void 0:s.params)==null?void 0:U.max_tokens)??void 0,docs:Z.length>0?Z:void 0,citations:Z.length>0,chat_id:l},`${Ue}`);if(await yt(),lt(),nt&&nt.ok&&nt.body){const at=await xo(nt.body,s.splitLargeChunks);let dt=null;for await(const At of at){const{value:de,done:ae,citations:Ze,error:Ge,usage:Je}=At;if(Ge){await Xt(Ge,null,g,z);break}if(ae||h||q!==l){if(z.done=!0,e(13,L),e(1,O),h)Bt.abort("User: Stop Response");else{const cn=Mt(Y);await Qt(g.id,cn)}break}if(Je&&(dt=Je),Ze){z.citations=Ze;continue}z.content==""&&de==`
`||(z.content+=de,e(13,L),e(1,O),v&&lt())}if(s.notificationEnabled&&!document.hasFocus()){const At=new Notification(`OpenAI ${g}`,{body:z.content,icon:`${He}/static/favicon.png`})}s.responseAutoCopy&&nl(z.content),s.responseAutoPlayback&&(await yt(),(tt=document.getElementById(`speak-button-${z.id}`))==null||tt.click()),dt&&(z.info={...dt,openai:!0}),l==q&&(s.saveChatHistory??!0)&&(e(9,B=await je(localStorage.token,q,{models:D,messages:L,history:O})),await Ce.set(await Te(localStorage.token)))}else await Xt(null,nt,g,z)}catch(nt){await Xt(nt,null,g,z)}if(e(13,L),e(1,O),h=!1,await yt(),v&&lt(),L.length==2){window.history.replaceState(O.state,"",`/c/${q}`);const nt=await et(H);await jt(q,nt)}},Xt=async(g,H,Y,q)=>{let z="",Z;g?Z=g:H!==null&&(Z=await H.json()),console.error(Z),"detail"in Z?(_t.error(Z.detail),z=Z.detail):"error"in Z?"message"in Z.error?(_t.error(Z.error.message),z=Z.error.message):(_t.error(Z.error),z=Z.error):"message"in Z&&(_t.error(Z.message),z=Z.message),q.error={content:o.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:Y.name??Y.id})+`
`+z},q.done=!0,e(13,L),e(1,O)},Yt=()=>{h=!0,console.log("stopResponse")},F=async g=>{if(console.log("regenerateResponse"),L.length!=0){let H=O.messages[g.parentId],Y=H.content;((H==null?void 0:H.models)??[...D]).length==1?await Et(Y,H.id):await Et(Y,H.id,g.model)}},W=async()=>{console.log("continueGeneration");const g=JSON.parse(JSON.stringify(l));if(L.length!=0&&L.at(-1).done==!0){const H=O.messages[O.currentId];H.done=!1,await yt();const Y=r.filter(q=>q.id===H.model).at(0);Y&&((Y==null?void 0:Y.owned_by)==="openai"?await Wt(Y,O.messages[H.parentId].content,H.id,g):await Tt(Y,O.messages[H.parentId].content,H.id,g))}else _t.error(o.t("Model {{modelId}} not found",{modelId}))},et=async g=>{var H,Y,q,z;if(((H=s==null?void 0:s.title)==null?void 0:H.auto)??!0){const Z=r.find(zt=>zt.id===D[0]),kt=(Z==null?void 0:Z.owned_by)==="openai"?((Y=s==null?void 0:s.title)==null?void 0:Y.modelExternal)??D[0]:((q=s==null?void 0:s.title)==null?void 0:q.model)??D[0],St=r.find(zt=>zt.id===kt);return console.log(St),await In(localStorage.token,((z=s==null?void 0:s.title)==null?void 0:z.prompt)??o.t("Create a concise, 3-5 word phrase as a header for the following query, strictly adhering to the 3-5 word limit and avoiding the use of the word 'title':")+" {{prompt}}",kt,g,l,(St==null?void 0:St.owned_by)==="openai"?`${Ue}`:`${xe}/v1`)}else return`${g}`},Rt=async(g,H)=>{var kt,St;const Y=r.find(vt=>vt.id===g),q=(Y==null?void 0:Y.owned_by)==="openai"?((kt=s==null?void 0:s.title)==null?void 0:kt.modelExternal)??g:((St=s==null?void 0:s.title)==null?void 0:St.model)??g,z=r.find(vt=>vt.id===q),Z=L.filter(vt=>vt.role==="user").map(vt=>vt.content);return await Mn(localStorage.token,q,Z,H,(z==null?void 0:z.owned_by)==="openai"?`${Ue}`:`${xe}/v1`)},jt=async(g,H)=>{g===l&&e(10,C=H),(s.saveChatHistory??!0)&&(e(9,B=await je(localStorage.token,g,{title:H})),await Ce.set(await Te(localStorage.token)))},ft=async()=>await Vn(localStorage.token,l).catch(async g=>[]);function Ut(g){D=g,e(6,D)}function he(g){N=g,e(5,N)}const xt=g=>g.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(g.id):!0,ge=g=>{const H=g.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([H,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(Y=>y.find(q=>q.id===Y))))};function Se(g){O=g,e(1,O)}function Ie(g){L=g,e(13,L),e(1,O)}function Me(g){v=g,e(3,v)}function fe(g){Q=g,e(11,Q)}function Dt(g){bt[g?"unshift":"push"](()=>{E=g,e(4,E)})}const Ct=g=>{e(3,v=E.scrollHeight-E.scrollTop<=E.clientHeight+5)};function De(g){R=g,e(12,R)}function pe(g){Q=g,e(11,Q)}function _e(g){v=g,e(3,v)}function $t(g){T=g,e(8,T)}function be(g){V=g,e(7,V)}return n.$$set=g=>{"chatIdProp"in g&&e(0,p=g.chatIdProp)},n.$$.update=()=>{if(n.$$.dirty[0]&2)if(O.currentId!==null){let g=[],H=O.messages[O.currentId];for(;H!==null;)g.unshift({...H}),H=H.parentId!==null?O.messages[H.parentId]:null;e(13,L=g)}else e(13,L=[]);n.$$.dirty[0]&1&&p&&(async()=>{if(await $()){await yt(),e(2,_=!0),window.setTimeout(()=>lt(),0);const g=document.getElementById("chat-textarea");g==null||g.focus()}else await Pe("/")})()},[p,O,_,v,E,N,D,V,T,B,C,Q,R,L,l,c,d,y,b,ut,Lt,Et,Yt,F,W,Ut,he,xt,ge,Se,Ie,Me,fe,Dt,Ct,De,pe,_e,$t,be]}class Rr extends Gt{constructor(t){super(),Jt(this,t,ir,or,Zt,{chatIdProp:0},null,[-1,-1,-1])}}export{Rr as C};
//# sourceMappingURL=Chat.cee01796.js.map
