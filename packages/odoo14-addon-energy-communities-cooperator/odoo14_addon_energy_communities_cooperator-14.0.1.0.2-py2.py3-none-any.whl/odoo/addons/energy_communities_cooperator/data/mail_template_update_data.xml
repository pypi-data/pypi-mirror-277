<?xml version="1.0" encoding="utf-8" ?>
<odoo>
  <data>
    <!-- proceed to override the email_template_confirmation -->
        <function name="write" model="ir.model.data">
            <function name="search" model="ir.model.data">
                <value
          eval="[('module', '=', 'cooperator'),('name', '=', 'email_template_confirmation')]"
        />
            </function>
            <value eval="{'noupdate': False}" />
        </function>

        <record id="cooperator.email_template_confirmation" model="mail.template">
            <field
        name="name"
      >Confirmation Email for CE Subscription Request Receipt</field>
            <field
        name="email_from"
      >${(object.company_id.coop_email_contact or object.company_id.email)|safe}</field>
      <field
        name="email_cc"
      >${((object.company_id.parent_id and object.company_id.parent_id.hierarchy_level == 'coordinator' and
      object.company_id.parent_id.notify_to_coord_child_ccee_submissions and (object.company_id.parent_id.coop_email_contact or
      object.company_id.parent_id.email)) or '')|safe}</field>
            <field
        name="subject"
      >[Som Comunitats] Application to become Community membership</field>
            <field name="email_to">${object.email}</field>
            <field
        name="reply_to"
      >${(object.company_id.coop_email_contact or object.company_id.email)|safe}</field>
            <field name="model_id" ref="model_subscription_request" />
            <field name="auto_delete" eval="False" />
            <field
        name="lang"
      >${(object.lang or object.company_id.default_lang_id.code or object.company_id.partner_id.lang)}</field>
            <field name="is_cooperator_template" eval="True" />
            <field
        name="body_html"
      ><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: #FFF; ">

    <p>Hello,</p>
    <p>Thank you for filling out the form and request to join the Community.</p>
    <p>In the coming weeks we will contact you to indicate the next steps</p>
    <p>Here is a copy of the data we received:</p>
    <div id="field_list_div" style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 10px; color: rgb(34, 34, 34); background-color: #FFF; ">
        <p> - Request to join: ${object.company_id.name}</p>
        <p> - Firstname: ${object.firstname}</p>
        <p> - Lastname: ${object.lastname}</p>
        <p> - VAT: ${object.vat}</p>
        <p> - Address: ${object.address}</p>
        <p> - Zip code: ${object.zip_code}</p>
        <p> - City: ${object.city}</p>
        <p> - Country: ${object.country_id.name}</p>
        <p> - Email: ${object.email}</p>
        <p> - Phone: ${(object.phone or '')}</p>
        <p> - Gender: ${dict(object.fields_get(allfields=['gender'])['gender']['selection'])[object.gender]}</p>
        <p> - Birthdate: ${object.birthdate}</p>
        <p> - Language: ${dict(object.fields_get(allfields=['lang'])['lang']['selection'])[object.lang]}</p>
        <p> - Initial share amount: ${object.subscription_amount}</p>
    % if object.payment_mode_id.payment_method_id.code == 'sepa_direct_debit':
        <p> - Bank account: ${object.iban}</p>
        <p> - I authorize bank receipts to be sent to this account: ${object.mandate_approved and 'SI' or 'NO'}</p>
    % endif
    </div>
    <br />
    <p>We keep in touch for any questions.</p>
    <p>Yours faithfully,</p>
    <p>Somcomunitats.coop team </p>
    <p><a href="https://somcomunitats.coop/recursos/">Resources and FAQs</a></p>
</div>
            ]]></field>
        </record>

        <function name="write" model="ir.model.data">
            <function name="search" model="ir.model.data">
                <value
          eval="[('module', '=', 'cooperator'),('name', '=', 'email_template_confirmation')]"
        />
            </function>
            <value eval="{'noupdate': True}" />
        </function>

        <record id="email_template_confirmation_company" model="mail.template">
            <field
        name="name"
      >Confirmation Email for CE Subscription Request Receipt</field>
            <field
        name="email_from"
      >${(object.company_id.coop_email_contact or object.company_id.email)|safe}</field>
            <field
        name="email_cc"
      >${((object.company_id.parent_id and object.company_id.parent_id.hierarchy_level == 'coordinator' and
      object.company_id.parent_id.notify_to_coord_child_ccee_submissions and (object.company_id.parent_id.coop_email_contact or
      object.company_id.parent_id.email)) or '')|safe}</field>
            <field
        name="subject"
      >[Som Comunitats] Application to become Community membership</field>
            <field name="email_to">${object.email}</field>
            <field
        name="reply_to"
      >${(object.company_id.coop_email_contact or object.company_id.email)|safe}</field>
            <field name="model_id" ref="model_subscription_request" />
            <field name="auto_delete" eval="False" />
            <field
        name="lang"
      >${(object.lang or object.company_id.default_lang_id.code or object.company_id.partner_id.lang)}</field>
            <field name="is_cooperator_template" eval="True" />
            <field
        name="body_html"
      ><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: #FFF; ">

    <p>Hello,</p>
    <p>Thank you for filling out the form and request to join the Community.</p>
    <p>In the coming weeks we will contact you to indicate the next steps</p>
    <p>Here is a copy of the data we received:</p>
    <div id="field_list_div" style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 10px; color: rgb(34, 34, 34); background-color: #FFF; ">
        <p> - Request to join: ${object.company_id.name}</p>
        <p> - Company Name: ${object.company_name}</p>
        <p> - Company Email: ${object.company_email}</p>
        <p> - VAT: ${object.vat}</p>
        <p> - Address: ${object.address}</p>
        <p> - Zip code: ${object.zip_code}</p>
        <p> - City: ${object.city}</p>
        <p> - Country: ${object.country_id.name}</p>
        <p> - Firstname: ${object.firstname}</p>
        <p> - Lastname: ${object.lastname}</p>
        <p> - Function: ${object.contact_person_function}</p>
        <p> - Email: ${object.email}</p>
        <p> - Phone: ${(object.phone or '')}</p>
        <p> - Gender: ${dict(object.fields_get(allfields=['gender'])['gender']['selection'])[object.gender]}</p>
        <p> - Birthdate: ${object.birthdate}</p>
        <p> - Language: ${dict(object.fields_get(allfields=['lang'])['lang']['selection'])[object.lang]}</p>
        <p> - Initial share amount: ${object.subscription_amount}</p>
    % if object.payment_mode_id.payment_method_id.code == 'sepa_direct_debit':
        <p> - Bank account: ${object.iban}</p>
        <p> - I authorize bank receipts to be sent to this account: ${object.mandate_approved and 'SI' or 'NO'}</p>
    % endif
    </div>
    <br />
    <p>We keep in touch for any questions.</p>
    <p>Yours faithfully,</p>
    <p>Somcomunitats.coop team </p>
    <p><a href="https://somcomunitats.coop/recursos/">Resources and FAQs</a></p>
</div>
            ]]></field>
        </record>

        <record id="email_template_confirmation_voluntary_share" model="mail.template">
            <field name="name">Confirmation Email for CE Voluntary Share Receipt</field>
            <field
        name="email_from"
      >${(object.company_id.coop_email_contact or object.company_id.email)|safe}</field>
            <field
        name="subject"
      >Contribute to ${object.company_id.name} Ref. ACSV${object.id}</field>
            <field name="email_to">${object.email}</field>
            <field
        name="email_cc"
      >${((object.company_id.parent_id and object.company_id.parent_id.hierarchy_level == 'coordinator' and
      object.company_id.parent_id.notify_to_coord_child_ccee_submissions and (object.company_id.parent_id.coop_email_contact or
      object.company_id.parent_id.email)) or '')|safe}</field>
            <field
        name="reply_to"
      >${(object.company_id.coop_email_contact or object.company_id.email)|safe}</field>
            <field name="model_id" ref="model_subscription_request" />
            <field name="auto_delete" eval="False" />
            <field
        name="lang"
      >${(object.lang or object.company_id.default_lang_id.code or object.company_id.partner_id.lang)}</field>
            <field name="is_cooperator_template" eval="True" />
            <field
        name="body_html"
      ><![CDATA[
    <p>Dear ${object.firstname},</p>
    <p>
        We confirm that we have correctly received your request to make a voluntary contribution to the capital
        social of <b>${object.company_id.name}</b>, with the following data:
    </p>
    <ul>
        <li>Partner VAT: <b>${object.vat}</b></li>
        <li>Partner name: <b>${object.firstname} ${object.lastname}</b></li>
        <li>Charging account: <b>${object.iban}</b></li>
        <li>Subscription amount: <b>${object.subscription_amount}â‚¬</b></li>
    </ul>
    <p>
        In the next few days you will receive the bank charge in this account, please verify that all the data
        provided is correct and you have the money you want to invest, to avoid any incident in the
        draft of the receipt.
    </p>
    <p>
        Once the validity of the payment has been verified, you will receive a new notification confirming the
        contribution
        made and detailing the particular conditions of your contribution.
    </p>
    <p>
        Thank you for your involvement with the cooperative and inform you that for any doubt or clarification you can
        consult
        our website:
        <a href="${object.company_id.website}"> ${object.company_id.website}</a>
        or send us an email to
        <a href="${object.company_id.email}">${object.company_id.email}</a>
    </p>
    <p>
        Get the word out by explaining the project to family and friends. The more we are, the further we will go!
    </p>
    <p>
        Thank you very much and good energy!
    </p>
    <p>
        Sincerely,
    </p>
    <p>
        ${object.company_id.name} team
    </p>
    <img src="/web/image/res.company/${object.company_id.id}/logo" style="width: 150px;height: 80px;"/>
            ]]></field>
        </record>
  </data>
</odoo>
