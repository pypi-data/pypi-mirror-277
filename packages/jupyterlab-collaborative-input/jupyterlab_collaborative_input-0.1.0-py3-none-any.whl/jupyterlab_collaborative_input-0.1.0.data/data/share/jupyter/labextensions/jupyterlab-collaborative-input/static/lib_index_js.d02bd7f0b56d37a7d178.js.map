{"version":3,"file":"lib_index_js.d02bd7f0b56d37a7d178.js","mappings":";;;;;;;;;AAAa;AACb;AACA;AACA;AACA;AACA,eAAe,oCAAoC;AACnD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB;AACnB,uBAAuB,mBAAO,CAAC,gDAAK;AACpC,kBAAkB,mBAAO,CAAC,wEAAiB;AAC3C,qBAAqB,mBAAO,CAAC,sFAAwB;AACrD,qBAAqB,mBAAO,CAAC,sFAAwB;AACrD,eAAe,mBAAO,CAAC,0EAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,mCAAmC;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,cAAc;AACjE,0BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,gBAAgB,MAAM;AACtB;AACA;AACA;;;;;;;;;;;AClIa;AACb;AACA;AACA;AACA;AACA,eAAe,oCAAoC;AACnD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,0CAA0C,4BAA4B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB,mBAAO,CAAC,kFAAsB;AACjD,0BAA0B,mBAAO,CAAC,gGAA6B;AAC/D,gDAAgD,mBAAO,CAAC,qEAA4B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,wCAAwC;AACpF,KAAK;AACL;AACA,kBAAe","sources":["webpack://jupyterlab-collaborative-input/./lib/collaborativeInputWidget.js","webpack://jupyterlab-collaborative-input/./lib/index.js"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PLUGIN_NAME = void 0;\nconst Y = __importStar(require(\"yjs\"));\nconst widgets_1 = require(\"@lumino/widgets\");\nconst outputarea_1 = require(\"@jupyterlab/outputarea\");\nconst codemirror_1 = require(\"@jupyterlab/codemirror\");\nconst view_1 = require(\"@codemirror/view\");\nconst OUTPUT_AREA_ITEM_CLASS = 'jp-OutputArea-child';\nconst OUTPUT_AREA_STDIN_ITEM_CLASS = 'jp-OutputArea-stdin-item';\nconst OUTPUT_AREA_PROMPT_CLASS = 'jp-OutputArea-prompt';\nconst OUTPUT_AREA_OUTPUT_CLASS = 'jp-OutputArea-output';\nconst STDIN_CLASS = 'jp-Stdin';\nconst STDIN_PROMPT_CLASS = 'jp-Stdin-prompt';\nconst STDIN_INPUT_CLASS = 'jp-Stdin-input';\nexports.PLUGIN_NAME = 'jupyterlab-collaborative-input';\nclass CollaborativeInputWidget extends widgets_1.Widget {\n    constructor(panel, tracker) {\n        super();\n        this._panel = panel;\n        //this._tracker = tracker;\n        const cells = panel.context.model.cells;\n        cells.changed.connect(this.updateConnectedCell, this);\n    }\n    updateConnectedCell(sender, changed) {\n        //changed.oldValues.forEach(this._unobserveStdinOutput.bind(this));\n        changed.newValues.forEach(this._observeStdinOutput.bind(this));\n    }\n    _observeStdinOutput(cellModel) {\n        const codeCell = this._getCodeCell(cellModel);\n        cellModel.sharedModel.changed.connect((sender, args) => { this.handleStdin(codeCell, args); });\n        const youtputs = cellModel.sharedModel.ymodel.get('outputs');\n        for (const youtput of youtputs) {\n            if (youtput instanceof Y.Map && youtput.get('output_type') === 'stdin') {\n                const prompt = youtput.get('prompt');\n                const password = youtput.get('password');\n                this.createInputWidget(codeCell, prompt, password, youtput);\n            }\n        }\n    }\n    handleStdin(sender, args) {\n        if (args.outputsChange !== undefined &&\n            args.outputsChange[0].insert !== undefined) {\n            const newOutput = args.outputsChange[0].insert[0];\n            const output_type = newOutput.get('output_type');\n            if (output_type === 'stdin') {\n                const prompt = newOutput.get('prompt');\n                const password = newOutput.get('password');\n                this.createInputWidget(sender, prompt, password, newOutput);\n            }\n        }\n    }\n    createInputWidget(cellModel, prompt, password, stdinOutput) {\n        const inputWidget = new InputWidget(prompt, password, stdinOutput, cellModel.model.sharedModel.awareness);\n        const panel = new widgets_1.Panel();\n        panel.addClass(OUTPUT_AREA_ITEM_CLASS);\n        panel.addClass(OUTPUT_AREA_STDIN_ITEM_CLASS);\n        const outputPrompt = new outputarea_1.OutputPrompt();\n        outputPrompt.addClass(OUTPUT_AREA_PROMPT_CLASS);\n        panel.addWidget(outputPrompt);\n        inputWidget.addClass(OUTPUT_AREA_OUTPUT_CLASS);\n        panel.addWidget(inputWidget);\n        cellModel.outputArea.layout.addWidget(panel);\n    }\n    _getCodeCell(cellModel) {\n        if (cellModel.type === 'code') {\n            const cell = this._panel.content.widgets.find((widget) => widget.model === cellModel);\n            return cell;\n        }\n        return null;\n    }\n}\nexports.default = CollaborativeInputWidget;\nclass InputWidget extends widgets_1.Widget {\n    constructor(prompt, password, stdinOutput, awareness) {\n        const node = document.createElement('div');\n        const promptNode = document.createElement('pre');\n        promptNode.className = STDIN_PROMPT_CLASS;\n        promptNode.textContent = prompt;\n        const input1 = document.createElement('div');\n        input1.className = STDIN_INPUT_CLASS;\n        input1.style.border = 'thin solid';\n        const input2 = document.createElement('div');\n        if (password === true) {\n            input2.style.webkitTextSecurity = 'disc';\n        }\n        input1.appendChild(input2);\n        node.appendChild(promptNode);\n        promptNode.appendChild(input1);\n        const stdin = stdinOutput.get('value');\n        const ybind = (0, codemirror_1.ybinding)({ ytext: stdin });\n        const submit = ({ state, dispatch }) => {\n            stdinOutput.set('submitted', true);\n            return true;\n        };\n        const submitWithEnter = {\n            key: 'Enter',\n            run: submit\n        };\n        new view_1.EditorView({\n            doc: stdin.toString(),\n            extensions: [view_1.keymap.of([submitWithEnter]), ybind],\n            parent: input2\n        });\n        super({ node });\n        this.addClass(STDIN_CLASS);\n    }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst notebook_1 = require(\"@jupyterlab/notebook\");\nconst settingregistry_1 = require(\"@jupyterlab/settingregistry\");\nconst collaborativeInputWidget_1 = __importStar(require(\"./collaborativeInputWidget\"));\nclass CollaborativeInputWidgetExtension {\n    constructor(tracker) {\n        this._tracker = tracker;\n    }\n    createNew(panel, context) {\n        return new collaborativeInputWidget_1.default(panel, this._tracker);\n    }\n}\nconst extension = {\n    id: collaborativeInputWidget_1.PLUGIN_NAME,\n    autoStart: true,\n    requires: [notebook_1.INotebookTracker, settingregistry_1.ISettingRegistry],\n    activate: async (app, tracker, settingRegistry) => {\n        app.docRegistry.addWidgetExtension('Notebook', new CollaborativeInputWidgetExtension(tracker));\n        // eslint-disable-next-line no-console\n        console.log(`JupyterLab extension ${collaborativeInputWidget_1.PLUGIN_NAME} is activated!`);\n    },\n};\nexports.default = extension;\n"],"names":[],"sourceRoot":""}