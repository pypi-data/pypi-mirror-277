import{bl as ne,r as t,bs as j,bo as S,bp as F,bq as V,bn as q}from"./index-71c35d0b.js";import{e as ae}from"./index-f9760e62.js";const[U,xe]=ne("Form"),J="Form",[se,P]=U(J),[ce,Q]=U(J),ie=t.forwardRef((e,r)=>{const{__scopeForm:a,onClearServerErrors:c=()=>{},...i}=e,d=t.useRef(null),v=j(r,d),[m,$]=t.useState({}),f=t.useCallback(n=>m[n],[m]),b=t.useCallback((n,s)=>$(l=>{var u;return{...l,[n]:{...(u=l[n])!==null&&u!==void 0?u:{},...s}}}),[]),_=t.useCallback(n=>{$(s=>({...s,[n]:void 0})),o(s=>({...s,[n]:{}}))},[]),[C,E]=t.useState({}),M=t.useCallback(n=>{var s;return(s=C[n])!==null&&s!==void 0?s:[]},[C]),g=t.useCallback((n,s)=>{E(l=>{var u;return{...l,[n]:[...(u=l[n])!==null&&u!==void 0?u:[],s]}})},[]),p=t.useCallback((n,s)=>{E(l=>{var u;return{...l,[n]:((u=l[n])!==null&&u!==void 0?u:[]).filter(k=>k.id!==s)}})},[]),[I,o]=t.useState({}),h=t.useCallback(n=>{var s;return(s=I[n])!==null&&s!==void 0?s:{}},[I]),y=t.useCallback((n,s)=>{o(l=>{var u;return{...l,[n]:{...(u=l[n])!==null&&u!==void 0?u:{},...s}}})},[]),[A,x]=t.useState({}),w=t.useCallback((n,s)=>{x(l=>{const u=new Set(l[n]).add(s);return{...l,[n]:u}})},[]),D=t.useCallback((n,s)=>{x(l=>{const u=new Set(l[n]);return u.delete(s),{...l,[n]:u}})},[]),T=t.useCallback(n=>{var s;return Array.from((s=A[n])!==null&&s!==void 0?s:[]).join(" ")||void 0},[A]);return t.createElement(se,{scope:a,getFieldValidity:f,onFieldValidityChange:b,getFieldCustomMatcherEntries:M,onFieldCustomMatcherEntryAdd:g,onFieldCustomMatcherEntryRemove:p,getFieldCustomErrors:h,onFieldCustomErrorsChange:y,onFieldValiditionClear:_},t.createElement(ce,{scope:a,onFieldMessageIdAdd:w,onFieldMessageIdRemove:D,getFieldDescription:T},t.createElement(S.form,F({},i,{ref:v,onInvalid:V(e.onInvalid,n=>{const s=X(n.currentTarget);s===n.target&&s.focus(),n.preventDefault()}),onSubmit:V(e.onSubmit,c,{checkForDefaultPrevented:!1}),onReset:V(e.onReset,c)}))))}),W="FormField",[de,G]=U(W),le=t.forwardRef((e,r)=>{const{__scopeForm:a,name:c,serverInvalid:i=!1,...d}=e,m=P(W,a).getFieldValidity(c),$=q();return t.createElement(de,{scope:a,id:$,name:c,serverInvalid:i},t.createElement(S.div,F({"data-valid":N(m,i),"data-invalid":K(m,i)},d,{ref:r})))}),z="FormLabel",ue=t.forwardRef((e,r)=>{const{__scopeForm:a,...c}=e,i=P(z,a),d=G(z,a),v=c.htmlFor||d.id,m=i.getFieldValidity(d.name);return t.createElement(ae,F({"data-valid":N(m,d.serverInvalid),"data-invalid":K(m,d.serverInvalid)},c,{ref:r,htmlFor:v}))}),O="FormControl",me=t.forwardRef((e,r)=>{const{__scopeForm:a,...c}=e,i=P(O,a),d=G(O,a),v=Q(O,a),m=t.useRef(null),$=j(r,m),f=c.name||d.name,b=c.id||d.id,_=i.getFieldCustomMatcherEntries(f),{onFieldValidityChange:C,onFieldCustomErrorsChange:E,onFieldValiditionClear:M}=i,g=t.useCallback(async o=>{if(Y(o.validity)){const l=B(o.validity);C(f,l);return}const h=o.form?new FormData(o.form):new FormData,y=[o.value,h],A=[],x=[];_.forEach(l=>{be(l,y)?x.push(l):ge(l)&&A.push(l)});const w=A.map(({id:l,match:u})=>[l,u(...y)]),D=Object.fromEntries(w),T=Object.values(D).some(Boolean),n=T;o.setCustomValidity(n?R:"");const s=B(o.validity);if(C(f,s),E(f,D),!T&&x.length>0){const l=x.map(({id:te,match:re})=>re(...y).then(oe=>[te,oe])),u=await Promise.all(l),k=Object.fromEntries(u),Z=Object.values(k).some(Boolean);o.setCustomValidity(Z?R:"");const ee=B(o.validity);C(f,ee),E(f,k)}},[_,f,E,C]);t.useEffect(()=>{const o=m.current;if(o){const h=()=>g(o);return o.addEventListener("change",h),()=>o.removeEventListener("change",h)}},[g]);const p=t.useCallback(()=>{const o=m.current;o&&(o.setCustomValidity(""),M(f))},[f,M]);t.useEffect(()=>{var o;const h=(o=m.current)===null||o===void 0?void 0:o.form;if(h)return h.addEventListener("reset",p),()=>h.removeEventListener("reset",p)},[p]),t.useEffect(()=>{const o=m.current,h=o==null?void 0:o.closest("form");if(h&&d.serverInvalid){const y=X(h);y===o&&y.focus()}},[d.serverInvalid]);const I=i.getFieldValidity(f);return t.createElement(S.input,F({"data-valid":N(I,d.serverInvalid),"data-invalid":K(I,d.serverInvalid),"aria-invalid":d.serverInvalid?!0:void 0,"aria-describedby":v.getFieldDescription(f),title:""},c,{ref:$,id:b,name:f,onInvalid:V(e.onInvalid,o=>{const h=o.currentTarget;g(h)}),onChange:V(e.onChange,o=>{p()})}))}),R="This value is not valid",fe={badInput:R,patternMismatch:"This value does not match the required pattern",rangeOverflow:"This value is too large",rangeUnderflow:"This value is too small",stepMismatch:"This value does not match the required step",tooLong:"This value is too long",tooShort:"This value is too short",typeMismatch:"This value does not match the required type",valid:void 0,valueMissing:"This value is missing"},L="FormMessage",ve=t.forwardRef((e,r)=>{const{match:a,name:c,...i}=e,d=G(L,e.__scopeForm),v=c??d.name;return a===void 0?t.createElement(H,F({},i,{ref:r,name:v}),e.children||R):typeof a=="function"?t.createElement(he,F({match:a},i,{ref:r,name:v})):t.createElement($e,F({match:a},i,{ref:r,name:v}))}),$e=t.forwardRef((e,r)=>{const{match:a,forceMatch:c=!1,name:i,children:d,...v}=e,$=P(L,v.__scopeForm).getFieldValidity(i);return c||($==null?void 0:$[a])?t.createElement(H,F({ref:r},v,{name:i}),d??fe[a]):null}),he=t.forwardRef((e,r)=>{const{match:a,forceMatch:c=!1,name:i,id:d,children:v,...m}=e,$=P(L,m.__scopeForm),f=t.useRef(null),b=j(r,f),_=q(),C=d??_,E=t.useMemo(()=>({id:C,match:a}),[C,a]),{onFieldCustomMatcherEntryAdd:M,onFieldCustomMatcherEntryRemove:g}=$;t.useEffect(()=>(M(i,E),()=>g(i,E.id)),[E,i,M,g]);const p=$.getFieldValidity(i),o=$.getFieldCustomErrors(i)[C];return c||p&&!Y(p)&&o?t.createElement(H,F({id:C,ref:b},m,{name:i}),v??R):null}),H=t.forwardRef((e,r)=>{const{__scopeForm:a,id:c,name:i,...d}=e,v=Q(L,a),m=q(),$=c??m,{onFieldMessageIdAdd:f,onFieldMessageIdRemove:b}=v;return t.useEffect(()=>(f(i,$),()=>b(i,$)),[i,$,f,b]),t.createElement(S.span,F({id:$},d,{ref:r}))}),Ce=t.forwardRef((e,r)=>{const{__scopeForm:a,...c}=e;return t.createElement(S.button,F({type:"submit"},c,{ref:r}))});function B(e){const r={};for(const a in e)r[a]=e[a];return r}function Fe(e){return e instanceof HTMLElement}function Ee(e){return"validity"in e}function pe(e){return Ee(e)&&(e.validity.valid===!1||e.getAttribute("aria-invalid")==="true")}function X(e){const r=e.elements,[a]=Array.from(r).filter(Fe).filter(pe);return a}function be(e,r){return e.match.constructor.name==="AsyncFunction"||ye(e.match,r)}function ge(e){return e.match.constructor.name==="Function"}function ye(e,r){return e(...r)instanceof Promise}function Y(e){let r=!1;for(const a in e){const c=a;if(c!=="valid"&&c!=="customError"&&e[c]){r=!0;break}}return r}function N(e,r){if((e==null?void 0:e.valid)===!0&&!r)return!0}function K(e,r){if((e==null?void 0:e.valid)===!1||r)return!0}const Ae=ie,Ve=le,Re=ue,Se=me,Pe=ve,De=Ce;export{Ae as $,Ve as a,Re as b,Se as c,Pe as d,De as e};
