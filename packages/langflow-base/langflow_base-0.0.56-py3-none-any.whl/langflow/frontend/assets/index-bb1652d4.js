import{r as f,j as e,an as W,I as k,ao as A,u as b,ap as C,aq as oe,ar as le,as as re,c as j,s as T,m as ae,am as ce,b as ie}from"./index-71c35d0b.js";import{u as H,a as de,F as me}from"./form-2deac0aa.js";import{C as ue,S as J,I as pe}from"./index-ba36bd89.js";import{P as fe}from"./index-0772fd48.js";import{D as he}from"./index-9e31ddd7.js";import{C as ge,S as xe}from"./index-7a443114.js";import"./textarea-d0c5be10.js";import"./index-f9760e62.js";import"./index-5f664ee1.js";import"./tabs-996f42ed.js";import"./index-a9178689.js";import"./index-e80662d6.js";import"./input-8d6f9961.js";import"./select-a3c7a073.js";import"./index-cbab13d3.js";import"./index-0e38933a.js";import"./index-6658e47c.js";import"./index-86bb14e4.js";import"./table-73ee088b.js";function je({onFileDrop:n,children:c,dragMessage:l}){const[d,i]=f.useState(!1);f.useEffect(()=>{const s=()=>{document.visibilityState==="visible"&&i(!1)};return document.addEventListener("visibilitychange",s),()=>{document.removeEventListener("visibilitychange",s)}},[]);const o=s=>{s.preventDefault(),s.dataTransfer.types.some(u=>u==="Files")&&n&&i(!0)},a=s=>{s.dataTransfer.types.some(u=>u==="Files")&&n&&i(!0),s.preventDefault()},r=s=>{s.preventDefault(),n&&i(!1)},m=s=>{s.preventDefault(),n&&n(s),i(!1)};return e.jsx("div",{onDragOver:o,onDragEnter:a,onDragLeave:r,onDrop:m,className:W("h-full w-full",d?"mb-36 flex flex-col items-center justify-center gap-4 text-2xl font-light":""),children:d?e.jsxs(e.Fragment,{children:[e.jsx(k,{name:"ArrowUpToLine",className:"h-12 w-12 stroke-1"}),l||"Drop your file here"]}):c})}const we=(n,c)=>{var s;const l=A(),d=b(u=>u.setSuccessData),i=b(u=>u.setErrorData),o=C(u=>u.getFolderById),a=(s=l==null?void 0:l.state)==null?void 0:s.folderId,r=C(u=>u.myCollectionId);return[u=>{if(u.preventDefault(),u.dataTransfer.types.some(w=>w==="Files")){const w=u.dataTransfer.files.item(0);if(w.type==="application/json"){const F=new FileReader;F.onload=h=>{const L=h.target.result,N=JSON.parse(L).is_component;n({newProject:!0,file:w,isComponent:c==="all"?null:c==="component"}).then(()=>{d({title:`${N?"Component":"Flow"} uploaded successfully`}),o(a||r)}).catch(D=>{i({title:oe,list:[D]})})},F.readAsText(w)}else i({title:le,list:[re]})}}]},Ce=n=>{switch(n){case"all":return"Component or Flow";case"component":return"Component";default:return"Flow"}},ve=(n,c)=>{const l=c==="component",d=(o,a)=>{const r=(o==null?void 0:o.updated_at)||(o==null?void 0:o.date_created),m=(a==null?void 0:a.updated_at)||(a==null?void 0:a.date_created);return r&&m?new Date(m).getTime()-new Date(r).getTime():r?1:m?-1:0},i=c==="all"?n:n==null?void 0:n.filter(o=>((o==null?void 0:o.is_component)??!1)===l);return(i==null?void 0:i.sort(d))??[]},Fe=({})=>{const n=j(l=>l.addFlow),c=T();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex-max-width h-full flex-col",children:e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[e.jsx("div",{className:"grid w-full gap-4 text-muted-foreground",children:"Flows and components can be created using Langflow."}),e.jsxs("div",{className:"align-center flex w-full justify-center gap-1 ",children:[e.jsx("span",{className:"text-muted-foreground",children:"New?"}),e.jsxs("span",{className:"transition-colors hover:text-muted-foreground",children:[e.jsx("button",{onClick:()=>{n(!0).then(l=>{c("/flow/"+l)})},className:"underline",children:"Start Here"}),"."]}),e.jsx("span",{className:"animate-pulse",children:"ðŸš€"})]})]})})})})},Se=({handleSelectAll:n,handleDelete:c,disableDelete:l})=>{const[d,i]=f.useState(!0),o=()=>{n(d),i(a=>!a)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 pb-5",children:[e.jsx("div",{className:"col-auto grid-cols-1 self-center justify-self-start",children:e.jsx("a",{onClick:o,className:"text-sm",children:e.jsx("div",{className:"header-menu-bar-display ",children:e.jsx("div",{className:"header-menu-flow-name","data-testid":"select_all_collection",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{checked:!d,id:"terms"}),e.jsx("label",{onClick:o,htmlFor:"terms",className:"label cursor-pointer text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:d?"Select All":"Unselect All"})]})})})})}),e.jsx("div",{className:"col-span-2 grid-cols-1 justify-self-end",children:e.jsx("div",{children:e.jsx(xe,{content:l?e.jsx("span",{children:"Select items to delete"}):e.jsx("span",{children:"Delete selected items"}),children:e.jsx("button",{onClick:c,disabled:l,children:e.jsx(k,{name:"Trash2",className:W("h-5 w-5 text-primary transition-all",l?"":"hover:text-destructive")})})})})})]})})};function be({type:n="all"}){var z;const c=j(t=>t.uploadFlow),l=j(t=>t.removeFlow),d=j(t=>t.isLoading),i=j(t=>t.setAllFlows),o=j(t=>t.allFlows),a=C(t=>{var p;return(p=t.selectedFolder)==null?void 0:p.flows}),r=b(t=>t.setSuccessData),m=b(t=>t.setErrorData),[s,u]=f.useState(!1),w=j(t=>t.searchFlowsComponents),F=j(t=>t.setSelectedFlowsComponentsCards),h=j(t=>t.selectedFlowsComponentsCards),[L]=we(c,n),[y,N]=f.useState(20),[D,O]=f.useState(1),$=T(),E=A(),I=ve(o,n),R=(D-1)*y,G=R+y,x=I==null?void 0:I.slice(R,G),q=Ce(n),v=(z=E==null?void 0:E.state)==null?void 0:z.folderId,P=C(t=>t.getFolderById),_=C(t=>t.myCollectionId),K=C(t=>t.getFoldersApi),Q=C(t=>t.setFolderUrl);f.useEffect(()=>{Q(v??""),F([]),V(!1),P(v||_)},[E]),f.useEffect(()=>{const t=ae.cloneDeep(a),p=t==null?void 0:t.filter(g=>g.name.toLowerCase().includes(w.toLowerCase())||g.description.toLowerCase().includes(w.toLowerCase()));w===""&&i(a),i(p)},[w]);const X=()=>{O(1),N(20)},{getValues:B,control:M,setValue:U}=H(),S=de({control:M}),Y=H(),V=t=>{const p=a==null?void 0:a.map(g=>g.id);if(t){Object.keys(B()).forEach(g=>{p!=null&&p.includes(g)&&U(g,!0)});return}Object.keys(B()).forEach(g=>{U(g,!1)})},Z=()=>{if(!((h==null?void 0:h.length)>0)){m({title:"No items selected",list:["Please select items to delete"]});return}u(!0)},ee=()=>{l(h).then(()=>{X(),K(!0),(!v||v===_)&&P(v||_),r({title:"Selected items deleted successfully!"})}).catch(()=>{m({title:"Error deleting items",list:["Please try again"]})})};f.useEffect(()=>{if(!S||Object.keys(S).length===0)return;const t=Object.keys(S).filter(p=>S[p]===!0);F(t)},[S]);const te=f.useMemo(()=>{const t=g=>({all:"item",component:"component",flow:"flow"})[g]||"",p=g=>({all:"items",component:"components",flow:"flows"})[g]||"";return(h==null?void 0:h.length)===1?t(n):p(n)},[h,n]),se=()=>{var t;return n==="all"?o==null?void 0:o.length:(t=o==null?void 0:o.filter(p=>(p.is_component??!1)===(n==="component")))==null?void 0:t.length};return e.jsxs(e.Fragment,{children:[(o==null?void 0:o.length)>0&&e.jsx(Se,{handleDelete:Z,handleSelectAll:V,disableDelete:!((h==null?void 0:h.length)>0)}),e.jsx(je,{onFileDrop:L,dragMessage:`Drag your ${q} here`,children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsx("div",{className:"flex w-full flex-col gap-4",children:!d&&(x==null?void 0:x.length)===0?e.jsx(Fe,{}):e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-2",children:d===!1&&(x==null?void 0:x.length)>0?e.jsx(e.Fragment,{children:x==null?void 0:x.map(t=>f.createElement(me,{...Y,key:t.id},e.jsx("form",{children:e.jsx(ue,{is_component:n==="component",data:{is_component:t.is_component??!1,...t},disabled:d,"data-testid":"edit-flow-button-"+t.id,button:t.is_component?e.jsx(e.Fragment,{}):e.jsx(ce,{to:"/flow/"+t.id,children:e.jsxs(ie,{tabIndex:-1,variant:"outline",size:"sm",className:"whitespace-nowrap","data-testid":"edit-flow-button-"+t.id,children:[e.jsx(k,{name:"ExternalLink",className:"main-page-nav-button select-none"}),"Edit Flow"]})}),onClick:t.is_component?void 0:()=>{$("/flow/"+t.id)},playground:!t.is_component,control:M})})))}):e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(J,{})]})})}),!d&&(x==null?void 0:x.length)>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(fe,{storeComponent:!0,pageIndex:D,pageSize:y,rowsCount:[10,20,50,100],totalRowsCount:se(),paginate:(t,p)=>{O(p),N(t)}})})]})}),s&&e.jsx(he,{open:s,setOpen:u,onConfirm:ee,description:te,children:e.jsx(e.Fragment,{})})]})}const ye=({tabsOptions:n,setActiveTab:c,loading:l,tabActive:d})=>{const i=T(),o=C(r=>r.folderUrl),a=r=>{const m=window.location.pathname;let s="";switch(r){case"Flows":s=m.replace(/components|all/,"flows");break;case"Components":s=m.replace(/flows|all/,"components");break;default:s=m.replace(/flows|components/,"all");break}i(s,{state:{folderId:o}})};return f.useEffect(()=>{const r=window.location.pathname;r.includes("components")?c("Components"):r.includes("flows")?c("Flows"):c("All")},[window.location.pathname]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:n.map((r,m)=>e.jsx("button",{"data-testid":`${r}-button-store`,disabled:l,onClick:()=>{a(r)},className:(d===r?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(l?" cursor-not-allowed ":""),children:r},m))})})},Ne=({})=>{var m;const n=A(),c=C(s=>s.myCollectionId);(m=n==null?void 0:n.state)!=null&&m.folderId;const l=j(s=>s.isLoading),[d,i]=f.useState("Flows");b(s=>s.setErrorData),j(s=>s.allFlows);const[o,a]=f.useState(""),r=j(s=>s.setSearchFlowsComponents);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex items-end gap-4",children:[e.jsx(pe,{loading:l,value:o,onChange:s=>{r(s.target.value),a(s.target.value)},onKeyDown:s=>{s.key==="Enter"&&r(o)}}),e.jsx(ye,{tabsOptions:["All","Flows","Components"],setActiveTab:i,loading:l,tabActive:d})]})})},$e=({key:n,type:c})=>e.jsxs(e.Fragment,{children:[e.jsx(Ne,{}),e.jsx("div",{className:"mt-5 flex h-full flex-col",children:e.jsx(be,{type:c},n)})]});export{$e as default};
