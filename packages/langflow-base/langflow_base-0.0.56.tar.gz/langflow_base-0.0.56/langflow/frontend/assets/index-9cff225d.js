import{j as e,r as l,u as P,A as Q,a7 as i,B as A,b1 as re,b2 as ne,b3 as oe,I as _,b4 as ie,b as R,b5 as de,b6 as ce,b7 as ue,c as Y,al as pe,s as me,b8 as M,b9 as xe,ba as he,bb as fe,bc as ge,bd as be,be as je,bf as ye,an as Se,m as q,aY as Ae,am as ve}from"./index-71c35d0b.js";import{I as Ce,C as we,S as T}from"./index-ba36bd89.js";import{P as Ne}from"./index-6f541281.js";import{S as Ee}from"./index-7a443114.js";import{P as Ie}from"./index-0772fd48.js";import{T as Ke}from"./index-946f00bf.js";import{S as G,a as H,b as U,c as X,d as Te,e as y}from"./select-a3c7a073.js";import{$ as Pe,a as _e,c as Re,e as Fe}from"./index-86bb14e4.js";import{I as ke}from"./input-8d6f9961.js";import"./index-5f664ee1.js";import"./tabs-996f42ed.js";import"./index-a9178689.js";import"./index-e80662d6.js";import"./textarea-d0c5be10.js";import"./index-f9760e62.js";import"./index-0e38933a.js";import"./index-6658e47c.js";import"./table-73ee088b.js";import"./index-9e31ddd7.js";import"./form-2deac0aa.js";import"./index-4aa4df2b.js";import"./index-c9c9f065.js";import"./index-cbab13d3.js";function J({children:d,disabled:r=!1}){if(r)return e.jsx(e.Fragment,{children:d});const[x,c]=l.useState(!1),v=P(s=>s.setSuccessData),j=P(s=>s.setErrorData),{storeApiKey:C}=l.useContext(Q),[h,a]=l.useState(""),f=i(s=>s.validApiKey),S=i(s=>s.hasApiKey),g=i(s=>s.updateHasApiKey),u=i(s=>s.updateValidApiKey),o=i(s=>s.updateLoadingApiKey),w=()=>{h&&de(h).then(()=>{v({title:ce}),C(h),c(!1),g(!0),u(!0),o(!1)},s=>{j({title:ue,list:[s.response.data.detail]}),g(!1),u(!1),o(!1)})};return e.jsxs(A,{size:"small-h-full",open:x&&!r,setOpen:c,children:[e.jsx(A.Trigger,{asChild:!0,children:d}),e.jsxs(A.Header,{description:(S&&!f?re:S?"":ne)+oe,children:[e.jsx("span",{className:"pr-2",children:"API Key"}),e.jsx(_,{name:"Key",className:"h-6 w-6 pl-1 text-foreground","aria-hidden":"true"})]}),e.jsx(A.Content,{children:e.jsxs(Pe,{onSubmit:s=>{s.preventDefault(),w()},children:[e.jsx("div",{className:"grid gap-5",children:e.jsx(_e,{name:"apikey",children:e.jsx("div",{className:"flex items-center justify-between gap-2",children:e.jsx(Re,{asChild:!0,children:e.jsx(ke,{value:h,type:"password",onChange:({target:{value:s}})=>{a(s)},placeholder:"Insert your API Key"})})})})}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("span",{className:"pr-1 text-xs text-muted-foreground",children:[ie," ",e.jsx("a",{className:"text-high-indigo underline",href:"https://langflow.store/",target:"_blank",children:"langflow.store"})]}),e.jsxs("div",{className:"",children:[e.jsx(R,{className:"mr-3",variant:"outline",onClick:()=>{c(!1)},children:"Cancel"}),e.jsx(Fe,{asChild:!0,children:e.jsx(R,{"data-testid":"api-key-save-button-store",className:"mt-8",children:"Save"})})]})]})]})})]})}function rt(){const d=i(t=>t.hasApiKey),r=i(t=>t.validApiKey),x=i(t=>t.loadingApiKey),c=i(t=>t.updateValidApiKey),{apiKey:v}=l.useContext(Q),j=P(t=>t.setErrorData),C=Y(t=>t.setCurrentFlowId),h=Y(t=>t.currentFlowId),[a,f]=l.useState(!0),[S,g]=l.useState(!0),{id:u}=pe(),[o,w]=l.useState([]),[s,W]=l.useState(""),[p,F]=l.useState([]),[N,k]=l.useState(0),[E,L]=l.useState(12),[I,O]=l.useState(1),[$,Z]=l.useState("Popular"),[ee,te]=l.useState([]),[m,K]=l.useState("All"),[se,V]=l.useState(""),[b,D]=l.useState("all");me(),l.useEffect(()=>{x||(d?r||j({title:M,list:[he]}):(j({title:M,list:[xe]}),f(!1)))},[x,r,d,h]),l.useEffect(()=>{ae(),le()},[m,$,I,E,o,b,r,d,v,se,x,u]);function ae(){g(!0),fe().then(t=>{te(t),g(!1)}).catch(t=>{console.log(t),g(!1)})}function le(){x||(f(!0),ge({component_id:u,page:I,limit:E,is_component:m==="All"?null:m!=="Flows",sort:$==="Popular"?"-count(downloads)":"name",tags:o,liked:b==="likedbyme"&&r?!0:null,isPrivate:null,search:s===""?null:s,filterByUser:b==="createdbyme"&&r?!0:null}).then(t=>{var n;!(t!=null&&t.authorized)&&r===!0?(c(!1),D("all")):(t!=null&&t.authorized&&c(!0),f(!1),F((t==null?void 0:t.results)??[]),k((o==null?void 0:o.length)===0?Number((t==null?void 0:t.count)??0):((n=t==null?void 0:t.results)==null?void 0:n.length)??0))}).catch(t=>{var n,z;((n=t.response)==null?void 0:n.status)===403||((z=t.response)==null?void 0:z.status)===401?c(!1):(F([]),k(0),f(!1),j({title:be,list:[t.response.data.detail]}))}))}l.useEffect(()=>{C("")},[]);function B(){O(1),L(12)}return e.jsx(Ne,{betaIcon:!0,title:je,description:ye,button:e.jsx(e.Fragment,{children:J&&e.jsx(J,{disabled:a,children:e.jsxs(R,{"data-testid":"api-key-button-store",disabled:a,className:Se(`${r?"":"animate-pulse border-error"}`,a?"cursor-not-allowed":""),variant:"primary",children:[e.jsx(_,{name:"Key",className:"mr-2 w-4"}),"API Key"]})})}),children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 p-0",children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(Ce,{loading:a,divClasses:"relative h-12 w-[40%]",value:s,onChange:t=>W(t.target.value),onKeyDown:t=>{t.key==="Enter"&&V(q.uniqueId())},onClick:()=>{V(q.uniqueId())}}),e.jsxs("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:[e.jsx("button",{"data-testid":"all-button-store",disabled:a,onClick:()=>{K("All")},className:(m==="All"?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(a?" cursor-not-allowed ":""),children:"All"}),e.jsx("button",{"data-testid":"flows-button-store",disabled:a,onClick:()=>{B(),K("Flows")},className:(m==="Flows"?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(a?" cursor-not-allowed ":""),children:"Flows"}),e.jsx("button",{"data-testid":"components-button-store",disabled:a,onClick:()=>{B(),K("Components")},className:(m==="Components"?"border-b-2 border-primary p-3":" border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(a?" cursor-not-allowed ":""),children:"Components"}),e.jsx(Ee,{content:"Coming Soon",children:e.jsx("button",{className:"cursor-not-allowed p-3 text-muted-foreground",children:"Bundles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(G,{disabled:a,onValueChange:D,value:b,children:[e.jsx(H,{className:"mr-4 w-[160px] flex-shrink-0",children:e.jsx(U,{placeholder:"Filter Values"})}),e.jsx(X,{children:e.jsxs(Te,{children:[e.jsx(y,{value:"all",children:"All"}),e.jsx(y,{disabled:!d||!r,value:"createdbyme",children:"Created By Me"}),e.jsx(y,{disabled:!d||!r,value:"likedbyme",children:"Liked By Me"})]})})]}),u===void 0?e.jsx(Ke,{tags:ee,loadingTags:S,disabled:a,selectedTags:o,setSelectedTags:w}):e.jsxs(Ae,{variant:"outline",size:"sq",className:"gap-2 bg-beta-foreground text-background hover:bg-beta-foreground",children:[e.jsx(ve,{to:"/store",className:"cursor-pointer",children:e.jsx(_,{name:"X",className:"h-4 w-4"})}),u]},"id")]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"px-0.5 text-sm text-muted-foreground",children:(!a||p.length!==0)&&e.jsxs(e.Fragment,{children:[N," ",N!==1?"results":"result"]})}),e.jsxs(G,{disabled:a,onValueChange:t=>{Z(t)},children:[e.jsx(H,{"data-testid":"select-order-store",children:e.jsx(U,{placeholder:"Popular"})}),e.jsxs(X,{children:[e.jsx(y,{value:"Popular",children:"Popular"}),e.jsx(y,{value:"Alphabetical",children:"Alphabetical"})]})]})]}),e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-3",children:!a||p.length!==0?p.map(t=>{var n;return e.jsx(e.Fragment,{children:e.jsx(we,{data:t,authorized:r,disabled:a,playground:((n=t.last_tested_version)==null?void 0:n.includes("1.0.0"))&&!t.is_component},t.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(T,{}),e.jsx(T,{})]})}),!a&&(p==null?void 0:p.length)===0&&e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex h-full w-full flex-col",children:e.jsx("div",{className:"flex w-full flex-col gap-4",children:e.jsx("div",{className:"grid w-full gap-4",children:b!="all"?e.jsxs(e.Fragment,{children:["You haven't"," ",b==="createdbyme"?"created":"liked"," ","anything with the selected filters yet."]}):e.jsxs(e.Fragment,{children:["There are no"," ",m=="Flows"?"Flows":"Components"," with the selected filters."]})})})})})]}),!a&&p.length>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(Ie,{storeComponent:!0,pageIndex:I,pageSize:E,totalRowsCount:N,paginate:(t,n)=>{O(n),L(t)}})})]})})}export{rt as default};
