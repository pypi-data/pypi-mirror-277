<!DOCTYPE html>
<html>

<head>
  <title>{% if page.title %}{{ page.title }} - {% endif %}{{ config.site_name }}</title>
  <link href="{{ 'css/torillic.css'|url }}" rel="stylesheet">
  {%- for path in config.extra_css %}
  <link href="{{ path | url }}" rel="stylesheet">
  {%- endfor %}
  <style>
    .torillic-background {
      {% if config.theme.background_image %}
      background-image: url("{{ config.theme.background_image | url }}");
      {% endif %}
    }
  </style>
</head>

<body class="torillic-background">
  <header class="torillic-header">
    <h1>{{ config.site_name }}</h1>
    <nav>
      {% for nav_item in nav %}
      {% if nav_item.children and not nav_item.url %}
      <a class="{% if nav_item.active %}current{% endif %}" href="{{ nav_item.children[0].url|url }}">{{nav_item.title }}</a>
      {% else %}
      <a class="{% if nav_item.active %}current{% endif %}" href="{{ nav_item.url|url }}">{{nav_item.title }}</a>
      {% endif %}
      {% endfor %}
    </nav>
  </header>
  <main class="torillic-page">
    {{ page.content }}

    {% if page.is_homepage %}
    {# add global contents on the root page #}
    <h3>Contents</h3>
    {% for nav_item in nav %}
    {% if nav_item != page %}
    <h4>
      {% if nav_item.url %}
      {% set nav_item_url = nav_item.url %}
      {% else %}
      {% set nav_item_url = nav_item.children[0].url %}
      {% endif %}
      <a class="{% if nav_item.active %}current{% endif %}" href="{{ nav_item_url|url }}">{{ nav_item.title }}</a>
    </h4>
    {% if nav_item.children %}
    <blockquote style="break-inside: avoid;">
      {% for nav_subitem in nav_item.children %}
      {% if nav_subitem.url != nav_item_url %}
      <li>
        <a href="{{ nav_subitem.url|url }}">{{nav_subitem.title}}</a>
      </li>
      {% endif %}
      {% endfor %}
    </blockquote>
    {% endif %}
    {% endif %}
    {% endfor %}
    {% endif %}
    
  </main>
  {%- for script in config.extra_javascript %}
  {{ script | script_tag }}
  {%- endfor %}
</body>

</html>