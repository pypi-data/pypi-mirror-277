{"version":3,"file":"extensionConfig.js","names":["window","ReviewBot","ExtensionConfig","Backbone","Model","extend","defaults","brokerURL","user","initialize","attributes","options","prototype","call","UserConfigView","View","className","id","events","_templateRB4","_","template","_templateRB3","_optionTemplate","render","model","get","RB","Product","$el","html","titleText","gettext","labelText","descriptionText","selectPlaceholderText","orHTML","hasUser","currentItems","currentOptions","push","_$select","$","selectize","closeAfterSelect","dropdownParent","hideSelected","maxItems","preload","items","searchField","valueField","load","query","callback","params","fullname","length","q","ajax","type","url","SITE_ROOT","data","success","result","users","error","xhr","textStatus","errorThrown","alert","console","item","avatarURL","avatar_url","username","option","_selectize","listenTo","value","_setOption","_createUser","e","preventDefault","stopPropagation","$details","lock","userConfigURL","complete","unlock","blur","empty","clear","clearOptions","addOption","setValue","BrokerStatusView","_updatingTemplate","_connectedTemplate","_errorTemplate","_updating","_connected","_rendered","_errorText","_workers","_update","_$content","appendTo","_updateDisplay","refreshingText","workersText","interpolate","ngettext","connectedText","refreshText","workers","readyText","configureIntegrationsHTML","integrationConfigURL","errorText","_onRefreshClicked","workerStatusURL","hosts","state","BrokerConfigView","ConfigView","_userConfigView","_brokerConfigView","_$form","append","_$saveButton","val","_onSaveClicked","prop","$spinner","insertBefore","location","pathname","serialize","remove","response","broker_url","set","ExtensionConfigView","configureText","brokerText","_view","el","_statusView"],"sources":["../../../../../reviewbotext/static/js/extensionConfig.es6.js"],"sourcesContent":["{\n\n\nwindow.ReviewBot = window.ReviewBot || {};\n\n\n/**\n * The model for the configuration page.\n *\n * Model Attributes:\n *     brokerURL (string):\n *         The URL for the AMQP broker.\n *\n *     user (number):\n *         The ID of the user for Review Bot to post as.\n */\nReviewBot.ExtensionConfig = Backbone.Model.extend({\n    defaults: {\n        brokerURL: '',\n        user: null,\n    },\n\n    /**\n     * Initialize the model.\n     *\n     * Args:\n     *     attributes (object):\n     *         Initial attribute values for the model.\n     *\n     *     options (object):\n     *         Additional options for the model.\n     *\n     * Option Args:\n     *     integrationConfigURL (string):\n     *         The URL of the integration list page.\n     *\n     *     userConfigURL (string):\n     *         The URL of the user configuration endpoint.\n     *\n     *     workerStatusURL (string):\n     *         The URL of the worker status endpoint.\n     */\n    initialize(attributes, options) {\n        Backbone.Model.prototype.initialize.call(this, attributes, options);\n        this.options = options;\n    },\n});\n\n\n/**\n * A view for configuring the Review Bot user.\n */\nconst UserConfigView = Backbone.View.extend({\n    className: 'rb-c-form-row',\n\n    id: 'reviewbot-user',\n\n    events: {\n        'click #reviewbot-user-create': '_createUser',\n    },\n\n    _templateRB4: _.template(dedent`\n        <div class=\"rb-c-form-field -is-required\">\n         <label class=\"rb-c-form-field__label\" for=\"reviewbot-user-field\"><%- labelText %></label>\n\n         <div class=\"rb-c-form-field__input\">\n          <select class=\"related-object-options reviewbot-user-select\"\n                  name=\"reviewbot_user\"\n                  placeholder=\"<%- selectPlaceholderText %>\"\n                  id=\"reviewbot-user-field\"></select>\n          <span class=\"reviewbot-user-create-details\">\n           <% if (!hasUser) { %><%= orHTML %><% } %>\n          </span>\n          <div class=\"rb-c-form-field__help\"><%- descriptionText %></div>\n         </div>\n        </div>\n    `),\n\n    _templateRB3: _.template(dedent`\n        <div class=\"form-row\">\n         <label class=\"required\" for=\"reviewbot-user-field\"><%- labelText %></label>\n         <select class=\"related-object-options reviewbot-user-select\"\n                 name=\"reviewbot_user\"\n                 placeholder=\"<%- selectPlaceholderText %>\"\n                 id=\"reviewbot-user-field\"></select>\n         <span class=\"reviewbot-user-create-details\">\n          <% if (!hasUser) { %><%= orHTML %><% } %>\n         </span>\n         <p class=\"help\"><%- descriptionText %></p>\n        </div>\n    `),\n\n    _optionTemplate: _.template(dedent`\n        <div>\n        <% if (avatarURL) { %>\n         <img src=\"<%- avatarURL %>\">\n        <% } %>\n        <% if (fullname) { %>\n         <span class=\"title\"><%- fullname %></span>\n         <span class=\"description\">(<%- username %>)</span>\n        <% } else { %>\n         <span class=\"title\"><%- username %></span>\n        <% } %>\n        </div>\n    `),\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     UserConfigView:\n     *     This object, for chaining.\n     */\n    render() {\n        const user = this.model.get('user');\n        const template = RB.Product ? this._templateRB4 : this._templateRB3;\n\n        this.$el.html(template({\n            titleText: gettext('Review Bot User'),\n            labelText: gettext('Review Bot User:'),\n            descriptionText: gettext('Review Bot will use this user account to post reviews.'),\n            selectPlaceholderText: gettext('Select an existing user account'),\n            orHTML: gettext('or <a href=\"#\" id=\"reviewbot-user-create\">create a new user for Review Bot</a>.'),\n            hasUser: (user !== null),\n        }));\n\n        const currentItems = [];\n        const currentOptions = [];\n\n        if (user !== null) {\n            currentItems.push(user.id);\n            currentOptions.push(user);\n        }\n\n        this._$select = this.$('select');\n\n        this._$select.selectize({\n            closeAfterSelect: true,\n            dropdownParent: 'body',\n            hideSelected: true,\n            maxItems: 1,\n            preload: 'focus',\n            items: currentItems,\n            options: currentOptions,\n            searchField: ['fullname', 'username'],\n            valueField: 'id',\n            load: (query, callback) => {\n                const params = {\n                    fullname: 1,\n                    'only-fields': 'avatar_url,fullname,id,username',\n                    'only-links': '',\n                };\n\n                if (query.length !== 0) {\n                    params.q = query;\n                }\n\n                $.ajax({\n                    type: 'GET',\n                    url: SITE_ROOT + 'api/users/',\n                    data: params,\n                    success: result => callback(result.users),\n                    error: (xhr, textStatus, errorThrown) => {\n                        alert('Unexpected error when querying for users: ' +\n                              errorThrown);\n                        console.error('User query failed', xhr, textStatus,\n                                      errorThrown);\n                        callback();\n                    },\n                });\n            },\n            render: {\n                item: item => this._optionTemplate({\n                    avatarURL: item.avatar_url,\n                    id: item.id,\n                    fullname: item.fullname,\n                    username: item.username,\n                }),\n                option: item => this._optionTemplate({\n                    avatarURL: item.avatar_url,\n                    id: item.id,\n                    fullname: item.fullname,\n                    username: item.username,\n                }),\n            },\n        });\n\n        this._selectize = this._$select[0].selectize;\n\n        this.listenTo(this.model, 'change:user', (model, value) => {\n            this._setOption(value);\n        });\n\n        return this;\n    },\n\n    /**\n     * Create a new user.\n     *\n     * Args:\n     *     e (Event):\n     *         The event which triggered the action.\n     */\n    _createUser(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        const $details = this.$('.reviewbot-user-create-details');\n        this._selectize.lock();\n        $details.html('<span class=\"fa fa-spinner fa-pulse\">');\n\n        $.ajax({\n            type: 'POST',\n            url: this.model.options.userConfigURL,\n            complete: () => {\n                this._selectize.unlock();\n                this._selectize.blur();\n                $details.empty();\n            },\n            success: result => {\n                this._setOption(result);\n            },\n            error: (xhr, textStatus, errorThrown) => {\n                alert('Unexpected error when creating the user: ' +\n                      errorThrown);\n                console.error('Failed to update user', xhr, textStatus,\n                              errorThrown);\n            },\n        });\n    },\n\n    /**\n     * Set the currently selected option.\n     *\n     * Args:\n     *     user (object):\n     *          The user details.\n     */\n    _setOption(user) {\n        this._selectize.clear(true);\n        this._selectize.clearOptions();\n        this._selectize.addOption(user);\n        this._selectize.setValue(user.id, true);\n    },\n});\n\n\n/**\n * A view to show the current broker status.\n */\nconst BrokerStatusView = Backbone.View.extend({\n    events: {\n        'click #reviewbot-broker-status-refresh': '_onRefreshClicked',\n    },\n\n    _updatingTemplate: _.template(dedent`\n        <span class=\"fa fa-spinner fa-pulse\"></span>\n        <%- refreshingText %>\n    `),\n\n    _connectedTemplate: _.template(dedent`\n        <div>\n         <span class=\"fa fa-check\"></span>\n         <%- connectedText %>\n        </div>\n        <% if (workers.length === 0) { %>\n         <div>\n          <span class=\"fa fa-exclamation-triangle\"></span>\n          <%- workersText %>\n         </div>\n        <% } else { %>\n         <div>\n          <span class=\"fa fa-check\"></span>\n          <%- workersText %>\n          <ul>\n           <% _.each(workers, function(worker) { %>\n            <li>\n             <span class=\"fa fa-desktop\"></span>\n             <%- worker.hostname %>\n            </li>\n           <% }); %>\n          </ul>\n         </div>\n         <div>\n          <span class=\"fa fa-cogs\"></span>\n          <%- readyText %>\n          <%= configureIntegrationsHTML %>\n         </div>\n        <% } %>\n        <div>\n         <a href=\"#\" id=\"reviewbot-broker-status-refresh\"><%- refreshText %></a>\n        </div>\n    `),\n\n    _errorTemplate: _.template(dedent`\n        <div>\n         <span class=\"fa fa-exclamation-triangle\"></span>\n         <%- errorText %>\n        </div>\n        <div>\n         <a href=\"#\" id=\"reviewbot-broker-status-refresh\"><%- refreshText %></a>\n        </div>\n    `),\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this._updating = false;\n        this._connected = false;\n        this._rendered = false;\n        this._errorText = '';\n        this._workers = [];\n\n        this.listenTo(this.model, 'change', this._update);\n        this._update();\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     BrokerStatusView:\n     *     This object, for chaining.\n     */\n    render() {\n        this._$content = $('<div class=\"form-row\">')\n            .appendTo(this.$el);\n\n        this._rendered = true;\n\n        this._updateDisplay();\n\n        return this;\n    },\n\n    /**\n     * Update the displayed status.\n     */\n    _updateDisplay() {\n        if (!this._rendered) {\n            return;\n        }\n\n        if (this._updating) {\n            this._$content.html(this._updatingTemplate({\n                refreshingText: gettext('Checking broker...'),\n            }));\n        } else if (this._connected) {\n            let workersText;\n\n            if (this._workers.length === 0) {\n                workersText = gettext('No worker nodes found.');\n            } else {\n                workersText = interpolate(\n                    ngettext('%s worker node:',\n                             '%s worker nodes:',\n                             this._workers.length),\n                    [this._workers.length]);\n            }\n\n            this._$content.html(this._connectedTemplate({\n                connectedText: gettext('Connected to broker.'),\n                workersText: workersText,\n                refreshText: gettext('Refresh'),\n                workers: this._workers,\n                readyText: gettext('Review Bot is ready!'),\n                configureIntegrationsHTML: interpolate(\n                    gettext('To configure when Review Bot tools are run, set up <a href=\"%s\">integration configurations</a>.'),\n                    [this.model.options.integrationConfigURL]),\n            }));\n        } else {\n            this._$content.html(this._errorTemplate({\n                errorText: this._errorText,\n                refreshText: gettext('Refresh'),\n            }));\n        }\n    },\n\n    /**\n     * Handler for when the \"Refresh\" link is clicked.\n     *\n     * Args:\n     *     e (Event):\n     *         The event which triggered the action.\n     */\n    _onRefreshClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this._update();\n    },\n\n    /**\n     * Request status from the server and update the UI.\n     */\n    _update() {\n        if (this._updating) {\n            return;\n        }\n\n        this._updating = true;\n        this._updateDisplay();\n\n        $.ajax({\n            type: 'GET',\n            url: this.model.options.workerStatusURL,\n            success: result => {\n                this._workers = result.hosts || [];\n                this._connected = (result.state === 'success');\n                this._errorText = result.error || '';\n                this._updating = false;\n                this._updateDisplay();\n            },\n            error: (xhr, textStatus, errorThrown) => {\n                console.error('Failed to get broker status', xhr, textStatus,\n                              errorThrown);\n                this._errorText = gettext('Unable to connect to broker.');\n                this._workers = [];\n                this._connected = false;\n                this._updating = false;\n                this._updateDisplay();\n            },\n        });\n    },\n});\n\n\n/**\n * A view for configuring the broker URL.\n */\nconst BrokerConfigView = Backbone.View.extend({\n    id: 'reviewbot-broker',\n\n    className: 'rb-c-form-row',\n\n    _templateRB4: _.template(dedent`\n        <div class=\"rb-c-form-field -is-required\">\n         <label class=\"rb-c-form-field__label\" for=\"reviewbot-broker-field\"><%- labelText %></label>\n\n         <div class=\"rb-c-form-field__input\">\n          <input id=\"reviewbot-broker-field\" name=\"reviewbot_broker_url\"\n                 type=\"text\" value=\"<%- brokerURL %>\">\n          <div class=\"rb-c-form-field__help\"><%- descriptionText %></div>\n         </div>\n        </div>\n    `),\n\n    _templateRB3: _.template(dedent`\n        <div class=\"form-row\">\n         <label class=\"required\" for=\"reviewbot-broker-field\"><%- labelText %></label>\n         <input id=\"reviewbot-broker-field\" name=\"reviewbot_broker_url\"\n                type=\"text\" value=\"<%- brokerURL %>\">\n         <p class=\"help\"><%- descriptionText %></p>\n        </div>\n    `),\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     BrokerConfigView:\n     *     This object, for chaining.\n     */\n    render() {\n        const template = RB.Product ? this._templateRB4 : this._templateRB3;\n\n        this.$el.html(template({\n            titleText: gettext('Broker'),\n            labelText: gettext('Broker URL:'),\n            descriptionText: gettext('The URL to your AMQP broker.'),\n            brokerURL: this.model.get('brokerURL'),\n        }));\n\n        return this;\n    }\n});\n\n\n/**\n * A view containing the entire Review Bot extension configuration.\n */\nconst ConfigView = Backbone.View.extend({\n    events: {\n        'click input[type=\"submit\"]': '_onSaveClicked',\n    },\n\n    _templateRB4: dedent`\n        <form class=\"rb-c-form -is-aligned\">\n         <fieldset class=\"rb-c-form-fieldset\">\n          <div class=\"rb-c-form-fieldset__content\">\n           <div class=\"rb-c-form-fieldset__fields\">\n           </div>\n          </div>\n         </fieldset>\n         <div class=\"rb-c-form__actions\">\n          <div class=\"rb-c-form__actions-primary\">\n           <input type=\"submit\" class=\"rb-c-form__action -is-primary\">\n          </div>\n         </div>\n        </form>\n    `,\n\n    _templateRB3: dedent`\n        <form class=\"rb-c-form-fieldset__fields\">\n        </form>\n        <div class=\"submit-row\">\n         <input type=\"submit\" class=\"rb-c-form-action -is-primary default\">\n        </div>\n    `,\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this._userConfigView = new UserConfigView({\n            model: this.model,\n        });\n\n        this._brokerConfigView = new BrokerConfigView({\n            model: this.model,\n        });\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     ConfigView:\n     *     This object, for chaining.\n     */\n    render() {\n        this._userConfigView.render();\n        this._brokerConfigView.render();\n\n        const template = RB.Product ? this._templateRB4 : this._templateRB3;\n        this.$el.html(template);\n\n        this._$form = this.$('form');\n\n        this.$('.rb-c-form-fieldset__fields')\n            .append(this._userConfigView.$el)\n            .append(this._brokerConfigView.$el);\n\n        this._$saveButton = this.$('input[type=\"submit\"]')\n            .val(gettext('Save'));\n\n        return this;\n    },\n\n    /**\n     * Callback for when the \"Save\" button is clicked.\n     *\n     * This saves the form and updates the model.\n     */\n    _onSaveClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this._$saveButton.prop('disabled', true);\n\n        const $spinner = $('<span class=\"fa fa-spinner fa-pulse\">')\n            .insertBefore(this._$saveButton);\n\n        $.ajax({\n            type: 'POST',\n            url: window.location.pathname,\n            data: this._$form.serialize(),\n            complete: () => {\n                this._$saveButton.prop('disabled', false);\n                $spinner.remove();\n            },\n            success: response => {\n                if (response.result === 'success') {\n                    if (response.broker_url) {\n                        this.model.set('brokerURL', response.broker_url);\n                    }\n\n                    if (response.user) {\n                        this.model.set('user', response.user);\n                    }\n                } else if (response.result === 'error') {\n                    console.error('Failed to save Review Bot configuration',\n                                  response);\n                    alert(response.error);\n                } else {\n                    console.error('Unexpected response from server when ' +\n                                  'saving Review Bot configuration.',\n                                  response);\n                }\n            },\n            error: (xhr, textStatus, errorThrown) => {\n                alert('Unexpected error when querying broker: ' +\n                      errorThrown);\n                console.error('Failed to update broker', xhr, textStatus,\n                              errorThrown);\n            },\n        });\n    },\n});\n\n\n/**\n * A view containing the extension config and broker status.\n */\nReviewBot.ExtensionConfigView = Backbone.View.extend({\n    _templateRB4: _.template(dedent`\n        <header class=\"rb-c-content-header -is-main\">\n         <h1 class=\"rb-c-content-header__title\"><%- configureText %></h1>\n        </header>\n        <div class=\"rb-c-page-content-box -is-content-flush\"\n             id=\"reviewbot-extension-config\"></div>\n\n        <header class=\"rb-c-content-header -is-main\">\n         <h1 class=\"rb-c-content-header__title\"><%- brokerText %></h1>\n        </header>\n        <div class=\"rb-c-page-content-box\" id=\"reviewbot-broker-status\"></div>\n    `),\n\n    _templateRB3: _.template(dedent`\n        <h1 class=\"title\"><%- configureText %></h1>\n        <div id=\"content-main\">\n         <fieldset class=\"module aligned\" id=\"reviewbot-extension-config\"></fieldset>\n\n         <fieldset class=\"module aligned\" id=\"reviewbot-broker-status\">\n          <h2><%- brokerText %></h2>\n         </div>\n        </fieldset>\n    `),\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     ReviewBot.ExtensionConfigView:\n     *     This object, for chaining.\n     */\n    render() {\n        const template = RB.Product ? this._templateRB4 : this._templateRB3;\n        this.$el.html(template({\n            configureText: gettext('Configure Review Bot'),\n            brokerText: gettext('Broker Status'),\n        }));\n\n        this._view = new ConfigView({\n            model: this.model,\n            el: this.$('#reviewbot-extension-config')\n        });\n        this._statusView = new BrokerStatusView({\n            model: this.model,\n            el: this.$('#reviewbot-broker-status')\n        });\n\n        this._view.render();\n        this._statusView.render();\n\n        return this;\n    },\n});\n\n\n}\n"],"mappings":"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","ignoreList":[]}