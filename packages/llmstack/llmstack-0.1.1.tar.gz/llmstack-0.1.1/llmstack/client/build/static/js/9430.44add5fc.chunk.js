"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[9430,4122,1504,404],{93653:function(e,n,t){t.d(n,{r:function(){return u}});var i,r=t(7276),a=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},o.apply(this,arguments)}function l(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function s(e,n){var t=e.title,s=e.titleId,u=l(e,a);return r.createElement("svg",o({width:16,height:15,viewBox:"0 0 16 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":s},u),t?r.createElement("title",{id:s},t):null,i||(i=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.90237 0C3.63406 0 0.169922 3.44867 0.169922 7.68606C0.169922 11.0883 2.3814 13.9648 5.45892 14.9855C5.84554 15.0628 5.98473 14.8154 5.98473 14.6143C5.98473 14.4288 5.98473 13.9493 5.96926 13.2998C3.81964 13.7638 3.37116 12.2637 3.37116 12.2637C3.01546 11.3822 2.50512 11.1347 2.50512 11.1347C1.8092 10.6553 2.55152 10.6708 2.55152 10.6708C3.32476 10.7326 3.74231 11.4595 3.74231 11.4595C4.43824 12.6348 5.55171 12.2946 6.00019 12.0936C6.07752 11.5987 6.26309 11.2584 6.49507 11.0729C4.77846 10.8718 2.96907 10.2223 2.96907 7.2685C2.96907 6.4334 3.2629 5.73748 3.75778 5.21167C3.68045 5.01063 3.41755 4.23738 3.8351 3.17031C3.8351 3.17031 4.48463 2.96926 5.9538 3.95902C6.57239 3.7889 7.23738 3.69611 7.88691 3.69611C8.53644 3.69611 9.20143 3.7889 9.82002 3.95902C11.2892 2.96926 11.9387 3.17031 11.9387 3.17031C12.3563 4.22192 12.0934 5.01063 12.016 5.21167C12.5109 5.75294 12.8047 6.4334 12.8047 7.2685C12.8047 10.2223 10.9954 10.8718 9.27875 11.0574C9.55712 11.2894 9.80456 11.7688 9.80456 12.4802C9.80456 13.5009 9.78909 14.336 9.78909 14.5834C9.78909 14.7844 9.92828 15.0319 10.3149 14.9546C13.4233 13.9648 15.6348 11.0883 15.6348 7.68606C15.6348 3.44867 12.1707 0 7.90237 0Z",fill:"#383838"})))}var u=r.forwardRef(s);t.p},41504:function(e,n,t){t.r(n);var i=t(45987),r=t(29439),a=t(1413),o=t(16390),l=t(60103),s=t(54730),u=t(32399),c=t(68134),d=t(92628),f=t(97519),x=t(73462),h=t(49305),p=t(25861),v=t(52720),Z=t(66161),m=t(85535),j=t(76399),y=t(22644),g=t(62652),b=t(7276),C=t(45263),S=["schema","uiSchema","formData","onChange","submitBtn","theme","validator","templates","widgets","disableAdvanced"],_=(0,b.lazy)((function(){return Promise.all([t.e(9907),t.e(2580),t.e(6783)]).then(t.bind(t,62580))})),w=(0,b.lazy)((function(){return t.e(1393).then(t.bind(t,63890))})),k=(0,b.lazy)((function(){return t.e(935).then(t.bind(t,80935))})),D=(0,b.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(5539),t.e(111),t.e(4880),t.e(686),t.e(6374)]).then(t.bind(t,16374))})),E=(0,b.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(111),t.e(3667),t.e(6279),t.e(7458)]).then(t.bind(t,96279))})),O=(0,b.lazy)((function(){return Promise.all([t.e(7420),t.e(2341)]).then(t.bind(t,16214))})),P=(0,b.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(5539),t.e(111),t.e(4880),t.e(686),t.e(5831)]).then(t.bind(t,75831))})),T=(0,b.lazy)((function(){return t.e(8781).then(t.bind(t,68781))})),A=(0,b.lazy)((function(){return t.e(6317).then(t.bind(t,6317))})),z=(0,b.lazy)((function(){return t.e(4843).then(t.bind(t,64843))})),R=(0,b.lazy)((function(){return Promise.all([t.e(2789),t.e(111),t.e(2384)]).then(t.bind(t,12384))})),N=(0,b.lazy)((function(){return t.e(7437).then(t.bind(t,97437))})),I=(0,b.lazy)((function(){return Promise.all([t.e(7902),t.e(7533)]).then(t.bind(t,57533))}));function L(e){return(0,C.jsx)(P,(0,a.Z)({},e))}function F(e){return(0,C.jsx)(A,(0,a.Z)({},e))}function M(e){var n=e.id,t=e.children,i=e.classNames,a=e.style,o=e.disabled,u=e.displayLabel,c=e.hidden,d=e.label,f=e.onDropPropertyClick,x=e.onKeyChange,h=e.readonly,p=e.required,v=e.rawErrors,Z=void 0===v?[]:v,m=e.errors,j=e.help,y=e.rawDescription,S=e.schema,_=e.uiSchema,w=e.registry,k=(0,b.useState)(!1),D=(0,r.Z)(k,2),E=D[0],O=D[1],P=(0,g.LI)(_),T=(0,g.t4)("WrapIfAdditionalTemplate",w,P);return c?(0,C.jsx)("div",{style:{display:"none"},children:t}):(0,C.jsx)(T,{classNames:i,style:a,disabled:o,id:n,label:d,onDropPropertyClick:f,onKeyChange:x,readonly:h,required:p,schema:S,uiSchema:_,registry:w,children:(0,C.jsxs)(l.Z,{fullWidth:!0,error:!!Z.length,required:p,onFocus:function(e){O(!0)},onBlur:function(e){O(!1)},children:[t,u&&y?(0,C.jsx)(s.Z,{id:n,focused:E,children:y}):null,m,j]})})}function W(e){var n=e.options,t=e.registry,i=(0,g.t4)("BaseInputTemplate",t,n),r=5;return"string"!==typeof n.rows&&"number"!==typeof n.rows||(r=n.rows),(0,C.jsx)(i,(0,a.Z)((0,a.Z)({sx:{"& .MuiOutlinedInput-root":{"& > fieldset":{border:"1px solid rgb(204, 204, 204)"}}}},e),{},{multiline:!0,rows:r,variant:"outlined"}))}function B(e){return(0,C.jsx)(R,(0,a.Z)({},e))}function U(e){return(0,C.jsx)(O,(0,a.Z)({},e))}function J(e){var n=e.chat_message;if(n.content)return(0,C.jsx)(u.Z,{primary:n.content});if(n.function_call){var t=n.function_call.name,i=JSON.parse(n.function_call.arguments),r=Object.keys(i).map((function(e){return"".concat(e,'="').concat(i[e],'"')})).join(",");return(0,C.jsx)("div",{children:(0,C.jsx)(u.Z,{primary:"Function",secondary:"".concat(t,"(").concat(r,")")})})}return null}var V=function(e){var n=e.value||[],t=0;return"string"===typeof n&&(n=[{content:n}]),(0,C.jsx)(c.Z,{className:"output-chat",style:{paddingTop:0},children:n.map((function(e){return(0,C.jsxs)(d.ZP,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",background:"rgb(255, 250, 236)",border:"1px solid rgb(235, 230, 236)",borderRadius:10},children:[(0,C.jsx)(f.Z,{children:(0,C.jsx)(x.Z,{color:"primary",label:e.role||"System"})}),(0,C.jsx)(J,{chat_message:e})]},t++)}))})},G=function(e){var n=e.value||[],t=0;return(0,C.jsx)(c.Z,{className:"output-text",style:{paddingTop:0},children:n.map((function(e){return(0,C.jsx)(d.ZP,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",background:"rgb(255, 250, 236)",border:"1px solid rgb(235, 230, 236)",borderRadius:10},children:(0,C.jsx)(u.Z,{primary:e})},t++)}))})},H=function(e){var n=0;return(0,C.jsx)(h.Z,{className:"output-image",cols:2,gap:8,children:e.value.map((function(e){return(0,C.jsx)(p.Z,{children:(0,C.jsx)("img",{src:"".concat(e),loading:"lazy",alt:""})},n++)}))})},K=function(e){return(0,C.jsx)("audio",{src:e.value,controls:!0})},Y=function(e){return(0,C.jsx)(k,(0,a.Z)((0,a.Z)({},e),{},{disableAdvanced:!1}))},q=function(e){return(0,C.jsx)(k,(0,a.Z)((0,a.Z)({},e),{},{disableAdvanced:!0}))},X=function(e){return(0,C.jsx)(T,(0,a.Z)({},e))},Q=function(e){return(0,C.jsx)(D,(0,a.Z)({},e))},$=function(e){return(0,C.jsx)(_,(0,a.Z)((0,a.Z)({},e),{},{richText:!0}))},ee=function(e){return(0,C.jsx)(E,(0,a.Z)({},e))},ne=function(e){return(0,C.jsx)(w,(0,a.Z)({},e))},te=function(e){var n=e.errors;return(0,C.jsx)(v.Z,{elevation:2,children:(0,C.jsxs)(Z.Z,{mb:2,p:2,children:[(0,C.jsx)(m.Z,{variant:"h6",children:"Errors"}),(0,C.jsx)(c.Z,{dense:!0,children:n.map((function(e,n){return(0,C.jsxs)(d.ZP,{dense:!0,children:[(0,C.jsx)(j.Z,{children:(0,C.jsx)(o.Z,{color:"error"})}),(0,C.jsx)(u.Z,{primary:e.message})]},n)}))})]})})};n.default=function(e){var n=e.schema,t=e.uiSchema,r=e.formData,o=e.onChange,l=e.submitBtn,s=void 0===l?(0,C.jsx)("div",{}):l,u=(e.theme,e.validator),c=e.templates,d=void 0===c?{}:c,f=e.widgets,x=void 0===f?{}:f,h=e.disableAdvanced,p=void 0!==h&&h,v=(0,i.Z)(e,S),Z=v.createAsset;(0,b.useEffect)((function(){var e,n,t;null!==(e=v.formRef)&&void 0!==e&&null!==(n=e.current)&&void 0!==n&&null!==(t=n.formElement)&&void 0!==t&&t.current&&v.formRef.current.formElement.current.addEventListener("submit",(function(e){e.preventDefault()}))}),[v.formRef]);var m=(0,b.useCallback)((function(e){var n;return null!==e&&void 0!==e&&null!==(n=e.schema)&&void 0!==n&&n.stream?(0,C.jsx)(I,(0,a.Z)((0,a.Z)({},e),{},{createAsset:Z,formRef:v.formRef})):(0,C.jsx)(z,(0,a.Z)({},e))}),[Z,v.formRef]);return(0,C.jsx)(y.ZP,(0,a.Z)((0,a.Z)({ref:v.formRef},v),{},{schema:n,uiSchema:t,validator:u,formData:r,onChange:o,templates:(0,a.Z)({ErrorListTemplate:te,FieldTemplate:M,ObjectFieldTemplate:p?q:Y},d),fields:{multi:function(e){return(0,C.jsx)(N,(0,a.Z)((0,a.Z)({},e),{},{formRef:v.formRef,onCancel:v.onCancel}))}},widgets:(0,a.Z)((0,a.Z)({},{customselect:B,TextareaWidget:W,FileWidget:U,output_chat:V,output_text:G,output_image:H,output_audio:K,datasource:ee,gdrive:L,webpageurls:F,password:X,connection:Q,richtext:$,voice:m,app_version:ne}),x),transformErrors:null===v||void 0===v?void 0:v.transformErrors,children:s}))}},84811:function(e,n,t){t.d(n,{P:function(){return C}});var i=t(93433),r=t(1413),a=t(29439),o=t(54560),l=t(969),s=t(46650),u=t(7458),c=t(44390),d=t(42470),f=t(31342),x=t(34160),h=t(13366),p=t(83960),v=t(7276),Z=t(9229),m=t(25926),j=t(84817),y=t(46573),g=t(41504),b=t(45263);function C(e){var n=e.open,t=e.handleCancelCb,C=e.dataSourceAddedCb,S=e.modalTitle,_=void 0===S?"Add New Data Source":S,w=e.datasource,k=void 0===w?null:w,D=(0,Z.sJ)(m.TF),E=(0,v.useState)(null!==k&&void 0!==k&&k.name?k.name:""),O=(0,a.Z)(E,2),P=O[0],T=O[1],A=(0,v.useState)(!1),z=(0,a.Z)(A,2),R=z[0],N=z[1],I=(0,Z.FV)(m.NM),L=(0,a.Z)(I,2),F=L[0],M=L[1],W=(0,v.useState)(null!==k&&void 0!==k&&k.type?k.type:null===D||void 0===D?void 0:D[0]),B=(0,a.Z)(W,2),U=B[0],J=B[1],V=(0,v.useState)({}),G=(0,a.Z)(V,2),H=G[0],K=G[1],Y=(0,y.lD)();return(0,b.jsxs)(o.Z,{open:n,onClose:t,sx:{zIndex:900},children:[(0,b.jsx)(l.Z,{children:_}),(0,b.jsx)(s.Z,{children:(0,b.jsxs)(u.Z,{spacing:2,children:[(0,b.jsx)(c.Z,{label:"Data Source Name",value:P,onChange:function(e){return T(e.target.value)},disabled:!!k,required:!0,defaultValue:(null===k||void 0===k?void 0:k.name)||"Untitled",size:"small",style:{width:"100%",marginTop:"6px"},error:R}),(0,b.jsx)("span",{children:"Data Source Type"}),(0,b.jsx)(d.Z,{variant:"outlined",size:"small",style:{display:"inline-block"},disabled:!!k,children:D.map((function(e){return(0,b.jsx)(f.Z,{variant:(null===U||void 0===U?void 0:U.id)===e.id?"contained":"outlined",onClick:function(n){J(e)},children:e.name},e.id)}))}),(0,b.jsx)(g.default,{schema:(null===U||void 0===U?void 0:U.entry_config_schema)||{},validator:h.ZP,uiSchema:(0,r.Z)((0,r.Z)({},(null===U||void 0===U?void 0:U.entry_config_ui_schema)||{}),{"ui:submitButtonOptions":{norender:!0},"ui:DescriptionFieldTemplate":function(){return null},"ui:TitleFieldTemplate":function(){return null}}),formData:H,onChange:function(e){var n=e.formData;K(n)},disableAdvanced:!0})]})}),(0,b.jsxs)(x.Z,{children:[(0,b.jsx)(f.Z,{onClick:t,children:"Cancel"}),",",(0,b.jsx)(f.Z,{variant:"contained",onClick:function(){if(k)(0,j.o)().post("/api/datasources/".concat(k.uuid,"/add_entry_async"),{entry_data:H}).then((function(){Y(),(0,p.yv)("Processing Data, please refresh the page in a few minutes",{variant:"success"})})).catch((function(e){var n;(0,p.yv)("Failed to add entry. ".concat(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data),{variant:"error"})})).finally((function(){t()}));else{if(""===P)return void N(!0);(0,j.o)().post("/api/datasources",{name:P,type:U.id,config:U.is_external_datasource?H:{}}).then((function(e){if(!U.is_external_datasource){var n=e.data;M([].concat((0,i.Z)(F),[n])),(0,j.o)().post("/api/datasources/".concat(n.uuid,"/add_entry_async"),{entry_data:H}).then((function(e){C(n)}))}})),t(),(0,p.yv)("Processing Data, please refresh the page in a few minutes",{variant:"success"})}},children:"Submit"})]})]})}},59430:function(e,n,t){t.r(n);var i=t(1413),r=t(29439),a=t(95173),o=t(79921),l=t(7276),s=t(7458),u=t(82048),c=t(18221),d=t(5055),f=t(66161),x=t(94053),h=t(10981),p=t(35856),v=t(31342),Z=t(54560),m=t(969),j=t(46650),y=t(44390),g=t(34160),b=t(63716),C=t(13366),S=t(25926),_=t(9229),w=t(93653),k=t(34122),D=t(41504),E=t(84817),O=t(45263),P={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GA_MEASUREMENT_ID:"G-XZ40100Y5C"}.REACT_APP_SITE_NAME||"LLMStack";n.default=function(e){e.headless;var n,t,T=(0,a.UO)(),A=T.datasourceId,z=T.embed,R=(0,l.useState)(!1),N=(0,r.Z)(R,2),I=N[0],L=N[1],F=(0,_.sJ)((0,S.dW)(A)),M=function(e){var n=(0,_.Zl)((0,S.Pe)(e));return function(){(0,E.o)().get("/api/datasources/".concat(e,"/entries")).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}}(A),W=function(e){var n=(0,_.Zl)((0,S.dW)(e));return function(){(0,E.o)().get("/api/datasources/".concat(e)).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}}(A),B=(0,_.sJ)((0,S.Pe)(A)),U=(0,l.useState)({}),J=(0,r.Z)(U,2),V=J[0],G=J[1],H=(0,l.useState)(!1),K=(0,r.Z)(H,2),Y=K[0],q=K[1];return(0,l.useEffect)((function(){o.ZP.initialize("G-XZ40100Y5C",{gaOptions:{cookieFlags:"SameSite=None;Secure"}}),o.ZP.send({hitType:"pageview",page:window.location.href,title:document.title})})),(0,O.jsxs)(s.Z,{container:!0,spacing:2,children:[!z&&(0,O.jsx)(u.Z,{position:"static",sx:{backgroundColor:"#fff",color:"#000"},children:(0,O.jsx)(c.Z,{maxWidth:"xl",children:(0,O.jsxs)(d.Z,{disableGutters:!0,sx:{width:"100%",margin:"0 auto"},children:[(0,O.jsx)(f.Z,{sx:{flexGrow:1}}),"LLMStack"===P&&(0,O.jsx)(x.Z,{component:w.r,sx:{width:"54px",height:"54px"},viewBox:"-10 -4 28 26",onClick:function(){window.location.href="https://github.com/trypromptly/llmstack"}})]})})}),(0,O.jsxs)(h.Z,{children:[(0,O.jsx)(p.Z,{title:(0,O.jsx)(v.Z,{size:"small",variant:"contained",onClick:function(e){L(!0)},children:"Add Data"})}),(0,O.jsx)(k.DataSourceEntries,{dataSourceEntryData:B,onDatasourceEntryDelete:function(){M(),W()}})]}),I&&(0,O.jsxs)(Z.Z,{open:I,onClose:function(){},sx:{zIndex:900},children:[(0,O.jsx)(m.Z,{children:"Add Data"}),(0,O.jsx)(j.Z,{children:(0,O.jsxs)(s.Z,{spacing:2,children:[(0,O.jsx)(y.Z,{label:"Data Source Name",disabled:!0,defaultValue:(null===F||void 0===F?void 0:F.name)||"Untitled",size:"small",style:{width:"100%",marginTop:"6px"}}),(0,O.jsx)(D.default,{schema:(null===F||void 0===F||null===(n=F.type)||void 0===n?void 0:n.entry_config_schema)||{},validator:C.ZP,uiSchema:(0,i.Z)((0,i.Z)({},(null===F||void 0===F||null===(t=F.type)||void 0===t?void 0:t.entry_config_ui_schema)||{}),{"ui:submitButtonOptions":{norender:!0},"ui:DescriptionFieldTemplate":function(){return null},"ui:TitleFieldTemplate":function(){return null}}),formData:V,onChange:function(e){var n=e.formData;G(n)},disableAdvanced:!0})]})}),(0,O.jsxs)(g.Z,{children:[(0,O.jsx)(v.Z,{onClick:function(){L(!1)},children:"Cancel"}),",",(0,O.jsx)(b.Z,{loading:Y,disabled:Y,variant:"contained",onClick:function(){F&&(q(!0),(0,E.o)().post("/api/datasources/".concat(F.uuid,"/add_entry_async"),{entry_data:V}).then((function(e){setTimeout((function(){M(),W(),L(!1)}),2e3)})).catch((function(e){})))},children:"Submit"})]})]})]})}},34122:function(e,n,t){t.r(n),t.d(n,{DataSourceEntries:function(){return oe},default:function(){return le}});var i=t(1413),r=t(93433),a=t(29439),o=t(15411),l=t(21008),s=t(31982),u=t(51073),c=t(79288),d=t(23109),f=t(2146),x=t(45880),h=t(24528),p=t(43630),v=t(73462),Z=t(66161),m=t(20495),j=t(44570),y=t(18221),g=t(10567),b=t(78735),C=t(20888),S=t(34867),_=t(9340),w=t(62154),k=t(71516),D=t(85535),E=t(65173),O=t(31342),P=t(29166),T=t(24578),A=t(8568),z=t(4550),R=t.n(z),N=t(83960),I=t(7276),L=t(9229),F=t(84811),M=t(95142),W=t(6188),B=t(7458),U=t(6334),J=t(84817),V=t(45263);var G=function(e){var n=e.onCancel,t=e.dataSourceEntry,i=e.open,r=(0,I.useState)(null),o=(0,a.Z)(r,2),l=o[0],s=o[1],u=(0,I.useState)(null),c=(0,a.Z)(u,2),d=c[0],f=c[1],x=(0,I.useState)(!1),h=(0,a.Z)(x,2),p=h[0],m=h[1];return(0,I.useEffect)((function(){var e,n;null!==t&&void 0!==t&&null!==(e=t.config)&&void 0!==e&&e.document_ids?(0,J.o)().get("/api/datasource_entries/".concat(t.uuid,"/text_content")).then((function(e){var n,t;s((0,V.jsx)(M.u,{value:null===(n=e.data)||void 0===n?void 0:n.content,disabled:!0,autoSize:!0,style:{maxHeight:"80vh",width:"100%",overflow:"auto"}})),f(null===(t=e.data)||void 0===t?void 0:t.metadata)})).finally((function(){return m(!1)})):s((0,V.jsx)(M.u,{value:JSON.stringify(null===t||void 0===t||null===(n=t.config)||void 0===n?void 0:n.errors),disabled:!0,autoSize:!0,style:{maxHeight:"80vh",width:"100%",overflow:"auto"}}))}),[t]),(0,V.jsx)(W.ZP,{open:i,onClose:n,anchor:"right",sx:{"& .MuiDrawer-paper":{minWidth:"40%"},maxWidth:"40%"},children:(0,V.jsxs)(Z.Z,{children:[(0,V.jsxs)(B.Z,{direction:"row",gap:1,sx:{mb:"10px",mt:"10px"},children:[(0,V.jsx)(O.Z,{onClick:function(){return n()},sx:{alignSelf:"left"},children:"X"}),Object.keys(d||{}).map((function(e){return(0,V.jsx)(v.Z,{label:"".concat(e,": ").concat(d[e]),size:"small",sx:{borderRadius:"10px",marginTop:"5px"}},e)}))]}),(0,V.jsx)(U.Z,{}),p?(0,V.jsx)(T.Z,{}):(0,V.jsx)("div",{style:{margin:"0px 10px"},children:l})]})})},H=t(54560),K=t(969),Y=t(46650),q=t(26235),X=t(49321),Q=t(34160);function $(e){var n=e.id,t=e.open,i=e.onOk,r=e.onCancel,o=e.title,l=e.dataSource,s=I.useState(null===l||void 0===l?void 0:l.visibility),u=(0,a.Z)(s,2),c=u[0],d=u[1];return(0,V.jsxs)(H.Z,{open:t,onClose:function(){return r(n)},"aria-labelledby":"share-datasource-dialog-title","aria-describedby":"share-datasource-dialog-description",children:[(0,V.jsx)(K.Z,{id:"share-datasource-dialog-title",children:o}),(0,V.jsx)(Y.Z,{style:{minWidth:"500px"},children:(0,V.jsxs)(B.Z,{spacing:2,children:[(0,V.jsx)("h4",{children:"Choose who can access this datasource"}),(0,V.jsx)(q.Z,{labelId:"share-datasource-select-label",size:"small",defaultValue:void 0===(null===l||void 0===l?void 0:l.visibility)?1:null===l||void 0===l?void 0:l.visibility,onChange:function(e){d(e.target.value)},children:[{value:1,label:"Organization",description:"Members of your organization can access this datasource"},{value:0,label:"You",description:"Only you can access this datasource"}].map((function(e){return(0,V.jsx)(X.Z,{value:e.value,children:(0,V.jsxs)(B.Z,{direction:"row",spacing:1,children:[(0,V.jsx)("span",{children:e.label}),(0,V.jsx)("small",{children:e.description})]})},e.value)}))})]})}),(0,V.jsxs)(Q.Z,{children:[(0,V.jsx)(O.Z,{onClick:function(){return r(n)},children:"Cancel"}),(0,V.jsx)(O.Z,{variant:"contained",onClick:function(){return function(){var e="noop";c!==l.visibility?0===l.visibility&&1===c?(0,J.o)().post("api/org/datasources/".concat(l.uuid,"/add_entry")).then((function(n){i(e,l)})):1===l.visibility&&0===c?(0,J.o)().delete("api/org/datasources/".concat(l.uuid)).then((function(n){i(e,l)})):i(e,l):i(e,l)}()},children:"Done"})]})]})}var ee=t(12283);function ne(e){var n=e.id,t=e.open,i=e.onOk,r=e.onCancel,a=e.title,o=e.text;return(0,V.jsxs)(H.Z,{title:a||"Logged Out",open:t,onCancel:r,children:[(0,V.jsx)(K.Z,{id:"delete-modal-title",children:"Confirm Delete"}),(0,V.jsx)(Y.Z,{children:(0,V.jsx)(ee.Z,{children:o})}),(0,V.jsxs)(Q.Z,{children:[(0,V.jsx)(O.Z,{onClick:function(){return r(n)},children:"Cancel"},"cancel"),",",(0,V.jsx)(O.Z,{variant:"contained",type:"primary",onClick:function(){return i(n)},children:"Confirm"},"submit"),","]})]})}function te(e){var n=new Date(e.value);return(0,V.jsx)("span",{children:n.toLocaleString()})}function ie(e){for(var n=e.value,t=["","K","M","G","T","P","E","Z","Y"],i=0;n>=1024;)n/=1024,i+=1;return(0,V.jsx)("span",{children:n>0?n.toFixed(2)+" "+t[i]:n+" "+t[i]})}var re=t(25926),ae=t(46573);function oe(e){var n=e.dataSourceEntryData,t=e.onDatasourceEntryDelete,i=void 0===t?function(){}:t,u=(0,I.useState)(!1),c=(0,a.Z)(u,2),d=c[0],f=c[1],x=(0,I.useState)(null),h=(0,a.Z)(x,2),p=h[0],D=h[1],E=(0,I.useState)(!1),O=(0,a.Z)(E,2),P=O[0],T=O[1],A=(0,I.useState)(new Set),z=(0,a.Z)(A,2),L=z[0],F=z[1],M=(0,ae.lD)(),W=[{title:"Name",key:"name"},{title:"Size",key:"size",render:function(e){return(0,V.jsx)(ie,{value:e})}},{title:"Status",key:"status",render:function(e,n){var t="success";return t="FAILED"===e?"error":"READY"===e?"success":"info",(0,V.jsx)(v.Z,{color:t,style:{cursor:"pointer"},label:n.status.charAt(0)+n.status.slice(1).toLowerCase(),size:"small"},n.uuid)}},{title:"Created At",key:"created_at",render:function(e){return(0,V.jsx)(te,{value:e})}},{title:"Last Modified",key:"updated_at",render:function(e){return R()(e).fromNow()}},{title:"Action",key:"operation",render:function(e,n){var t,i,a,u,c,d,x,h,p=("READY"===(null===n||void 0===n?void 0:n.status)||"ERROR"===(null===n||void 0===n?void 0:n.status))&&("file"===(null===n||void 0===n||null===(t=n.datasource)||void 0===t||null===(i=t.type)||void 0===i?void 0:i.name.toLowerCase())||"pdf"===(null===n||void 0===n||null===(a=n.datasource)||void 0===a||null===(u=a.type)||void 0===u?void 0:u.name.toLowerCase())||"url"===(null===n||void 0===n||null===(c=n.datasource)||void 0===c||null===(d=c.type)||void 0===d?void 0:d.name.toLowerCase())||"gdrive_file"===(null===n||void 0===n||null===(x=n.datasource)||void 0===x||null===(h=x.type)||void 0===h?void 0:h.name.toLowerCase()));return(0,V.jsxs)(Z.Z,{children:[(0,V.jsx)(m.Z,{title:"View contents",children:(0,V.jsx)(j.Z,{onClick:function(){f(!0),D(n)},disabled:L.has(n.uuid),children:(0,V.jsx)(o.Z,{})})}),p&&(0,V.jsx)(m.Z,{title:"Resync contents",children:(0,V.jsx)(j.Z,{onClick:function(){(0,N.yv)("Resyncing data source entry",{variant:"success"}),F((function(e){return new Set([].concat((0,r.Z)(e),[n.uuid]))})),(0,J.o)().post("/api/datasource_entries/".concat(n.uuid,"/resync")).then((function(e){M()})).catch((function(e){(0,N.yv)("Failed to resync data source entry",{variant:"error"})})).finally((function(){F((function(e){return new Set((0,r.Z)(e).filter((function(e){return e!==n.uuid})))}))}))},children:(0,V.jsx)(l.Z,{})})}),(0,V.jsx)(m.Z,{title:"Delete entry",children:(0,V.jsx)(j.Z,{onClick:function(){D(n),T(!0)},children:(0,V.jsx)(s.Z,{})})})]})}}];return 0===n.length?(0,V.jsx)(y.Z,{children:(0,V.jsxs)(g.Z,{severity:"info",sx:{maxWidth:"300px",margin:"0 auto"},children:[(0,V.jsx)(b.Z,{children:"No entries found"}),"Click on the ",(0,V.jsx)("strong",{children:"+"})," icon to add a new entry."]})}):(0,V.jsxs)(C.Z,{stickyHeader:!0,"aria-label":"sticky table contents",colSpan:7,children:[(0,V.jsx)(S.Z,{children:(0,V.jsx)(_.Z,{children:W.map((function(e){return(0,V.jsx)(w.Z,{sx:{padding:"5px 16px"},children:(0,V.jsx)("strong",{children:e.title})},e.key)}))})}),(0,V.jsx)(k.Z,{sx:{borderBottom:"none"},children:null===n||void 0===n?void 0:n.map((function(e,n){return(0,V.jsx)(_.Z,{role:"checkbox",tabIndex:-1,children:W.map((function(n){var t=e[n.key];return(0,V.jsx)(w.Z,{sx:{padding:"0 16px"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid)}))}),(0,V.jsx)(G,{onCancel:function(){return f(!1)},dataSourceEntry:p,open:d}),(0,V.jsx)(ne,{id:p,title:"Delete Data Source Entry",text:(0,V.jsxs)("div",{children:["Are you sure you want to delete"," ",(0,V.jsx)("span",{style:{fontWeight:"bold"},children:null===p||void 0===p?void 0:p.name})," ","?"]}),open:P,onOk:function(e){(0,J.o)().delete("/api/datasource_entries/".concat(e.uuid)).then((function(e){i(),M(),T(!1)}))},onCancel:function(){T(!1)}})]})}function le(){var e=(0,I.useState)(1),n=(0,a.Z)(e,2),t=n[0],o=n[1],l=(0,I.useState)(""),v=(0,a.Z)(l,2),y=v[0],g=v[1],b=(0,I.useState)(""),z=(0,a.Z)(b,2),N=z[0],M=z[1],W=(0,I.useState)(null),B=(0,a.Z)(W,2),U=B[0],G=B[1],H=(0,I.useState)(!1),K=(0,a.Z)(H,2),Y=K[0],q=K[1],X=(0,I.useState)(!1),Q=(0,a.Z)(X,2),ee=Q[0],le=Q[1],se=(0,I.useState)(!1),ue=(0,a.Z)(se,2),ce=ue[0],de=ue[1],fe=(0,L.sJ)(re.ye),xe=(0,L.FV)(re.MC),he=(0,a.Z)(xe,2),pe=he[0],ve=he[1],Ze=(0,L.FV)(re.DK),me=(0,a.Z)(Ze,2),je=me[0],ye=me[1],ge=(0,I.useState)(null),be=(0,a.Z)(ge,2),Ce=be[0],Se=be[1],_e=(0,I.useState)([]),we=(0,a.Z)(_e,2),ke=we[0],De=we[1],Ee=(0,I.useState)("Add New Data Source"),Oe=(0,a.Z)(Ee,2),Pe=Oe[0],Te=Oe[1],Ae=(0,I.useState)(null),ze=(0,a.Z)(Ae,2),Re=ze[0],Ne=ze[1],Ie=(0,I.useState)(null),Le=(0,a.Z)(Ie,2),Fe=Le[0],Me=Le[1],We=(0,ae.lD)(),Be=(0,ae.B6)(),Ue=(0,L.sJ)(re.Jn);(0,I.useEffect)((function(){fe.length>0&&De((function(e){return fe.map((function(n){var t;return(0,i.Z)((0,i.Z)({},n),{},{expand:(null===(t=e.find((function(e){return e.uuid===n.uuid})))||void 0===t?void 0:t.expand)||!1})}))}))}),[fe]);var Je=[{title:"Name",key:"name",render:function(e,n){return(0,V.jsxs)(D.Z,{sx:{display:"flex",fontSize:"0.9rem",fontWeight:n.expand?"600":"inherit",gap:1},children:[n.expand?(0,V.jsx)(u.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}):(0,V.jsx)(c.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}),e]})}},{title:"Owner",key:"owner_email",render:function(e,n){return(0,V.jsx)("span",{children:n.isUserOwned?"me":n.owner_email})}},{title:"Data Source Type",key:"type",render:function(e){return(0,V.jsx)("span",{children:e.name})}},{title:"Size",key:"size",render:function(e){return(0,V.jsx)(ie,{value:e})}},{title:"Created At",key:"created_at",render:function(e){return(0,V.jsx)(te,{value:e})}},{title:"Last Modified",key:"updated_at",render:function(e){return R()(e).fromNow()}},{title:"Action",key:"operation",render:function(e,n){var t,i,r;return(0,V.jsxs)(Z.Z,{children:[(null===n||void 0===n||null===(t=n.type)||void 0===t?void 0:t.is_external_datasource)&&(0,V.jsx)(m.Z,{title:"Edit entry",children:(0,V.jsx)(j.Z,{disabled:!0,onClick:function(e){Te("Edit Data Source"),q(!0),Ne(n),e.stopPropagation()},children:(0,V.jsx)(d.Z,{})})}),!(null!==n&&void 0!==n&&null!==(i=n.type)&&void 0!==i&&i.is_external_datasource)&&(0,V.jsx)(j.Z,{disabled:!n.isUserOwned,onClick:function(e){Te("Add New Data Entry"),Ne(n),q(!0),e.stopPropagation()},children:(0,V.jsx)(f.Z,{})}),(null===n||void 0===n||null===(r=n.type)||void 0===r?void 0:r.is_external_datasource)&&(0,V.jsx)(m.Z,{title:"External Connection",children:(0,V.jsx)("span",{children:(0,V.jsx)(j.Z,{disabled:!0,children:(0,V.jsx)(x.Z,{})})})}),(0,V.jsx)(j.Z,{disabled:!n.isUserOwned,onClick:function(){G(n),g("Delete Data Source"),M((0,V.jsxs)("div",{children:["Are you sure you want to delete"," ",(0,V.jsx)("span",{style:{fontWeight:"bold"},children:n.name})," ?"]})),le(!0)},children:(0,V.jsx)(s.Z,{})}),Ue.IS_ORGANIZATION_MEMBER&&n.isUserOwned&&(0,V.jsx)(j.Z,{onClick:function(){Te("Share Datasource"),Ne(n),de(!0)},children:0===n.visibility?(0,V.jsx)(h.Z,{}):(0,V.jsx)(p.Z,{})})]})}}];return(0,V.jsxs)("div",{id:"data-page",style:{marginBottom:"120px"},children:[(0,V.jsxs)(E.ZP,{span:24,style:{padding:"10px"},children:[(0,V.jsx)(E.ZP,{item:!0,style:{width:"100%",padding:"15px 0px"},children:(0,V.jsx)(O.Z,{onClick:function(){q(!0)},type:"primary",variant:"contained",sx:{float:"left",marginBottom:"10px",textTransform:"none"},children:"Add Data Source"})}),(0,V.jsxs)(E.ZP,{item:!0,style:{width:"100%"},children:[(0,V.jsxs)(C.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,V.jsx)(S.Z,{children:(0,V.jsx)(_.Z,{children:Je.map((function(e){return(0,V.jsx)(w.Z,{sx:{paddingLeft:"name"===e.key?"40px":"inherit"},children:(0,V.jsx)("strong",{children:e.title})},e.key)}))})}),(0,V.jsx)(k.Z,{children:ke.slice(10*(t-1),10*t).map((function(e,n){return[[(0,V.jsx)(_.Z,{hover:!0,sx:{cursor:"pointer",backgroundColor:e.expand?"#f5f5f5":"inherit"},onClick:function(){!function(e){De(ke.map((function(n){return n.uuid===e.uuid&&(n.expand=!n.expand),n}))),Se(!0),Me(e.uuid);var n="/api/datasources/".concat(e.uuid,"/entries");e.isUserOwned||(n="/api/org/datasources/".concat(e.uuid,"/entries")),(0,J.o)().get(n).then((function(n){e.isUserOwned?ve([].concat((0,r.Z)(pe.filter((function(n){return n.datasource.uuid!==e.uuid}))),(0,r.Z)(n.data))):ye([].concat((0,r.Z)(je.filter((function(n){return n.datasource.uuid!==e.uuid}))),(0,r.Z)(n.data)))})).finally((function(){Se(null)}))}(e)},children:Je.map((function(n){var t=e[n.key];return(0,V.jsx)(w.Z,{sx:{fontWeight:e.expand?"bold":"inherit"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid),(0,V.jsx)(_.Z,{children:(0,V.jsx)(w.Z,{colSpan:7,sx:{padding:e.expand?"0":"inherit"},children:(0,V.jsx)(P.Z,{in:e.expand,timeout:"auto",unmountOnExit:!0,children:(0,V.jsx)(Z.Z,{sx:{margin:1},children:Ce&&Fe===e.uuid?(0,V.jsx)(T.Z,{}):(0,V.jsx)(oe,{dataSourceEntryData:e.data_source_entries||[]})})})})},"".concat(e.uuid,"_details"))]]}))})]}),(0,V.jsx)(A.Z,{count:Math.ceil(ke.length/10),variant:"outlined",shape:"rounded",page:t,onChange:function(e,n){o(n)},sx:{marginTop:2,float:"right"}})]})]}),Y&&(0,V.jsx)(F.P,{open:Y,handleCancelCb:function(){Ne(null),q(!1)},dataSourceAddedCb:function(){Ne(null),We(),Be(),q(!1)},modalTitle:Pe,datasource:Re}),ee&&(0,V.jsx)(ne,{id:U,title:y,text:N,open:ee,onOk:function(e){void 0!==(null===e||void 0===e?void 0:e.data_source_entries)&&(0,J.o)().delete("api/datasources/".concat(e.uuid)).then((function(e){Be(),le(!1)}))},onCancel:function(){le(!1)}}),ce&&(0,V.jsx)($,{title:Pe,onCancel:function(){return de(!1)},onOk:function(){de(!1)},open:ce,dataSource:Re})]})}},46573:function(e,n,t){t.d(n,{B6:function(){return o},lD:function(){return l}});var i=t(9229),r=t(25926),a=t(84817);function o(){var e=(0,i.Zl)(r.NM);return function(){(0,a.o)().get("/api/datasources").then((function(n){e(n.data)})).catch((function(e){})).then({})}}function l(){var e=(0,i.Zl)(r.MC);return function(){(0,a.o)().get("/api/datasource_entries").then((function(n){e(n.data)})).catch((function(e){})).then({})}}}}]);