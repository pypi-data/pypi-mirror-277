"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[1439,5253,1504,404,906],{41504:function(e,n,t){t.r(n);var i=t(45987),r=t(29439),o=t(1413),a=t(16390),l=t(60103),s=t(54730),u=t(32399),c=t(68134),d=t(92628),f=t(97519),p=t(73462),h=t(49305),x=t(25861),m=t(52720),v=t(66161),j=t(85535),Z=t(76399),b=t(22644),g=t(62652),y=t(7276),_=t(45263),C=["schema","uiSchema","formData","onChange","submitBtn","theme","validator","templates","widgets","disableAdvanced"],w=(0,y.lazy)((function(){return Promise.all([t.e(9907),t.e(2580),t.e(6783)]).then(t.bind(t,62580))})),k=(0,y.lazy)((function(){return t.e(1393).then(t.bind(t,63890))})),S=(0,y.lazy)((function(){return t.e(935).then(t.bind(t,80935))})),D=(0,y.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(5539),t.e(111),t.e(4880),t.e(686),t.e(6374)]).then(t.bind(t,16374))})),z=(0,y.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(111),t.e(3667),t.e(6279),t.e(7458)]).then(t.bind(t,96279))})),A=(0,y.lazy)((function(){return Promise.all([t.e(7420),t.e(2341)]).then(t.bind(t,16214))})),P=(0,y.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(5539),t.e(111),t.e(4880),t.e(686),t.e(5831)]).then(t.bind(t,75831))})),M=(0,y.lazy)((function(){return t.e(8781).then(t.bind(t,68781))})),R=(0,y.lazy)((function(){return t.e(6317).then(t.bind(t,6317))})),Y=(0,y.lazy)((function(){return t.e(4843).then(t.bind(t,64843))})),T=(0,y.lazy)((function(){return Promise.all([t.e(2789),t.e(111),t.e(2384)]).then(t.bind(t,12384))})),E=(0,y.lazy)((function(){return t.e(7437).then(t.bind(t,97437))})),O=(0,y.lazy)((function(){return Promise.all([t.e(7902),t.e(7533)]).then(t.bind(t,57533))}));function N(e){return(0,_.jsx)(P,(0,o.Z)({},e))}function I(e){return(0,_.jsx)(R,(0,o.Z)({},e))}function q(e){var n=e.id,t=e.children,i=e.classNames,o=e.style,a=e.disabled,u=e.displayLabel,c=e.hidden,d=e.label,f=e.onDropPropertyClick,p=e.onKeyChange,h=e.readonly,x=e.required,m=e.rawErrors,v=void 0===m?[]:m,j=e.errors,Z=e.help,b=e.rawDescription,C=e.schema,w=e.uiSchema,k=e.registry,S=(0,y.useState)(!1),D=(0,r.Z)(S,2),z=D[0],A=D[1],P=(0,g.LI)(w),M=(0,g.t4)("WrapIfAdditionalTemplate",k,P);return c?(0,_.jsx)("div",{style:{display:"none"},children:t}):(0,_.jsx)(M,{classNames:i,style:o,disabled:a,id:n,label:d,onDropPropertyClick:f,onKeyChange:p,readonly:h,required:x,schema:C,uiSchema:w,registry:k,children:(0,_.jsxs)(l.Z,{fullWidth:!0,error:!!v.length,required:x,onFocus:function(e){A(!0)},onBlur:function(e){A(!1)},children:[t,u&&b?(0,_.jsx)(s.Z,{id:n,focused:z,children:b}):null,j,Z]})})}function J(e){var n=e.options,t=e.registry,i=(0,g.t4)("BaseInputTemplate",t,n),r=5;return"string"!==typeof n.rows&&"number"!==typeof n.rows||(r=n.rows),(0,_.jsx)(i,(0,o.Z)((0,o.Z)({sx:{"& .MuiOutlinedInput-root":{"& > fieldset":{border:"1px solid rgb(204, 204, 204)"}}}},e),{},{multiline:!0,rows:r,variant:"outlined"}))}function F(e){return(0,_.jsx)(T,(0,o.Z)({},e))}function H(e){return(0,_.jsx)(A,(0,o.Z)({},e))}function W(e){var n=e.chat_message;if(n.content)return(0,_.jsx)(u.Z,{primary:n.content});if(n.function_call){var t=n.function_call.name,i=JSON.parse(n.function_call.arguments),r=Object.keys(i).map((function(e){return"".concat(e,'="').concat(i[e],'"')})).join(",");return(0,_.jsx)("div",{children:(0,_.jsx)(u.Z,{primary:"Function",secondary:"".concat(t,"(").concat(r,")")})})}return null}var B=function(e){var n=e.value||[],t=0;return"string"===typeof n&&(n=[{content:n}]),(0,_.jsx)(c.Z,{className:"output-chat",style:{paddingTop:0},children:n.map((function(e){return(0,_.jsxs)(d.ZP,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",background:"rgb(255, 250, 236)",border:"1px solid rgb(235, 230, 236)",borderRadius:10},children:[(0,_.jsx)(f.Z,{children:(0,_.jsx)(p.Z,{color:"primary",label:e.role||"System"})}),(0,_.jsx)(W,{chat_message:e})]},t++)}))})},L=function(e){var n=e.value||[],t=0;return(0,_.jsx)(c.Z,{className:"output-text",style:{paddingTop:0},children:n.map((function(e){return(0,_.jsx)(d.ZP,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",background:"rgb(255, 250, 236)",border:"1px solid rgb(235, 230, 236)",borderRadius:10},children:(0,_.jsx)(u.Z,{primary:e})},t++)}))})},U=function(e){var n=0;return(0,_.jsx)(h.Z,{className:"output-image",cols:2,gap:8,children:e.value.map((function(e){return(0,_.jsx)(x.Z,{children:(0,_.jsx)("img",{src:"".concat(e),loading:"lazy",alt:""})},n++)}))})},V=function(e){return(0,_.jsx)("audio",{src:e.value,controls:!0})},Q=function(e){return(0,_.jsx)(S,(0,o.Z)((0,o.Z)({},e),{},{disableAdvanced:!1}))},G=function(e){return(0,_.jsx)(S,(0,o.Z)((0,o.Z)({},e),{},{disableAdvanced:!0}))},K=function(e){return(0,_.jsx)(M,(0,o.Z)({},e))},$=function(e){return(0,_.jsx)(D,(0,o.Z)({},e))},X=function(e){return(0,_.jsx)(w,(0,o.Z)((0,o.Z)({},e),{},{richText:!0}))},ee=function(e){return(0,_.jsx)(z,(0,o.Z)({},e))},ne=function(e){return(0,_.jsx)(k,(0,o.Z)({},e))},te=function(e){var n=e.errors;return(0,_.jsx)(m.Z,{elevation:2,children:(0,_.jsxs)(v.Z,{mb:2,p:2,children:[(0,_.jsx)(j.Z,{variant:"h6",children:"Errors"}),(0,_.jsx)(c.Z,{dense:!0,children:n.map((function(e,n){return(0,_.jsxs)(d.ZP,{dense:!0,children:[(0,_.jsx)(Z.Z,{children:(0,_.jsx)(a.Z,{color:"error"})}),(0,_.jsx)(u.Z,{primary:e.message})]},n)}))})]})})};n.default=function(e){var n=e.schema,t=e.uiSchema,r=e.formData,a=e.onChange,l=e.submitBtn,s=void 0===l?(0,_.jsx)("div",{}):l,u=(e.theme,e.validator),c=e.templates,d=void 0===c?{}:c,f=e.widgets,p=void 0===f?{}:f,h=e.disableAdvanced,x=void 0!==h&&h,m=(0,i.Z)(e,C),v=m.createAsset;(0,y.useEffect)((function(){var e,n,t;null!==(e=m.formRef)&&void 0!==e&&null!==(n=e.current)&&void 0!==n&&null!==(t=n.formElement)&&void 0!==t&&t.current&&m.formRef.current.formElement.current.addEventListener("submit",(function(e){e.preventDefault()}))}),[m.formRef]);var j=(0,y.useCallback)((function(e){var n;return null!==e&&void 0!==e&&null!==(n=e.schema)&&void 0!==n&&n.stream?(0,_.jsx)(O,(0,o.Z)((0,o.Z)({},e),{},{createAsset:v,formRef:m.formRef})):(0,_.jsx)(Y,(0,o.Z)({},e))}),[v,m.formRef]);return(0,_.jsx)(b.ZP,(0,o.Z)((0,o.Z)({ref:m.formRef},m),{},{schema:n,uiSchema:t,validator:u,formData:r,onChange:a,templates:(0,o.Z)({ErrorListTemplate:te,FieldTemplate:q,ObjectFieldTemplate:x?G:Q},d),fields:{multi:function(e){return(0,_.jsx)(E,(0,o.Z)((0,o.Z)({},e),{},{formRef:m.formRef,onCancel:m.onCancel}))}},widgets:(0,o.Z)((0,o.Z)({},{customselect:F,TextareaWidget:J,FileWidget:H,output_chat:B,output_text:L,output_image:U,output_audio:V,datasource:ee,gdrive:N,webpageurls:I,password:K,connection:$,richtext:X,voice:j,app_version:ne}),p),transformErrors:null===m||void 0===m?void 0:m.transformErrors,children:s}))}},65253:function(e,n,t){t.r(n),t.d(n,{AppSelector:function(){return s}});var i=t(60103),r=t(31586),o=t(26235),a=t(49321),l=t(45263);function s(e){return(0,l.jsx)("div",{children:(0,l.jsxs)(i.Z,{fullWidth:!0,children:[(0,l.jsx)(r.Z,{id:"app-select-label",children:"Select an App"}),(0,l.jsx)(o.Z,{labelId:"app-select-label",id:"app-select",value:e.value||"",label:"Select an application",onChange:function(n){return e.onChange(n.target.value)},variant:"filled",sx:{lineHeight:"0.5em"},children:e.apps.map((function(e){return(0,l.jsx)(a.Z,{value:e.published_uuid,children:e.name},e.published_uuid)}))})]})})}},80419:function(e,n,t){t.d(n,{Z:function(){return h}});var i=t(1413),r=t(66161),o=t(13366),a=t(9229),l=t(25926),s=t(65253),u=t(41504),c=t(70906),d=t(45263),f={properties:{job_name:{type:"string",title:"Job Name"},application:{type:"string",title:"Application",widget:"appselect"},frequency:{type:"string",title:"Frequency",widget:"frequencyPicker"},batch_size:{type:"number",title:"Batch Size",default:1,minimum:1,maximum:10},use_session:{type:"boolean",title:"Use Session",default:!1}}},p={"ui:order":["job_name","application","frequency","batch_size","use_session"],job_name:{"ui:description":"Enter a name for this job.","ui:advanced":!1},application:{"ui:description":"Application to run with this job.","ui:widget":"appselect","ui:advanced":!1},frequency:{"ui:description":"Select a frequency to run the application.","ui:widget":"frequencyPicker","ui:advanced":!1},batch_size:{"ui:description":"Select a batch size to run the application.","ui:advanced":!0},use_session:{"ui:description":"Use session in batch run.","ui:advanced":!0}};function h(e){var n=((0,a.sJ)(l.C_)||[]).filter((function(e){return e.is_published}));return(0,d.jsx)(r.Z,{sx:{width:"95%",margin:"5px"},children:(0,d.jsx)(u.default,{disableAdvanced:!1,schema:f,validator:o.ZP,uiSchema:(0,i.Z)((0,i.Z)({},p),{"ui:submitButtonOptions":{norender:!0}}),formData:e.value,onChange:function(t){var r=t.formData;e.onChange((0,i.Z)((0,i.Z)({},r),{},{appDetail:n.find((function(e){return e.published_uuid===(null===r||void 0===r?void 0:r.application)})),frequencyObj:null!==r&&void 0!==r&&r.frequency?JSON.parse((null===r||void 0===r?void 0:r.frequency)||"{}"):null}))},widgets:{appselect:function(e){return(0,d.jsx)(s.AppSelector,(0,i.Z)((0,i.Z)({},e),{},{apps:n,value:e.value}))},frequencyPicker:function(e){return(0,d.jsx)(c.default,(0,i.Z)((0,i.Z)({},e),{},{value:e.value,id:"frequency-picker"}))}}})})}},70906:function(e,n,t){t.r(n),t.d(n,{default:function(){return v}});var i=t(1413),r=t(66161),o=t(60103),a=t(31586),l=t(26235),s=t(49321),u=t(44390),c=t(97237),d=t(55396),f=t(39308),p=t(21420),h=t(4550),x=t.n(h),m=t(45263);function v(e){var n=e.onChange,t=e.id,h=e.value,v=e.minStartTime,j=e.maxStartTime,Z=h?JSON.parse(h):null,b=function(e){n(JSON.stringify(e))};return(0,m.jsxs)(r.Z,{sx:{display:"flex"},children:[(0,m.jsxs)(o.Z,{sx:{width:"120px"},children:[(0,m.jsx)(a.Z,{id:"".concat(t,"-label"),children:"Frequency"}),(0,m.jsxs)(l.Z,{labelId:"".concat(t,"-label"),id:t,label:"Frequency",value:(null===Z||void 0===Z?void 0:Z.type)||"",onChange:function(e){return b({type:e.target.value})},placeholder:"Select a frequency",variant:"filled",sx:{lineHeight:"0.5em"},children:[(0,m.jsx)(s.Z,{value:"run_once",children:"Run Once"}),(0,m.jsx)(s.Z,{value:"repeat",children:"Repeat"}),(0,m.jsx)(s.Z,{value:"cron",children:"Cron Job"})]})]}),"run_once"===(null===Z||void 0===Z?void 0:Z.type)&&(0,m.jsx)(p._,{dateAdapter:f.Q,children:(0,m.jsx)(c.x,{minDateTime:v,maxDateTime:j,timeSteps:{minutes:15},disablePast:!0,value:x()(null===Z||void 0===Z?void 0:Z.scheduled_time),onChange:function(e){b((0,i.Z)((0,i.Z)({},Z),{},{type:"run_once",start_date:e.format("YYYY-MM-DD"),start_time:e.format("HH:mm:ss"),scheduled_time:e}))},label:"Schedule Time"})}),"repeat"===(null===Z||void 0===Z?void 0:Z.type)&&(0,m.jsx)("div",{children:(0,m.jsxs)(p._,{dateAdapter:f.Q,children:[(0,m.jsx)(c.x,{minDateTime:v,maxDateTime:j,timeSteps:{minutes:15},disablePast:!0,value:x()(null===Z||void 0===Z?void 0:Z.scheduled_time),onChange:function(e){b((0,i.Z)((0,i.Z)({},Z),{},{type:"repeat",start_date:e.format("YYYY-MM-DD"),start_time:e.format("HH:mm:ss"),scheduled_time:e}))},label:"Schedule Start Time"}),(0,m.jsx)(u.Z,{label:"Repeat Interval (in days)",value:null===Z||void 0===Z?void 0:Z.interval,type:"number",onChange:function(e){return b((0,i.Z)((0,i.Z)({},Z),{},{type:"repeat",interval:e.target.value}))}}),(0,m.jsx)(d.M,{disablePast:!0,value:x()(null===Z||void 0===Z?void 0:Z.end_date,"YYYY-MM-DD"),onChange:function(e){b((0,i.Z)((0,i.Z)({},Z),{},{type:"repeat",end_date:e.format("YYYY-MM-DD")}))},label:"Schedule End Date"})]})}),"cron"===(null===Z||void 0===Z?void 0:Z.type)&&(0,m.jsxs)(p._,{dateAdapter:f.Q,children:[(0,m.jsx)(u.Z,{label:"Cron Job Expression",value:null===Z||void 0===Z?void 0:Z.cron_expression,onChange:function(e){return b((0,i.Z)((0,i.Z)({},Z),{},{type:"cron",cron_expression:e.target.value}))}}),(0,m.jsx)(d.M,{disablePast:!0,value:x()(null===Z||void 0===Z?void 0:Z.end_date,"YYYY-MM-DD"),onChange:function(e){b((0,i.Z)((0,i.Z)({},Z),{},{type:"cron",end_date:e.format("YYYY-MM-DD")}))},label:"Schedule End Date"})]})]})}},61157:function(e,n,t){t.d(n,{Z:function(){return k}});var i=t(93433),r=t(4942),o=t(1413),a=t(29439),l=t(92181),s=t(2146),u=t(30892),c=t(52420),d=t(23109),f=t(15433),p=t(31342),h=t(66161),x=t(85722),m=t(9068),v=t(82201),j=t(19922),Z=t(17125),b=t(43883),g=t(73209),y=t(83960),_=t(7276),C=t(36523),w=t(45263);function k(e){var n=e.columnData,t=e.rowData,k=e.onChange,S=(0,C.vE)().readString,D=(0,_.useState)({}),z=(0,a.Z)(D,2),A=z[0],P=z[1],M=(0,_.useRef)(null),R=(0,_.useState)(null),Y=(0,a.Z)(R,2),T=Y[0],E=Y[1];(0,_.useEffect)((function(){if(T){var e=new FileReader;e.onload=function(e){var t=e.target.result;S(t,{header:!0,worker:!0,complete:function(e){if(0===e.data.length)return(0,y.yv)("No data found in file",{variant:"warning"}),void E(null);var t=Object.keys(e.data[0]);if(t.length!==n.length)return(0,y.yv)("Headers do not match expected headers",{variant:"error"}),void E(null);t.forEach((function(e){if(!n.find((function(n){return n.headerName===e})))return(0,y.yv)("Headers do not match expected headers",{variant:"error"}),void E(null)}));for(var i=[],r=function(){var r=e.data[o];if(Object.keys(r).length!==t.length)return 1;var a={_id:o,_isNew:!0};n.forEach((function(e){a[e.field]=r[e.headerName]})),i.push(a)},o=0;o<e.data.length;o++)r();k(i)}})},e.readAsText(T)}}),[T,n,k,S]);var O=function(e){return function(){P((0,o.Z)((0,o.Z)({},A),{},(0,r.Z)({},e,{mode:m.se.Edit})))}},N=function(e){return function(){P((0,o.Z)((0,o.Z)({},A),{},(0,r.Z)({},e,{mode:m.se.View})))}},I=function(e){return function(){k(t.filter((function(n){return n._id!==e})))}},q=function(e){return function(){P((0,o.Z)((0,o.Z)({},A),{},(0,r.Z)({},e,{mode:m.se.View,ignoreModifications:!0}))),t.find((function(n){return n._id===e}))._isNew&&k(t.filter((function(n){return n._id!==e})))}},J=function(){M.current.click()},F=function(e){var n=e.target.files[0];E(n)};return(0,w.jsx)(h.Z,{sx:{width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"},"& .MuiDataGrid-columnHeaderTitle":{fontWeight:"bold"}},children:(0,w.jsx)(Z._$,{rows:t,getRowId:function(e){return e._id},columns:[].concat((0,i.Z)(n),[{field:"actions",type:"actions",headerName:"Actions",width:100,cellClassName:"actions",flex:1,maxWidth:100,getActions:function(e){var n,t=e.id;return(null===(n=A[t])||void 0===n?void 0:n.mode)===m.se.Edit?[(0,w.jsx)(b.u,{icon:(0,w.jsx)(u.Z,{}),label:"Save",sx:{color:"primary.main"},onClick:N(t)}),(0,w.jsx)(b.u,{icon:(0,w.jsx)(c.Z,{}),label:"Cancel",className:"textPrimary",onClick:q(t),color:"inherit"})]:[(0,w.jsx)(b.u,{icon:(0,w.jsx)(d.Z,{}),label:"Edit",className:"textPrimary",onClick:O(t),color:"inherit"}),(0,w.jsx)(b.u,{icon:(0,w.jsx)(f.Z,{}),label:"Delete",onClick:I(t),color:"inherit"})]}}]),editMode:"row",autoHeight:!0,rowModesModel:A,onRowModesModelChange:function(e){P(e)},onRowEditStop:function(e,n){e.reason===x.U.rowFocusOut&&(n.defaultMuiPrevented=!0)},processRowUpdate:function(e){var n=(0,o.Z)((0,o.Z)({},e),{},{_isNew:!1});return k(t.map((function(t){return t._id===e._id?n:t}))),n},pageSizeOptions:[5,10],initialState:{pagination:{paginationModel:{pageSize:5}}},slots:{toolbar:function(e){var t=e.setRowModesModel;return(0,w.jsxs)(v.D,{sx:{alignSelf:"flex-end"},children:[(0,w.jsx)(p.Z,{color:"primary",startIcon:(0,w.jsx)(l.Z,{}),type:"file",variant:"contained",onClick:J,size:"small",children:"Upload CSV"}),(0,w.jsx)("input",{type:"file",accept:".csv",onChange:F,ref:M,style:{display:"none"}}),(0,w.jsx)(p.Z,{color:"secondary",startIcon:(0,w.jsx)(s.Z,{}),onClick:function(){var e=(0,g.kb)(),a={_id:e,_isNew:!0};n.forEach((function(e){a[e.field]=" "})),k((function(e){return[].concat((0,i.Z)(e),[a])})),t((function(t){return(0,o.Z)((0,o.Z)({},t),{},(0,r.Z)({},e,{mode:m.se.Edit,fieldToFocus:n[0].field}))}))},variant:"contained",size:"small",children:"Add Record"}),(0,w.jsx)(j.Zh,{csvOptions:{includeColumnGroupsHeaders:!1,fileName:"input_data"},printOptions:{disableToolbarButton:!0}})]})}},slotProps:{toolbar:{setRowModesModel:P}}})})}},81439:function(e,n,t){t.r(n),t.d(n,{default:function(){return re}});var i=t(1413),r=t(93433),o=t(29439),a=t(51073),l=t(79288),s=t(1915),u=t(25716),c=t(64830),d=t(97353),f=t(28775),p=t(34912),h=t(24872),x=t(54560),m=t(969),v=t(46650),j=t(12283),Z=t(34160),b=t(31342),g=t(85535),y=t(73462),_=t(66161),C=t(44570),w=t(65173),k=t(20888),S=t(34867),D=t(9340),z=t(62154),A=t(71516),P=t(29166),M=t(20495),R=t(7458),Y=t(8568),T=t(4550),E=t.n(T),O=t(83960),N=t(7276),I=t(9229),q=t(6334),J=t(84817),F=t(80419),H=t(61157),W=t(45263);function B(e){var n,t=(0,N.useState)([]),r=(0,o.Z)(t,2),a=r[0],l=r[1],s=(0,N.useState)({}),u=(0,o.Z)(s,2),c=u[0],d=u[1],f=(0,N.useState)([]),p=(0,o.Z)(f,2),h=p[0],v=p[1];return(0,N.useEffect)((function(){if(null!==c&&void 0!==c&&c.appDetail){var e=null===c||void 0===c?void 0:c.appDetail.data.input_fields.map((function(e){return{field:e.name,headerName:e.title,width:"text"===e.type?300:200,disableColumnMenu:!0,sortable:!1,editable:!0,flex:1}}));l(e),v([])}}),[c]),(0,W.jsxs)(x.Z,{open:!0,maxWidth:"lg",fullWidth:!0,onClose:e.onClose,children:[(0,W.jsx)(m.Z,{children:"Schedule App Run Job"}),(0,W.jsxs)(w.ZP,{children:[(0,W.jsx)(w.ZP,{item:!0,xs:12,children:(0,W.jsx)(R.Z,{sx:{alignItems:"start",margin:"5px"},children:(0,W.jsx)(F.Z,{onChange:function(e){d(e)},value:c})})}),(null===c||void 0===c?void 0:c.frequency)&&(null===c||void 0===c?void 0:c.job_name)&&(0,W.jsx)(w.ZP,{item:!0,xs:12,sx:{margin:"10px"},children:(0,W.jsxs)(R.Z,{sx:{alignItems:"start",margin:"5px"},children:[(0,W.jsx)(g.Z,{variant:"h7",sx:{marginLeft:"2px"},children:"Batch Input to the App"}),(0,W.jsx)(q.Z,{}),(0,W.jsx)(g.Z,{variant:"caption",sx:{marginLeft:"2px"},children:"Enter the input data for the app run. You can also upload a CSV file with the input data. Make sure the column names match the input fields of the app."}),(0,W.jsx)("br",{}),null!==c&&void 0!==c&&c.appDetail?(0,W.jsx)(H.Z,{columnData:a,rowData:h,onChange:function(e){v(e)}}):(0,W.jsx)("strong",{children:"Please select an application."})]})})]}),(0,W.jsxs)(Z.Z,{children:[(0,W.jsx)(b.Z,{variant:"outlined",onClick:e.onClose,children:"Cancel"}),(0,W.jsx)(b.Z,{variant:"contained",color:"primary",disabled:!(null!==c&&void 0!==c&&null!==(n=c.appDetail)&&void 0!==n&&n.uuid&&null!==c&&void 0!==c&&c.frequencyObj&&h&&h.length>0),onClick:function(){var e,n=h.map((function(e){var n=(0,i.Z)({},e);return delete n._id,delete n._isNew,n}));(0,J.o)().post("/api/jobs/app_run",{job_name:null===c||void 0===c?void 0:c.job_name,app_uuid:null===c||void 0===c||null===(e=c.appDetail)||void 0===e?void 0:e.uuid,frequency:null===c||void 0===c?void 0:c.frequencyObj,use_session:null===c||void 0===c?void 0:c.use_session,batch_size:null===c||void 0===c?void 0:c.batch_size,app_run_data:n}).then((function(e){(0,O.yv)("Successfully Scheduled App Run",{variant:"success"}),window.location.href="/jobs"})).catch((function(e){var n,t;null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.message&&(0,O.yv)(e.response.data.message,{variant:"error"})}))},children:"Submit"})]})]})}var L=t(76236),U=t(42470),V=t(23085),Q=t(87201),G=t(52720),K=t(2683),$=t(89492),X=t(49321);function ee(e){var n,t,r=e.options,a=e.sx,l=(0,N.useState)(!1),s=(0,o.Z)(l,2),u=s[0],c=s[1],d=(0,N.useRef)(null),f=(0,N.useState)(0),p=(0,o.Z)(f,2),h=p[0],x=p[1],m=function(e){d.current&&d.current.contains(e.target)||c(!1)};return(0,W.jsxs)(N.Fragment,{children:[(0,W.jsxs)(U.Z,{variant:"contained",ref:d,"aria-label":"split button",sx:a,children:[(0,W.jsx)(b.Z,{onClick:function(){r[h].onClick()},sx:{textTransform:"none"},startIcon:(null===(n=r[h])||void 0===n?void 0:n.startIcon)||null,children:null===(t=r[h])||void 0===t?void 0:t.title}),(0,W.jsx)(b.Z,{size:"small","aria-controls":u?"split-button-menu":void 0,"aria-expanded":u?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:function(){c((function(e){return!e}))},children:(0,W.jsx)(L.Z,{})})]}),(0,W.jsx)(V.Z,{sx:{zIndex:50},open:u,anchorEl:d.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var n=e.TransitionProps,t=e.placement;return(0,W.jsx)(Q.Z,(0,i.Z)((0,i.Z)({},n),{},{style:{transformOrigin:"bottom"===t?"center top":"center bottom"},children:(0,W.jsx)(G.Z,{children:(0,W.jsx)(K.Z,{onClickAway:m,children:(0,W.jsx)($.Z,{id:"split-button-menu",autoFocusItem:!0,children:r.map((function(e,n){return(0,W.jsx)(X.Z,{disabled:!0===(null===r||void 0===r?void 0:r.isDisabled),selected:n===h,onClick:function(e){return function(e,n){x(n),c(!1)}(0,n)},children:e.title},e.key)}))})})})}))}})]})}var ne=t(25926);function te(e){var n=e.open,t=e.onOk,i=e.onCancel,r=e.title,o=e.text;return(0,W.jsxs)(x.Z,{title:r||"Logged Out",open:n,onCancel:i,children:[(0,W.jsx)(m.Z,{id:"delete-modal-title",children:r}),(0,W.jsx)(v.Z,{children:(0,W.jsx)(j.Z,{children:o})}),(0,W.jsxs)(Z.Z,{children:[(0,W.jsx)(b.Z,{onClick:i,children:"Cancel"},"cancel"),",",(0,W.jsx)(b.Z,{variant:"contained",type:"primary",onClick:t,children:"Confirm"},"submit"),","]})]})}function ie(e){var n=e.modalType,t=e.open,i=e.onCancel,r=e.onOk,o=e.jobId;switch(n){case"delete":return(0,W.jsx)(te,{id:"delete-job",open:t,onOk:function(){(0,J.o)().delete("/api/jobs/".concat(o)).then((function(e){window.location.reload()})).catch((function(e){(0,O.yv)(e.message,{variant:"error"})})).finally((function(){r()}))},onCancel:i,title:"Delete Job",text:"Are you sure you want to delete this job?"});case"pause":return(0,W.jsx)(te,{id:"pause-job",open:t,onOk:function(){(0,J.o)().post("/api/jobs/".concat(o,"/pause")).then((function(e){window.location.reload()})).catch((function(e){(0,O.yv)(e.message,{variant:"error"})})).finally((function(){r()}))},onCancel:i,title:"Pause Job",text:"Are you sure you want to pause this job?"});case"resume":return(0,W.jsx)(te,{id:"resume-job",open:t,onOk:function(){(0,J.o)().post("/api/jobs/".concat(o,"/resume")).then((function(e){window.location.reload()})).catch((function(e){(0,O.yv)(e.message,{variant:"error"})})).finally((function(){r()}))},onCancel:i,title:"Resume Job",text:"Are you sure you want to resume this job?"});case"run":return(0,W.jsx)(te,{id:"run-job",open:t,onOk:function(){(0,J.o)().post("/api/jobs/".concat(o,"/run")).then((function(e){window.location.reload()})).catch((function(e){(0,O.yv)(e.message,{variant:"error"})})).finally((function(){r()}))},onCancel:i,title:"Run Job",text:"Are you sure you want to run this job now?"});default:return null}}function re(){var e=(0,I.sJ)(ne.a6),n=(0,N.useState)(1),t=(0,o.Z)(n,2),x=t[0],m=t[1],v=(0,N.useState)([]),j=(0,o.Z)(v,2),Z=j[0],T=j[1],q=(0,N.useState)(!1),F=(0,o.Z)(q,2),H=F[0],L=F[1],U=(0,N.useState)(null),V=(0,o.Z)(U,2),Q=V[0],G=V[1],K=(0,N.useState)(null),$=(0,o.Z)(K,2),X=$[0],te=$[1],re=(0,N.useState)(!1),oe=(0,o.Z)(re,2),ae=oe[0],le=oe[1],se=function(){G(null),te(null),L(!1)},ue=function(e){var n,t,i,r,o,a,l,s,u=null===(n=e.result)||void 0===n||null===(t=n.filter((function(e){return"success"===e.status})))||void 0===t?void 0:t.length,c=null===(i=e.result)||void 0===i||null===(r=i.filter((function(e){return"failed"===e.status})))||void 0===r?void 0:r.length,d=null===(o=e.result)||void 0===o||null===(a=o.filter((function(e){return"started"===e.status})))||void 0===a?void 0:a.length,f=null===(l=e.result)||void 0===l?void 0:l.filter((function(e){return"not_started"===e.status})).length,p=null===(s=e.result)||void 0===s?void 0:s.length;return(0,W.jsxs)("div",{children:[(0,W.jsxs)("div",{children:["Total Rows: ",p]}),u&&p!==u?(0,W.jsxs)("div",{children:[(0,W.jsx)("br",{}),"Success: ",u]}):null,c?(0,W.jsxs)("div",{children:["Failed: ",c]}):null,d?(0,W.jsxs)("div",{children:["Started: ",d]}):null,f?(0,W.jsxs)("div",{children:["Pending: ",f]}):null]})},ce=[{title:"Name",key:"name",render:function(e,n){return(0,W.jsxs)(g.Z,{sx:{display:"flex",fontSize:"0.9rem",fontWeight:n.expand?"600":"inherit",gap:1},children:[n.expand?(0,W.jsx)(a.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}):(0,W.jsx)(l.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}),e]})}},{title:"Type",key:"model",render:function(e,n){return(0,W.jsxs)("div",{children:[(0,W.jsx)(y.Z,{label:function(){switch(e){case"ScheduledJob":return"Scheduled";case"RepeatableJob":return"Repeatable";case"CronJob":return"Cron";default:return null}}(),color:"secondary",size:"small"}),(0,W.jsx)(y.Z,{label:function(){switch(null===n||void 0===n?void 0:n.task_category){case"app_run":return"App";case"datasource_refresh":return"Datasource";default:return null}}(),color:"primary",size:"small"})]})}},{title:"Source",key:"source_uuid",render:function(n,t){var i;return"app_run"===(null===t||void 0===t?void 0:t.task_category)?(0,W.jsx)(b.Z,{onClick:function(){window.location.href="/apps/".concat(n)},sx:{textTransform:"none",fontWeight:"inherit",textAlign:"left"},children:null===(i=e.find((function(e){return e.uuid===n})))||void 0===i?void 0:i.name}):null}},{title:"Status",key:"enabled",render:function(e,n){return n?(0,W.jsx)(y.Z,{label:"Enabled",color:"success",size:"small"}):(0,W.jsx)(y.Z,{label:"Disabled",color:"error",size:"small"})}},{title:"Created",key:"created_at",render:function(e,n){return null!==n&&void 0!==n&&n.created_at?E().utc(null===n||void 0===n?void 0:n.created_at).local().format("D-MMM-YYYY h:mm:ss A"):null}},{title:"Last Run",key:"last_run",render:function(e,n){return null!==n&&void 0!==n&&n.updated_at?E().utc(null===n||void 0===n?void 0:n.updated_at).local().fromNow():null}},{title:"Action",key:"operation",render:function(e,n){return(0,W.jsxs)(_.Z,{children:[(0,W.jsx)(C.Z,{onClick:function(){te(n.uuid),G("run"),L(!0)},color:"primary",children:(0,W.jsx)(p.Z,{})}),"ScheduledJob"!==(null===n||void 0===n?void 0:n.model)?null!==n&&void 0!==n&&n.enabled?(0,W.jsx)(C.Z,{onClick:function(){te(n.uuid),G("pause"),L(!0)},color:"primary",children:(0,W.jsx)(d.Z,{})}):(0,W.jsx)(C.Z,{onClick:function(){te(n.uuid),G("resume"),L(!0)},color:"primary",children:(0,W.jsx)(f.Z,{})}):null,(0,W.jsx)(C.Z,{onClick:function(){te(n.uuid),G("delete"),L(!0)},color:"primary",children:(0,W.jsx)(u.Z,{})})]})}}];return(0,N.useEffect)((function(){(0,J.o)().get("/api/jobs").then((function(e){var n,t=e.data.scheduled_jobs.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{model:"ScheduledJob",expand:!1})})),o=e.data.repeatable_jobs.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{model:"RepeatableJob",expand:!1})})),a=e.data.cron_jobs.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{model:"CronJob",expand:!1})}));n=[].concat((0,r.Z)(t),(0,r.Z)(o),(0,r.Z)(a)).sort((function(e,n){return E().utc(n.created_at).local()-E().utc(e.created_at).local()})),T(n)}))}),[]),(0,W.jsxs)("div",{id:"schedule-page",style:{marginBottom:"120px"},children:[(0,W.jsxs)(w.ZP,{span:24,style:{padding:"10px"},children:[(0,W.jsx)(w.ZP,{item:!0,style:{width:"100%",padding:"15px 0px"},children:(0,W.jsx)(ee,{options:[{key:1,title:"App Run Job",startIcon:(0,W.jsx)(s.Z,{}),onClick:function(){le(!0)}}],sx:{float:"left",marginBottom:"10px",textTransform:"none"}})}),(0,W.jsxs)(w.ZP,{item:!0,style:{width:"100%"},children:[(0,W.jsxs)(k.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,W.jsx)(S.Z,{children:(0,W.jsx)(D.Z,{children:ce.map((function(e){return(0,W.jsx)(z.Z,{sx:{paddingLeft:"name"===e.key?"20px":"inherit",textAlign:"name"===e.key?"left":"center"},children:(0,W.jsx)("strong",{children:e.title})},e.key)}))})}),(0,W.jsx)(A.Z,{children:Z.map((function(e){var n;return[(0,W.jsx)(D.Z,{sx:{cursor:"pointer",backgroundColor:"inherit"},onClick:function(){"app_run"===e.task_category&&function(e){var n=(0,r.Z)(Z),t=n.findIndex((function(n){return n.uuid===e.uuid}));n[t].expand=!n[t].expand,T(n),n[t].expand&&(0,J.o)().get("/api/jobs/".concat(e.uuid,"/tasks")).then((function(n){var t=(0,r.Z)(Z),i=t.findIndex((function(n){return n.uuid===e.uuid}));t[i].tasks=n.data,T(t)}))}(e)},children:ce.map((function(n){var t=e[n.key];return(0,W.jsx)(z.Z,{align:n.align,sx:{fontWeight:"inherit",textAlign:"name"===n.key?"left":"center"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid),(0,W.jsx)(D.Z,{children:(0,W.jsx)(z.Z,{style:{paddingBottom:0,paddingTop:0,border:0},colSpan:12,children:(0,W.jsx)(P.Z,{in:e.expand,timeout:"auto",unmountOnExit:!0,children:(0,W.jsx)(_.Z,{sx:{margin:1},children:(0,W.jsxs)(k.Z,{size:"small","aria-label":"tasks",children:[(0,W.jsx)(S.Z,{children:(0,W.jsxs)(D.Z,{children:[(0,W.jsx)(z.Z,{children:(0,W.jsx)("strong",{children:"Created At"})}),(0,W.jsx)(z.Z,{children:(0,W.jsx)("strong",{children:"Status"})}),(0,W.jsx)(z.Z,{children:(0,W.jsx)("strong",{children:"Actions"})})]})}),(0,W.jsx)(A.Z,{children:null===(n=e.tasks)||void 0===n?void 0:n.map((function(n){var t,i,r;return(0,W.jsxs)(D.Z,{children:[(0,W.jsx)(z.Z,{children:E().utc(n.created_at).local().format("D-MMM-YYYY h:mm:ss A")}),(0,W.jsx)(z.Z,{children:(0,W.jsx)(M.Z,{title:ue(n),children:"started"!==n.status&&"succeeded"!==n.status||(null===(t=n.result)||void 0===t||null===(i=t.filter((function(e){return"success"===e.status})))||void 0===i?void 0:i.length)!==(null===(r=n.result)||void 0===r?void 0:r.length)?"started"===n.status?(0,W.jsx)(y.Z,{label:"Started",color:"warning",size:"small"}):(0,W.jsx)(y.Z,{label:"Failed",color:"error",size:"small"}):(0,W.jsx)(y.Z,{label:"Finished",color:"success",size:"small"})})}),(0,W.jsx)(z.Z,{children:(0,W.jsxs)(R.Z,{direction:"row",spacing:2,children:[(0,W.jsx)(M.Z,{title:"Download results",children:(0,W.jsx)(C.Z,{variant:"outlined",size:"small",disabled:"failed"===n.status,onClick:function(){window.open("/api/jobs/".concat(e.uuid,"/tasks/").concat(n.uuid,"/download"))},sx:{textTransform:"none"},children:(0,W.jsx)(c.Z,{})})}),"started"===n.status&&(0,W.jsx)(M.Z,{title:"Cancel running job",children:(0,W.jsx)(C.Z,{onClick:function(){(0,J.o)().post("/api/jobs/".concat(e.uuid,"/tasks/").concat(n.uuid,"/cancel")).then((function(e){window.location.reload()})).catch((function(e){(0,O.yv)(e.message,{variant:"error"})}))},children:(0,W.jsx)(h.Z,{})})}),("succeeded"===n.status||"cancelled"===n.status)&&(0,W.jsx)(M.Z,{title:"Delete task log",children:(0,W.jsx)(C.Z,{onClick:function(){(0,J.o)().delete("/api/jobs/".concat(e.uuid,"/tasks/").concat(n.uuid)).then((function(e){window.location.reload()})).catch((function(e){(0,O.yv)(e.message,{variant:"error"})}))},children:(0,W.jsx)(u.Z,{})})})]})})]},n.uuid)}))})]})})})})},"".concat(e.uuid,"_details"))]}))})]}),Z.length>0&&(0,W.jsx)(Y.Z,{variant:"outlined",shape:"rounded",page:x,onChange:function(e,n){m(n)},sx:{marginTop:2,float:"right"}})]})]}),H&&(0,W.jsx)(ie,{open:H,modalType:Q,onCancel:se,jobId:X,onOk:se}),ae&&(0,W.jsx)(B,{open:ae,onClose:function(){return le(!1)}})]})}}}]);