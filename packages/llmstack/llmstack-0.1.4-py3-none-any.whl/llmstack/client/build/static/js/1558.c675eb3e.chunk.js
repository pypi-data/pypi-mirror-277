"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[1558,982,364],{30982:function(n,e,i){i.d(e,{Ob:function(){return h},Rt:function(){return c},Vm:function(){return v},XZ:function(){return l},hP:function(){return p},sA:function(){return u},us:function(){return d}});var t=i(60136),o=i(29388),s=i(43144),r=i(15671),a=function(){function n(e,i,t){(0,r.Z)(this,n),this.id=e||Math.random().toString(36).substring(2),this.requestId=i,this.type=null,this.content=null,this.timestamp=new Date,this.hash=null,t&&(this.content=t),this.content&&!this.hash&&(this.hash=this._buildHash())}return(0,s.Z)(n,[{key:"_buildHash",value:function(){for(var n=JSON.stringify(this.content,Object.keys(this.content).sort()),e=0,i=0;i<n.length;i++){e=(e<<5)-e+n.charCodeAt(i),e&=e}return e.toString()}},{key:"clone",value:function(){var n=this.timestamp,e=new this.constructor(this.id,this.content);return e.timestamp=n,e.requestId=this.requestId,e}}]),n}(),l=function(n){(0,t.Z)(i,n);var e=(0,o.Z)(i);function i(n,t,o){var s;return(0,r.Z)(this,i),(s=e.call(this,n,t,o)).type="user",s}return(0,s.Z)(i)}(a),u=function(n){(0,t.Z)(i,n);var e=(0,o.Z)(i);function i(n,t,o,s){var a;return(0,r.Z)(this,i),(a=e.call(this,n,t,o)).type="app",a.replyTo=s,a}return(0,s.Z)(i)}(a),d=function(n){(0,t.Z)(i,n);var e=(0,o.Z)(i);function i(n,t,o,s){var a;return(0,r.Z)(this,i),(a=e.call(this,n,t,o)).type="error",a.replyTo=s,a}return(0,s.Z)(i)}(a),c=function(n){(0,t.Z)(i,n);var e=(0,o.Z)(i);function i(n,t,o,s){var a;return(0,r.Z)(this,i),(a=e.call(this,n,t,o,s)).subType="agent",a}return(0,s.Z)(i)}(u),p=function(n){(0,t.Z)(i,n);var e=(0,o.Z)(i);function i(n,t,o,s){var a,l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,r.Z)(this,i),(a=e.call(this,n,t,o,s)).subType="agent-step",a.isRunning=l,a}return(0,s.Z)(i)}(u),h=function(n){(0,t.Z)(i,n);var e=(0,o.Z)(i);function i(n,t,o,s){var a;return(0,r.Z)(this,i),(a=e.call(this,n,t,o,s)).subType="agent-step-error",a}return(0,s.Z)(i)}(u),v=function(){function n(){(0,r.Z)(this,n),this.messages={}}return(0,s.Z)(n,[{key:"add",value:function(n){if(n.id)if(this.messages.hasOwnProperty(n.id)){var e=this.messages[n.id].clone();e.content=n.content,e.hash=n.hash,n.hasOwnProperty("isRunning")&&(e.isRunning=n.isRunning),this.messages[n.id]=e}else this.messages[n.id]=n}},{key:"get",value:function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object.values(this.messages).sort((function(e,i){return n?i.timestamp-e.timestamp:e.timestamp-i.timestamp}))}},{key:"clear",value:function(){this.messages={}}}]),n}()},38500:function(n,e,i){i.r(e);var t=i(37762),o=i(7276),s=i(31342),r=i(34199),a=i(9229),l=i(83825),u=i(30982),d=i(25926),c=i(18763),p=i(81792),h=i(93411),v=i(45263);e.default=function(n){var e,i,f,g,x,m,y,Z,b=n.sessionData,j=n.noHeader,w=void 0!==j&&j,k=n.skipSteps,S=void 0!==k&&k,C=null===b||void 0===b?void 0:b.store_app,_=(null===b||void 0===b||null===(e=b.metadata)||void 0===e?void 0:e.render_as_web_page)||!1,T=(null===C||void 0===C||null===(i=C.data)||void 0===i?void 0:i.type_slug)||"agent",I=(0,a.Zl)(d.qY),P=(0,o.useMemo)((function(){return new l.Kj}),[]),R=(0,o.useCallback)((function(n,e){var i,t,o,s=null===C||void 0===C||null===(i=C.data)||void 0===i||null===(t=i.processors)||void 0===t||null===(o=t.find((function(n){return n.id===e})))||void 0===o?void 0:o.output_template;return s?P.renderSync(P.parse(s.markdown),n):JSON.stringify(n)}),[null===C||void 0===C||null===(f=C.data)||void 0===f?void 0:f.processors,P]);(0,o.useEffect)((function(){var n,e,i,o,s,r=[],a=(0,t.Z)((null===b||void 0===b?void 0:b.run_entry_requests)||[]);try{for(a.s();!(n=a.n()).done;){var l,d=n.value;if(r.push(new u.XZ(null,d.request_uuid,(null===(l=d.request_body)||void 0===l?void 0:l.input)||{})),"agent"===T&&!S){var c,p=(0,t.Z)(d.processor_runs);try{for(p.s();!(c=p.n()).done;){var h=c.value;r.push(new u.hP(null,null,{name:h.processor_id||"",arguments:JSON.stringify(h.input),output:R(h.output,h.processor_id)},null,!1))}}catch(v){p.e(v)}finally{p.f()}}r.push("agent"===T?new u.Rt(null,d.request_uuid,d.response_body):new u.sA(null,d.request_uuid,d.response_body))}}catch(v){a.e(v)}finally{a.f()}C&&I({messages:r,assistantImage:(null===(e=C.data)||void 0===e||null===(i=e.config)||void 0===i?void 0:i.assistant_image)||"",inputFields:(null===(o=C.data)||void 0===o?void 0:o.input_fields)||[],processors:(null===(s=C.data)||void 0===s?void 0:s.processors)||[]})}),[b,T,I,R,S,C,null===C||void 0===C||null===(g=C.data)||void 0===g||null===(x=g.config)||void 0===x?void 0:x.assistant_image,null===C||void 0===C||null===(m=C.data)||void 0===m?void 0:m.input_fields,null===C||void 0===C||null===(y=C.data)||void 0===y?void 0:y.processors]);var q=(0,o.useMemo)((function(){var n,e;return(0,v.jsx)(p.default,{noInput:!0,children:_?h.webPageRenderLayout:(null===C||void 0===C||null===(n=C.data)||void 0===n||null===(e=n.config)||void 0===e?void 0:e.layout)||("web"===T?h.defaultWorkflowLayout:h.defaultChatLayout)})}),[C,T,_]);return C?(0,v.jsxs)(r.Z,{container:!0,spacing:1,direction:"column",sx:{height:"100%"},children:[!w&&(0,v.jsx)(r.Z,{children:(0,v.jsx)(c.default,{name:C.name,icon:C.icon128,username:C.username,description:C.description,categories:C.categories,appTypeSlug:(null===C||void 0===C||null===(Z=C.data)||void 0===Z?void 0:Z.type_slug)||"agent",appStoreUuid:C.uuid,shareHeader:!0})}),(0,v.jsx)(r.Z,{sx:{flex:1,padding:4,paddingBottom:0,height:0,overflow:"auto"},children:q}),(0,v.jsx)(s.Z,{variant:"contained",component:"a",sx:{margin:2},href:"/a/".concat(C.slug),children:"Try it out now!"})]}):null}},18763:function(n,e,i){i.r(e),i.d(e,{default:function(){return L}});var t=i(29439),o=i(7276),s=i(10981),r=i(66161),a=i(85535),l=i(44570),u=i(31342),d=i(73462),c=i(29166),p=i(14354),h=i(51073),v=i(91761),f=i(77801),g=i(9229),x=i(25926),m=i(81792),y=i(93433),Z=i(95173),b=i(83329),j=i(54560),w=i(969),k=i(46650),S=i(44390),C=i(20495),_=i(7458),T=i(62263),I=i(98125),P=i(55241),R=i(34160),q=i(63130),z=i(63716),F=i(83960),O=i(84817),E=i(45263);function W(n){var e=n.open,i=n.onClose,s=n.appTypeSlug,d=n.appStoreUuid,c=(0,g.sJ)(x.qY),p=(0,g.sJ)(x.nC),h=(0,g.sJ)(x.Rd),v=(0,o.useState)(""),f=(0,t.Z)(v,2),W=f[0],A=f[1],H=(0,Z.s0)(),L=(0,o.useState)(null),N=(0,t.Z)(L,2),J=N[0],M=N[1],D=(0,o.useState)(!1),U=(0,t.Z)(D,2),B=U[0],V=U[1],Y=(0,o.useState)(!1),G=(0,t.Z)(Y,2),X=G[0],K=G[1],Q=(0,o.useState)(!1),$=(0,t.Z)(Q,2),nn=$[0],en=$[1],tn=function(n){return n?"".concat(window.location.protocol,"//").concat(window.location.host,"/s/").concat(n):window.location.href},on=function(n){n.stopPropagation(),i()};return(0,E.jsxs)(j.Z,{title:"Share",open:e,onClose:on,fullWidth:!0,onClick:function(n){return n.stopPropagation()},maxWidth:"xs",children:[(0,E.jsx)(w.Z,{id:"app-share-modal",children:"Share"}),(0,E.jsxs)(k.Z,{children:[(0,E.jsx)(a.Z,{variant:"body1",children:null!==c&&void 0!==c&&c.sessionId&&!W?"Share the output from this app run by clicking on the create link button to generate a shareable url.":!W&&"Share this app using the link below or by clicking on the social media buttons."}),W&&(0,E.jsx)(r.Z,{sx:{marginTop:2,marginBottom:4},children:(0,E.jsx)(a.Z,{variant:"body1",children:"Share this app session using the link below or use the buttons to share on social media."})}),(null===c||void 0===c?void 0:c.sessionId)&&(0,E.jsx)(r.Z,{sx:{maxHeight:"300px",overflow:"auto",border:"solid 1px",borderColor:"gray.main",marginTop:2,borderRadius:2,padding:2},children:"web"===s?(0,E.jsx)(m.PromptlyAppWorkflowOutput,{showHeader:!1}):(0,E.jsx)(m.PromptlyAppChatOutput,{})}),(W||!W&&!c.sessionId)&&(0,E.jsxs)(r.Z,{sx:{paddingTop:4,display:"inline-table"},children:[(0,E.jsx)(S.Z,{label:"Share URL",value:tn(W),fullWidth:!0,variant:"outlined",size:"medium",InputProps:{readOnly:!0,endAdornment:(0,E.jsx)(l.Z,{onClick:function(n){navigator.clipboard.writeText(tn(W)),(0,F.yv)("Share code copied successfully",{variant:"success"})},children:(0,E.jsx)(C.Z,{title:"Copy Share URL",children:(0,E.jsx)(q.Z,{fontSize:"small"})})})}}),(0,E.jsx)(a.Z,{variant:"caption",children:"Share the link with others to view the output from this app run"}),(0,E.jsxs)(_.Z,{direction:"row",gap:2,sx:{paddingTop:2},children:[(0,E.jsx)(b.Dk,{url:tn(W),children:(0,E.jsx)(b.Vq,{size:30,round:!0})}),(0,E.jsx)(b.Zh,{url:tn(W),children:(0,E.jsx)(b.v2,{size:30,round:!0})}),(0,E.jsx)(b.r2,{url:tn(W),children:(0,E.jsx)(b.pA,{size:30,round:!0})}),(0,E.jsx)(b.MC,{url:tn(W),children:(0,E.jsx)(b.cH,{size:30,round:!0})}),(0,E.jsx)(b.tq,{url:tn(W),children:(0,E.jsx)(b.YG,{size:30,round:!0})}),(0,E.jsx)(b.N0,{url:tn(W),children:(0,E.jsx)(b.ud,{size:30,round:!0})}),(0,E.jsx)(b.B,{url:tn(W),title:"Check this app on Promptly!\n\n",via:"TryPromptly",children:(0,E.jsx)(b.b0,{size:30,round:!0})})]})]}),!W&&(null===c||void 0===c?void 0:c.sessionId)&&(0,E.jsx)(r.Z,{sx:{paddingTop:4},children:(0,E.jsx)(T.Z,{children:(0,E.jsx)(C.Z,{title:"When checked, the output will be rendered as a web page irrespective of the app's layout",children:(0,E.jsx)(I.Z,{control:(0,E.jsx)(P.Z,{checked:nn,size:"small"}),label:"Render the output as a web page",onChange:function(n){return en(n.target.checked)}})})})})]}),(0,E.jsxs)(R.Z,{children:[(0,E.jsx)(u.Z,{onClick:on,children:"Cancel"},"cancel"),!W&&(0,E.jsx)(z.Z,{variant:"contained",type:"primary",onClick:function(n){null!==c&&void 0!==c&&c.sessionId?function(n,e,i,t){if(n.stopPropagation(),i&&e){if(W)return navigator.clipboard.writeText(tn(W)),void(0,F.yv)("Link copied to clipboard",{variant:"success"});K(!0);var o=(null===c||void 0===c?void 0:c.messages)||[],s=(0,y.Z)(new Set(o.map((function(n){return n.requestId})).filter((function(n){return n})))),r={session_id:e,app_store_uuid:d,run_entry_request_uuids:s,render_as_web_page:t};(0,O.o)().post("/api/apps/share/",r).then((function(n){navigator.clipboard.writeText(tn(n.data.code)),A(n.data.code),(0,F.yv)("Link copied to clipboard",{variant:"success"})})).catch((function(n){console.error("Error sharing app run",n),(0,F.yv)("Error sharing app run",{variant:"error"})})).finally((function(){K(!1)}))}else{var a="/"===window.location.path?window.location.href+"a/super-agent":window.location.href;navigator.clipboard.writeText(a),(0,F.yv)("Link copied to clipboard",{variant:"success"})}}(n,null===c||void 0===c?void 0:c.sessionId,p,nn):on(n)},loading:X,disabled:null===c||void 0===c?void 0:c.isRunning,children:null!==c&&void 0!==c&&c.sessionId?"Create Link":"Done"},"submit"),W&&!(null!==h&&void 0!==h&&h.username)&&(0,E.jsx)(z.Z,{variant:"contained",type:"primary",onClick:function(n){return H("/s/".concat(W))},loading:X,disabled:null===c||void 0===c?void 0:c.isRunning,children:"View Session"},"submit"),W&&(null===h||void 0===h?void 0:h.username)&&(0,E.jsx)(z.Z,{variant:"contained",type:"primary",onClick:function(n){J?H("/u/".concat(h.username,"/").concat(J)):null!==c&&void 0!==c&&c.sessionId?function(n,e,i){n.stopPropagation(),i&&e&&h&&h.username?(V(!0),(0,O.o)().post("/api/profiles/".concat(h.username,"/posts"),{share_code:W}).then((function(n){var e,i;M(null===n||void 0===n||null===(e=n.data)||void 0===e||null===(i=e.share)||void 0===i?void 0:i.slug),(0,F.yv)("App run pinned to profile",{variant:"success"})})).catch((function(n){console.error("Error pinning app run",n),(0,F.yv)("Error pinning app run",{variant:"error"})})).finally((function(){V(!1)}))):(0,F.yv)("You must be logged in and have your username set to pin an app run",{variant:"error"})}(n,null===c||void 0===c?void 0:c.sessionId,p):on(n)},loading:B,disabled:(null===c||void 0===c?void 0:c.isRunning)||B,children:J?"View on Profile":null!==c&&void 0!==c&&c.sessionId?"Pin to Profile":"Done"},"pin")]})]})}var A=(0,f.ZP)("img")({width:80,height:80,margin:0,borderRadius:8}),H=(0,f.ZP)("img")({width:35,height:35,margin:0,borderRadius:4});var L=function(n){var e=n.name,i=n.icon,f=n.username,y=n.description,Z=n.categories,b=n.appStoreUuid,j=n.appTypeSlug,w=n.shareHeader,k=void 0!==w&&w,S=(0,g.sJ)(x.lo),C=(0,o.useState)(!k&&!S),_=(0,t.Z)(C,2),T=_[0],I=_[1],P=(0,o.useState)(!1),R=(0,t.Z)(P,2),q=R[0],z=R[1],F=(0,g.sJ)(x.N0),O=(0,o.useCallback)((function(n){return F.find((function(e){return e.slug===n}))}),[F]);return(0,E.jsxs)(s.Z,{sx:{backgroundColor:"#F3F5F8",cursor:"pointer",boxShadow:"none",display:"flex",flexDirection:"column",border:"1px solid #E8EBEE",borderRadius:"8px 8px 0 0",p:T?6:4,gap:4,height:T?"auto":S?"40px":"72px"},onClick:function(){return I(!T)},children:[(0,E.jsx)(W,{open:q,onClose:function(){return z(!1)},appTypeSlug:j,appStoreUuid:b}),(0,E.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",textAlign:"left",width:"100%"},children:[!T&&(0,E.jsxs)(r.Z,{sx:{display:"flex",width:"100%",gap:4,alignItems:"center"},children:[(0,E.jsx)(H,{src:i,alt:e}),(0,E.jsx)(r.Z,{sx:{alignSelf:"center",width:"100%"},children:(0,E.jsxs)(r.Z,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,E.jsx)(a.Z,{component:"h1",color:"#183A58",sx:{fontSize:"20px",lineHeight:"24px",fontWeight:600},children:e}),k&&(T?(0,E.jsx)(p.Z,{}):(0,E.jsx)(h.Z,{})),!k&&(0,E.jsx)(l.Z,{sx:{color:"#FFF",ml:"auto",mr:S?"-4px":"0px",backgroundColor:"primary.main",":hover":{backgroundColor:"primary.dark"},borderRadius:"8px"},onClose:function(){return z(!0)},onClick:function(n){n.stopPropagation(),z(!0)},children:(0,E.jsx)(v.Z,{fontSize:"small",variant:"contained"})})]})})]}),T&&(0,E.jsxs)(r.Z,{sx:{display:"flex",width:"100%",gap:4,alignItems:"center"},children:[(0,E.jsx)(A,{src:i,alt:e}),(0,E.jsxs)(r.Z,{sx:{width:"100%"},children:[(0,E.jsxs)(r.Z,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,E.jsx)(a.Z,{component:"h1",sx:{fontSize:"20px",lineHeight:"24px",fontWeight:600},children:e}),k&&(T?(0,E.jsx)(p.Z,{}):(0,E.jsx)(h.Z,{})),!k&&(S?(0,E.jsx)(l.Z,{sx:{color:"#FFF",ml:"auto",mr:"-4px",backgroundColor:"primary.main",":hover":{backgroundColor:"primary.dark"},borderRadius:"8px"},onClose:function(){return z(!0)},onClick:function(n){n.stopPropagation(),z(!0)},children:(0,E.jsx)(v.Z,{fontSize:"small",variant:"contained"})}):(0,E.jsx)(u.Z,{variant:"contained",sx:{ml:"auto",mr:"-4px",color:"#FFF"},startIcon:(0,E.jsx)(v.Z,{fontSize:"small"}),onClick:function(n){n.stopPropagation(),z(!0)},children:"Share"}))]}),(0,E.jsx)("span",{style:{color:"gray"},children:"by\xa0"}),(0,E.jsx)(a.Z,{color:"corral.main",sx:{display:"inline"},children:f}),(0,E.jsx)(r.Z,{sx:{mt:1,mb:1,ml:-.4},children:Z&&Z.map((function(n){var e;return(0,E.jsx)(d.Z,{label:(null===(e=O(n))||void 0===e?void 0:e.name)||n,size:"small",sx:{borderRadius:2,padding:"4px, 8px, 4px, 8px",backgroundColor:"#FFF",border:1,color:"#183A58",borderColor:"gray.main"}},n)}))})]})]})]}),(0,E.jsx)(r.Z,{sx:{textAlign:"left",lineHeight:"1.6",color:"#183a58","& p":{mt:0,ml:0,marginBlockEnd:0}},children:(0,E.jsx)(c.Z,{in:T,timeout:"auto",unmountOnExit:!0,children:(0,E.jsx)(m.default,{children:y})})})]})}},98085:function(n,e,i){i.d(e,{Ws:function(){return s}});var t=i(15671),o=i(43144),s=function(){function n(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,t.Z)(this,n),this.url=e,this.ws=null,this.binaryType=i,this.onMessage=null,this.queue=[]}return(0,o.Z)(n,[{key:"status",value:function(){return this.ws.readyState}},{key:"connect",value:function(){var n=this;this.ws=new WebSocket(this.url),this.binaryType&&(this.ws.binaryType=this.binaryType),this.ws.onmessage=this.onMessage,this.ws.onopen=function(){n.queue.forEach((function(e){n.ws.send(e)})),n.queue=[],console.log("Websocket connected: ".concat(n.url))},this.ws.onclose=function(){console.log("Websocket closed: ".concat(n.url))}}},{key:"send",value:function(n){null===this.ws&&this.connect(),this.ws.readyState===WebSocket.CONNECTING?this.queue.push(n):this.ws.readyState===WebSocket.OPEN?this.ws.send(n):(this.queue.push(n),this.connect())}},{key:"close",value:function(){var n;null===(n=this.ws)||void 0===n||n.close()}},{key:"setOnMessage",value:function(n){this.onMessage=n}}]),n}()}}]);