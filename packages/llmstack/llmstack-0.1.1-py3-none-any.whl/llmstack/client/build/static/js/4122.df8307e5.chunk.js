"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[4122,1504,404],{41504:function(e,n,t){t.r(n);var i=t(45987),r=t(29439),a=t(1413),o=t(16390),l=t(60103),s=t(54730),u=t(32399),c=t(68134),d=t(92628),f=t(97519),x=t(73462),h=t(49305),p=t(25861),v=t(52720),Z=t(66161),m=t(85535),j=t(76399),y=t(22644),g=t(62652),b=t(7276),S=t(45263),C=["schema","uiSchema","formData","onChange","submitBtn","theme","validator","templates","widgets","disableAdvanced"],k=(0,b.lazy)((function(){return Promise.all([t.e(9907),t.e(2580),t.e(6783)]).then(t.bind(t,62580))})),w=(0,b.lazy)((function(){return t.e(1393).then(t.bind(t,63890))})),_=(0,b.lazy)((function(){return t.e(935).then(t.bind(t,80935))})),D=(0,b.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(5539),t.e(111),t.e(4880),t.e(686),t.e(6374)]).then(t.bind(t,16374))})),z=(0,b.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(111),t.e(3667),t.e(6279),t.e(7458)]).then(t.bind(t,96279))})),E=(0,b.lazy)((function(){return Promise.all([t.e(7420),t.e(2341)]).then(t.bind(t,16214))})),A=(0,b.lazy)((function(){return Promise.all([t.e(6419),t.e(2789),t.e(3960),t.e(9921),t.e(5539),t.e(111),t.e(4880),t.e(686),t.e(5831)]).then(t.bind(t,75831))})),O=(0,b.lazy)((function(){return t.e(8781).then(t.bind(t,68781))})),P=(0,b.lazy)((function(){return t.e(6317).then(t.bind(t,6317))})),T=(0,b.lazy)((function(){return t.e(4843).then(t.bind(t,64843))})),R=(0,b.lazy)((function(){return Promise.all([t.e(2789),t.e(111),t.e(2384)]).then(t.bind(t,12384))})),N=(0,b.lazy)((function(){return t.e(7437).then(t.bind(t,97437))})),F=(0,b.lazy)((function(){return Promise.all([t.e(7902),t.e(7533)]).then(t.bind(t,57533))}));function L(e){return(0,S.jsx)(A,(0,a.Z)({},e))}function I(e){return(0,S.jsx)(P,(0,a.Z)({},e))}function M(e){var n=e.id,t=e.children,i=e.classNames,a=e.style,o=e.disabled,u=e.displayLabel,c=e.hidden,d=e.label,f=e.onDropPropertyClick,x=e.onKeyChange,h=e.readonly,p=e.required,v=e.rawErrors,Z=void 0===v?[]:v,m=e.errors,j=e.help,y=e.rawDescription,C=e.schema,k=e.uiSchema,w=e.registry,_=(0,b.useState)(!1),D=(0,r.Z)(_,2),z=D[0],E=D[1],A=(0,g.LI)(k),O=(0,g.t4)("WrapIfAdditionalTemplate",w,A);return c?(0,S.jsx)("div",{style:{display:"none"},children:t}):(0,S.jsx)(O,{classNames:i,style:a,disabled:o,id:n,label:d,onDropPropertyClick:f,onKeyChange:x,readonly:h,required:p,schema:C,uiSchema:k,registry:w,children:(0,S.jsxs)(l.Z,{fullWidth:!0,error:!!Z.length,required:p,onFocus:function(e){E(!0)},onBlur:function(e){E(!1)},children:[t,u&&y?(0,S.jsx)(s.Z,{id:n,focused:z,children:y}):null,m,j]})})}function W(e){var n=e.options,t=e.registry,i=(0,g.t4)("BaseInputTemplate",t,n),r=5;return"string"!==typeof n.rows&&"number"!==typeof n.rows||(r=n.rows),(0,S.jsx)(i,(0,a.Z)((0,a.Z)({sx:{"& .MuiOutlinedInput-root":{"& > fieldset":{border:"1px solid rgb(204, 204, 204)"}}}},e),{},{multiline:!0,rows:r,variant:"outlined"}))}function B(e){return(0,S.jsx)(R,(0,a.Z)({},e))}function U(e){return(0,S.jsx)(E,(0,a.Z)({},e))}function J(e){var n=e.chat_message;if(n.content)return(0,S.jsx)(u.Z,{primary:n.content});if(n.function_call){var t=n.function_call.name,i=JSON.parse(n.function_call.arguments),r=Object.keys(i).map((function(e){return"".concat(e,'="').concat(i[e],'"')})).join(",");return(0,S.jsx)("div",{children:(0,S.jsx)(u.Z,{primary:"Function",secondary:"".concat(t,"(").concat(r,")")})})}return null}var V=function(e){var n=e.value||[],t=0;return"string"===typeof n&&(n=[{content:n}]),(0,S.jsx)(c.Z,{className:"output-chat",style:{paddingTop:0},children:n.map((function(e){return(0,S.jsxs)(d.ZP,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",background:"rgb(255, 250, 236)",border:"1px solid rgb(235, 230, 236)",borderRadius:10},children:[(0,S.jsx)(f.Z,{children:(0,S.jsx)(x.Z,{color:"primary",label:e.role||"System"})}),(0,S.jsx)(J,{chat_message:e})]},t++)}))})},q=function(e){var n=e.value||[],t=0;return(0,S.jsx)(c.Z,{className:"output-text",style:{paddingTop:0},children:n.map((function(e){return(0,S.jsx)(d.ZP,{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",background:"rgb(255, 250, 236)",border:"1px solid rgb(235, 230, 236)",borderRadius:10},children:(0,S.jsx)(u.Z,{primary:e})},t++)}))})},H=function(e){var n=0;return(0,S.jsx)(h.Z,{className:"output-image",cols:2,gap:8,children:e.value.map((function(e){return(0,S.jsx)(p.Z,{children:(0,S.jsx)("img",{src:"".concat(e),loading:"lazy",alt:""})},n++)}))})},K=function(e){return(0,S.jsx)("audio",{src:e.value,controls:!0})},Y=function(e){return(0,S.jsx)(_,(0,a.Z)((0,a.Z)({},e),{},{disableAdvanced:!1}))},G=function(e){return(0,S.jsx)(_,(0,a.Z)((0,a.Z)({},e),{},{disableAdvanced:!0}))},X=function(e){return(0,S.jsx)(O,(0,a.Z)({},e))},Q=function(e){return(0,S.jsx)(D,(0,a.Z)({},e))},$=function(e){return(0,S.jsx)(k,(0,a.Z)((0,a.Z)({},e),{},{richText:!0}))},ee=function(e){return(0,S.jsx)(z,(0,a.Z)({},e))},ne=function(e){return(0,S.jsx)(w,(0,a.Z)({},e))},te=function(e){var n=e.errors;return(0,S.jsx)(v.Z,{elevation:2,children:(0,S.jsxs)(Z.Z,{mb:2,p:2,children:[(0,S.jsx)(m.Z,{variant:"h6",children:"Errors"}),(0,S.jsx)(c.Z,{dense:!0,children:n.map((function(e,n){return(0,S.jsxs)(d.ZP,{dense:!0,children:[(0,S.jsx)(j.Z,{children:(0,S.jsx)(o.Z,{color:"error"})}),(0,S.jsx)(u.Z,{primary:e.message})]},n)}))})]})})};n.default=function(e){var n=e.schema,t=e.uiSchema,r=e.formData,o=e.onChange,l=e.submitBtn,s=void 0===l?(0,S.jsx)("div",{}):l,u=(e.theme,e.validator),c=e.templates,d=void 0===c?{}:c,f=e.widgets,x=void 0===f?{}:f,h=e.disableAdvanced,p=void 0!==h&&h,v=(0,i.Z)(e,C),Z=v.createAsset;(0,b.useEffect)((function(){var e,n,t;null!==(e=v.formRef)&&void 0!==e&&null!==(n=e.current)&&void 0!==n&&null!==(t=n.formElement)&&void 0!==t&&t.current&&v.formRef.current.formElement.current.addEventListener("submit",(function(e){e.preventDefault()}))}),[v.formRef]);var m=(0,b.useCallback)((function(e){var n;return null!==e&&void 0!==e&&null!==(n=e.schema)&&void 0!==n&&n.stream?(0,S.jsx)(F,(0,a.Z)((0,a.Z)({},e),{},{createAsset:Z,formRef:v.formRef})):(0,S.jsx)(T,(0,a.Z)({},e))}),[Z,v.formRef]);return(0,S.jsx)(y.ZP,(0,a.Z)((0,a.Z)({ref:v.formRef},v),{},{schema:n,uiSchema:t,validator:u,formData:r,onChange:o,templates:(0,a.Z)({ErrorListTemplate:te,FieldTemplate:M,ObjectFieldTemplate:p?G:Y},d),fields:{multi:function(e){return(0,S.jsx)(N,(0,a.Z)((0,a.Z)({},e),{},{formRef:v.formRef,onCancel:v.onCancel}))}},widgets:(0,a.Z)((0,a.Z)({},{customselect:B,TextareaWidget:W,FileWidget:U,output_chat:V,output_text:q,output_image:H,output_audio:K,datasource:ee,gdrive:L,webpageurls:I,password:X,connection:Q,richtext:$,voice:m,app_version:ne}),x),transformErrors:null===v||void 0===v?void 0:v.transformErrors,children:s}))}},84811:function(e,n,t){t.d(n,{P:function(){return S}});var i=t(93433),r=t(1413),a=t(29439),o=t(54560),l=t(969),s=t(46650),u=t(7458),c=t(44390),d=t(42470),f=t(31342),x=t(34160),h=t(13366),p=t(83960),v=t(7276),Z=t(9229),m=t(25926),j=t(84817),y=t(46573),g=t(41504),b=t(45263);function S(e){var n=e.open,t=e.handleCancelCb,S=e.dataSourceAddedCb,C=e.modalTitle,k=void 0===C?"Add New Data Source":C,w=e.datasource,_=void 0===w?null:w,D=(0,Z.sJ)(m.TF),z=(0,v.useState)(null!==_&&void 0!==_&&_.name?_.name:""),E=(0,a.Z)(z,2),A=E[0],O=E[1],P=(0,v.useState)(!1),T=(0,a.Z)(P,2),R=T[0],N=T[1],F=(0,Z.FV)(m.NM),L=(0,a.Z)(F,2),I=L[0],M=L[1],W=(0,v.useState)(null!==_&&void 0!==_&&_.type?_.type:null===D||void 0===D?void 0:D[0]),B=(0,a.Z)(W,2),U=B[0],J=B[1],V=(0,v.useState)({}),q=(0,a.Z)(V,2),H=q[0],K=q[1],Y=(0,y.lD)();return(0,b.jsxs)(o.Z,{open:n,onClose:t,sx:{zIndex:900},children:[(0,b.jsx)(l.Z,{children:k}),(0,b.jsx)(s.Z,{children:(0,b.jsxs)(u.Z,{spacing:2,children:[(0,b.jsx)(c.Z,{label:"Data Source Name",value:A,onChange:function(e){return O(e.target.value)},disabled:!!_,required:!0,defaultValue:(null===_||void 0===_?void 0:_.name)||"Untitled",size:"small",style:{width:"100%",marginTop:"6px"},error:R}),(0,b.jsx)("span",{children:"Data Source Type"}),(0,b.jsx)(d.Z,{variant:"outlined",size:"small",style:{display:"inline-block"},disabled:!!_,children:D.map((function(e){return(0,b.jsx)(f.Z,{variant:(null===U||void 0===U?void 0:U.id)===e.id?"contained":"outlined",onClick:function(n){J(e)},children:e.name},e.id)}))}),(0,b.jsx)(g.default,{schema:(null===U||void 0===U?void 0:U.entry_config_schema)||{},validator:h.ZP,uiSchema:(0,r.Z)((0,r.Z)({},(null===U||void 0===U?void 0:U.entry_config_ui_schema)||{}),{"ui:submitButtonOptions":{norender:!0},"ui:DescriptionFieldTemplate":function(){return null},"ui:TitleFieldTemplate":function(){return null}}),formData:H,onChange:function(e){var n=e.formData;K(n)},disableAdvanced:!0})]})}),(0,b.jsxs)(x.Z,{children:[(0,b.jsx)(f.Z,{onClick:t,children:"Cancel"}),",",(0,b.jsx)(f.Z,{variant:"contained",onClick:function(){if(_)(0,j.o)().post("/api/datasources/".concat(_.uuid,"/add_entry_async"),{entry_data:H}).then((function(){Y(),(0,p.yv)("Processing Data, please refresh the page in a few minutes",{variant:"success"})})).catch((function(e){var n;(0,p.yv)("Failed to add entry. ".concat(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data),{variant:"error"})})).finally((function(){t()}));else{if(""===A)return void N(!0);(0,j.o)().post("/api/datasources",{name:A,type:U.id,config:U.is_external_datasource?H:{}}).then((function(e){if(!U.is_external_datasource){var n=e.data;M([].concat((0,i.Z)(I),[n])),(0,j.o)().post("/api/datasources/".concat(n.uuid,"/add_entry_async"),{entry_data:H}).then((function(e){S(n)}))}})),t(),(0,p.yv)("Processing Data, please refresh the page in a few minutes",{variant:"success"})}},children:"Submit"})]})]})}},34122:function(e,n,t){t.r(n),t.d(n,{DataSourceEntries:function(){return oe},default:function(){return le}});var i=t(1413),r=t(93433),a=t(29439),o=t(15411),l=t(21008),s=t(31982),u=t(51073),c=t(79288),d=t(23109),f=t(2146),x=t(45880),h=t(24528),p=t(43630),v=t(73462),Z=t(66161),m=t(20495),j=t(44570),y=t(18221),g=t(10567),b=t(78735),S=t(20888),C=t(34867),k=t(9340),w=t(62154),_=t(71516),D=t(85535),z=t(65173),E=t(31342),A=t(29166),O=t(24578),P=t(8568),T=t(4550),R=t.n(T),N=t(83960),F=t(7276),L=t(9229),I=t(84811),M=t(95142),W=t(6188),B=t(7458),U=t(6334),J=t(84817),V=t(45263);var q=function(e){var n=e.onCancel,t=e.dataSourceEntry,i=e.open,r=(0,F.useState)(null),o=(0,a.Z)(r,2),l=o[0],s=o[1],u=(0,F.useState)(null),c=(0,a.Z)(u,2),d=c[0],f=c[1],x=(0,F.useState)(!1),h=(0,a.Z)(x,2),p=h[0],m=h[1];return(0,F.useEffect)((function(){var e,n;null!==t&&void 0!==t&&null!==(e=t.config)&&void 0!==e&&e.document_ids?(0,J.o)().get("/api/datasource_entries/".concat(t.uuid,"/text_content")).then((function(e){var n,t;s((0,V.jsx)(M.u,{value:null===(n=e.data)||void 0===n?void 0:n.content,disabled:!0,autoSize:!0,style:{maxHeight:"80vh",width:"100%",overflow:"auto"}})),f(null===(t=e.data)||void 0===t?void 0:t.metadata)})).finally((function(){return m(!1)})):s((0,V.jsx)(M.u,{value:JSON.stringify(null===t||void 0===t||null===(n=t.config)||void 0===n?void 0:n.errors),disabled:!0,autoSize:!0,style:{maxHeight:"80vh",width:"100%",overflow:"auto"}}))}),[t]),(0,V.jsx)(W.ZP,{open:i,onClose:n,anchor:"right",sx:{"& .MuiDrawer-paper":{minWidth:"40%"},maxWidth:"40%"},children:(0,V.jsxs)(Z.Z,{children:[(0,V.jsxs)(B.Z,{direction:"row",gap:1,sx:{mb:"10px",mt:"10px"},children:[(0,V.jsx)(E.Z,{onClick:function(){return n()},sx:{alignSelf:"left"},children:"X"}),Object.keys(d||{}).map((function(e){return(0,V.jsx)(v.Z,{label:"".concat(e,": ").concat(d[e]),size:"small",sx:{borderRadius:"10px",marginTop:"5px"}},e)}))]}),(0,V.jsx)(U.Z,{}),p?(0,V.jsx)(O.Z,{}):(0,V.jsx)("div",{style:{margin:"0px 10px"},children:l})]})})},H=t(54560),K=t(969),Y=t(46650),G=t(26235),X=t(49321),Q=t(34160);function $(e){var n=e.id,t=e.open,i=e.onOk,r=e.onCancel,o=e.title,l=e.dataSource,s=F.useState(null===l||void 0===l?void 0:l.visibility),u=(0,a.Z)(s,2),c=u[0],d=u[1];return(0,V.jsxs)(H.Z,{open:t,onClose:function(){return r(n)},"aria-labelledby":"share-datasource-dialog-title","aria-describedby":"share-datasource-dialog-description",children:[(0,V.jsx)(K.Z,{id:"share-datasource-dialog-title",children:o}),(0,V.jsx)(Y.Z,{style:{minWidth:"500px"},children:(0,V.jsxs)(B.Z,{spacing:2,children:[(0,V.jsx)("h4",{children:"Choose who can access this datasource"}),(0,V.jsx)(G.Z,{labelId:"share-datasource-select-label",size:"small",defaultValue:void 0===(null===l||void 0===l?void 0:l.visibility)?1:null===l||void 0===l?void 0:l.visibility,onChange:function(e){d(e.target.value)},children:[{value:1,label:"Organization",description:"Members of your organization can access this datasource"},{value:0,label:"You",description:"Only you can access this datasource"}].map((function(e){return(0,V.jsx)(X.Z,{value:e.value,children:(0,V.jsxs)(B.Z,{direction:"row",spacing:1,children:[(0,V.jsx)("span",{children:e.label}),(0,V.jsx)("small",{children:e.description})]})},e.value)}))})]})}),(0,V.jsxs)(Q.Z,{children:[(0,V.jsx)(E.Z,{onClick:function(){return r(n)},children:"Cancel"}),(0,V.jsx)(E.Z,{variant:"contained",onClick:function(){return function(){var e="noop";c!==l.visibility?0===l.visibility&&1===c?(0,J.o)().post("api/org/datasources/".concat(l.uuid,"/add_entry")).then((function(n){i(e,l)})):1===l.visibility&&0===c?(0,J.o)().delete("api/org/datasources/".concat(l.uuid)).then((function(n){i(e,l)})):i(e,l):i(e,l)}()},children:"Done"})]})]})}var ee=t(12283);function ne(e){var n=e.id,t=e.open,i=e.onOk,r=e.onCancel,a=e.title,o=e.text;return(0,V.jsxs)(H.Z,{title:a||"Logged Out",open:t,onCancel:r,children:[(0,V.jsx)(K.Z,{id:"delete-modal-title",children:"Confirm Delete"}),(0,V.jsx)(Y.Z,{children:(0,V.jsx)(ee.Z,{children:o})}),(0,V.jsxs)(Q.Z,{children:[(0,V.jsx)(E.Z,{onClick:function(){return r(n)},children:"Cancel"},"cancel"),",",(0,V.jsx)(E.Z,{variant:"contained",type:"primary",onClick:function(){return i(n)},children:"Confirm"},"submit"),","]})]})}function te(e){var n=new Date(e.value);return(0,V.jsx)("span",{children:n.toLocaleString()})}function ie(e){for(var n=e.value,t=["","K","M","G","T","P","E","Z","Y"],i=0;n>=1024;)n/=1024,i+=1;return(0,V.jsx)("span",{children:n>0?n.toFixed(2)+" "+t[i]:n+" "+t[i]})}var re=t(25926),ae=t(46573);function oe(e){var n=e.dataSourceEntryData,t=e.onDatasourceEntryDelete,i=void 0===t?function(){}:t,u=(0,F.useState)(!1),c=(0,a.Z)(u,2),d=c[0],f=c[1],x=(0,F.useState)(null),h=(0,a.Z)(x,2),p=h[0],D=h[1],z=(0,F.useState)(!1),E=(0,a.Z)(z,2),A=E[0],O=E[1],P=(0,F.useState)(new Set),T=(0,a.Z)(P,2),L=T[0],I=T[1],M=(0,ae.lD)(),W=[{title:"Name",key:"name"},{title:"Size",key:"size",render:function(e){return(0,V.jsx)(ie,{value:e})}},{title:"Status",key:"status",render:function(e,n){var t="success";return t="FAILED"===e?"error":"READY"===e?"success":"info",(0,V.jsx)(v.Z,{color:t,style:{cursor:"pointer"},label:n.status.charAt(0)+n.status.slice(1).toLowerCase(),size:"small"},n.uuid)}},{title:"Created At",key:"created_at",render:function(e){return(0,V.jsx)(te,{value:e})}},{title:"Last Modified",key:"updated_at",render:function(e){return R()(e).fromNow()}},{title:"Action",key:"operation",render:function(e,n){var t,i,a,u,c,d,x,h,p=("READY"===(null===n||void 0===n?void 0:n.status)||"ERROR"===(null===n||void 0===n?void 0:n.status))&&("file"===(null===n||void 0===n||null===(t=n.datasource)||void 0===t||null===(i=t.type)||void 0===i?void 0:i.name.toLowerCase())||"pdf"===(null===n||void 0===n||null===(a=n.datasource)||void 0===a||null===(u=a.type)||void 0===u?void 0:u.name.toLowerCase())||"url"===(null===n||void 0===n||null===(c=n.datasource)||void 0===c||null===(d=c.type)||void 0===d?void 0:d.name.toLowerCase())||"gdrive_file"===(null===n||void 0===n||null===(x=n.datasource)||void 0===x||null===(h=x.type)||void 0===h?void 0:h.name.toLowerCase()));return(0,V.jsxs)(Z.Z,{children:[(0,V.jsx)(m.Z,{title:"View contents",children:(0,V.jsx)(j.Z,{onClick:function(){f(!0),D(n)},disabled:L.has(n.uuid),children:(0,V.jsx)(o.Z,{})})}),p&&(0,V.jsx)(m.Z,{title:"Resync contents",children:(0,V.jsx)(j.Z,{onClick:function(){(0,N.yv)("Resyncing data source entry",{variant:"success"}),I((function(e){return new Set([].concat((0,r.Z)(e),[n.uuid]))})),(0,J.o)().post("/api/datasource_entries/".concat(n.uuid,"/resync")).then((function(e){M()})).catch((function(e){(0,N.yv)("Failed to resync data source entry",{variant:"error"})})).finally((function(){I((function(e){return new Set((0,r.Z)(e).filter((function(e){return e!==n.uuid})))}))}))},children:(0,V.jsx)(l.Z,{})})}),(0,V.jsx)(m.Z,{title:"Delete entry",children:(0,V.jsx)(j.Z,{onClick:function(){D(n),O(!0)},children:(0,V.jsx)(s.Z,{})})})]})}}];return 0===n.length?(0,V.jsx)(y.Z,{children:(0,V.jsxs)(g.Z,{severity:"info",sx:{maxWidth:"300px",margin:"0 auto"},children:[(0,V.jsx)(b.Z,{children:"No entries found"}),"Click on the ",(0,V.jsx)("strong",{children:"+"})," icon to add a new entry."]})}):(0,V.jsxs)(S.Z,{stickyHeader:!0,"aria-label":"sticky table contents",colSpan:7,children:[(0,V.jsx)(C.Z,{children:(0,V.jsx)(k.Z,{children:W.map((function(e){return(0,V.jsx)(w.Z,{sx:{padding:"5px 16px"},children:(0,V.jsx)("strong",{children:e.title})},e.key)}))})}),(0,V.jsx)(_.Z,{sx:{borderBottom:"none"},children:null===n||void 0===n?void 0:n.map((function(e,n){return(0,V.jsx)(k.Z,{role:"checkbox",tabIndex:-1,children:W.map((function(n){var t=e[n.key];return(0,V.jsx)(w.Z,{sx:{padding:"0 16px"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid)}))}),(0,V.jsx)(q,{onCancel:function(){return f(!1)},dataSourceEntry:p,open:d}),(0,V.jsx)(ne,{id:p,title:"Delete Data Source Entry",text:(0,V.jsxs)("div",{children:["Are you sure you want to delete"," ",(0,V.jsx)("span",{style:{fontWeight:"bold"},children:null===p||void 0===p?void 0:p.name})," ","?"]}),open:A,onOk:function(e){(0,J.o)().delete("/api/datasource_entries/".concat(e.uuid)).then((function(e){i(),M(),O(!1)}))},onCancel:function(){O(!1)}})]})}function le(){var e=(0,F.useState)(1),n=(0,a.Z)(e,2),t=n[0],o=n[1],l=(0,F.useState)(""),v=(0,a.Z)(l,2),y=v[0],g=v[1],b=(0,F.useState)(""),T=(0,a.Z)(b,2),N=T[0],M=T[1],W=(0,F.useState)(null),B=(0,a.Z)(W,2),U=B[0],q=B[1],H=(0,F.useState)(!1),K=(0,a.Z)(H,2),Y=K[0],G=K[1],X=(0,F.useState)(!1),Q=(0,a.Z)(X,2),ee=Q[0],le=Q[1],se=(0,F.useState)(!1),ue=(0,a.Z)(se,2),ce=ue[0],de=ue[1],fe=(0,L.sJ)(re.ye),xe=(0,L.FV)(re.MC),he=(0,a.Z)(xe,2),pe=he[0],ve=he[1],Ze=(0,L.FV)(re.DK),me=(0,a.Z)(Ze,2),je=me[0],ye=me[1],ge=(0,F.useState)(null),be=(0,a.Z)(ge,2),Se=be[0],Ce=be[1],ke=(0,F.useState)([]),we=(0,a.Z)(ke,2),_e=we[0],De=we[1],ze=(0,F.useState)("Add New Data Source"),Ee=(0,a.Z)(ze,2),Ae=Ee[0],Oe=Ee[1],Pe=(0,F.useState)(null),Te=(0,a.Z)(Pe,2),Re=Te[0],Ne=Te[1],Fe=(0,F.useState)(null),Le=(0,a.Z)(Fe,2),Ie=Le[0],Me=Le[1],We=(0,ae.lD)(),Be=(0,ae.B6)(),Ue=(0,L.sJ)(re.Jn);(0,F.useEffect)((function(){fe.length>0&&De((function(e){return fe.map((function(n){var t;return(0,i.Z)((0,i.Z)({},n),{},{expand:(null===(t=e.find((function(e){return e.uuid===n.uuid})))||void 0===t?void 0:t.expand)||!1})}))}))}),[fe]);var Je=[{title:"Name",key:"name",render:function(e,n){return(0,V.jsxs)(D.Z,{sx:{display:"flex",fontSize:"0.9rem",fontWeight:n.expand?"600":"inherit",gap:1},children:[n.expand?(0,V.jsx)(u.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}):(0,V.jsx)(c.Z,{fontSize:"10px",sx:{color:"#999",margin:"auto 0"}}),e]})}},{title:"Owner",key:"owner_email",render:function(e,n){return(0,V.jsx)("span",{children:n.isUserOwned?"me":n.owner_email})}},{title:"Data Source Type",key:"type",render:function(e){return(0,V.jsx)("span",{children:e.name})}},{title:"Size",key:"size",render:function(e){return(0,V.jsx)(ie,{value:e})}},{title:"Created At",key:"created_at",render:function(e){return(0,V.jsx)(te,{value:e})}},{title:"Last Modified",key:"updated_at",render:function(e){return R()(e).fromNow()}},{title:"Action",key:"operation",render:function(e,n){var t,i,r;return(0,V.jsxs)(Z.Z,{children:[(null===n||void 0===n||null===(t=n.type)||void 0===t?void 0:t.is_external_datasource)&&(0,V.jsx)(m.Z,{title:"Edit entry",children:(0,V.jsx)(j.Z,{disabled:!0,onClick:function(e){Oe("Edit Data Source"),G(!0),Ne(n),e.stopPropagation()},children:(0,V.jsx)(d.Z,{})})}),!(null!==n&&void 0!==n&&null!==(i=n.type)&&void 0!==i&&i.is_external_datasource)&&(0,V.jsx)(j.Z,{disabled:!n.isUserOwned,onClick:function(e){Oe("Add New Data Entry"),Ne(n),G(!0),e.stopPropagation()},children:(0,V.jsx)(f.Z,{})}),(null===n||void 0===n||null===(r=n.type)||void 0===r?void 0:r.is_external_datasource)&&(0,V.jsx)(m.Z,{title:"External Connection",children:(0,V.jsx)("span",{children:(0,V.jsx)(j.Z,{disabled:!0,children:(0,V.jsx)(x.Z,{})})})}),(0,V.jsx)(j.Z,{disabled:!n.isUserOwned,onClick:function(){q(n),g("Delete Data Source"),M((0,V.jsxs)("div",{children:["Are you sure you want to delete"," ",(0,V.jsx)("span",{style:{fontWeight:"bold"},children:n.name})," ?"]})),le(!0)},children:(0,V.jsx)(s.Z,{})}),Ue.IS_ORGANIZATION_MEMBER&&n.isUserOwned&&(0,V.jsx)(j.Z,{onClick:function(){Oe("Share Datasource"),Ne(n),de(!0)},children:0===n.visibility?(0,V.jsx)(h.Z,{}):(0,V.jsx)(p.Z,{})})]})}}];return(0,V.jsxs)("div",{id:"data-page",style:{marginBottom:"120px"},children:[(0,V.jsxs)(z.ZP,{span:24,style:{padding:"10px"},children:[(0,V.jsx)(z.ZP,{item:!0,style:{width:"100%",padding:"15px 0px"},children:(0,V.jsx)(E.Z,{onClick:function(){G(!0)},type:"primary",variant:"contained",sx:{float:"left",marginBottom:"10px",textTransform:"none"},children:"Add Data Source"})}),(0,V.jsxs)(z.ZP,{item:!0,style:{width:"100%"},children:[(0,V.jsxs)(S.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,V.jsx)(C.Z,{children:(0,V.jsx)(k.Z,{children:Je.map((function(e){return(0,V.jsx)(w.Z,{sx:{paddingLeft:"name"===e.key?"40px":"inherit"},children:(0,V.jsx)("strong",{children:e.title})},e.key)}))})}),(0,V.jsx)(_.Z,{children:_e.slice(10*(t-1),10*t).map((function(e,n){return[[(0,V.jsx)(k.Z,{hover:!0,sx:{cursor:"pointer",backgroundColor:e.expand?"#f5f5f5":"inherit"},onClick:function(){!function(e){De(_e.map((function(n){return n.uuid===e.uuid&&(n.expand=!n.expand),n}))),Ce(!0),Me(e.uuid);var n="/api/datasources/".concat(e.uuid,"/entries");e.isUserOwned||(n="/api/org/datasources/".concat(e.uuid,"/entries")),(0,J.o)().get(n).then((function(n){e.isUserOwned?ve([].concat((0,r.Z)(pe.filter((function(n){return n.datasource.uuid!==e.uuid}))),(0,r.Z)(n.data))):ye([].concat((0,r.Z)(je.filter((function(n){return n.datasource.uuid!==e.uuid}))),(0,r.Z)(n.data)))})).finally((function(){Ce(null)}))}(e)},children:Je.map((function(n){var t=e[n.key];return(0,V.jsx)(w.Z,{sx:{fontWeight:e.expand?"bold":"inherit"},children:n.render?n.render(t,e):t},n.key)}))},e.uuid),(0,V.jsx)(k.Z,{children:(0,V.jsx)(w.Z,{colSpan:7,sx:{padding:e.expand?"0":"inherit"},children:(0,V.jsx)(A.Z,{in:e.expand,timeout:"auto",unmountOnExit:!0,children:(0,V.jsx)(Z.Z,{sx:{margin:1},children:Se&&Ie===e.uuid?(0,V.jsx)(O.Z,{}):(0,V.jsx)(oe,{dataSourceEntryData:e.data_source_entries||[]})})})})},"".concat(e.uuid,"_details"))]]}))})]}),(0,V.jsx)(P.Z,{count:Math.ceil(_e.length/10),variant:"outlined",shape:"rounded",page:t,onChange:function(e,n){o(n)},sx:{marginTop:2,float:"right"}})]})]}),Y&&(0,V.jsx)(I.P,{open:Y,handleCancelCb:function(){Ne(null),G(!1)},dataSourceAddedCb:function(){Ne(null),We(),Be(),G(!1)},modalTitle:Ae,datasource:Re}),ee&&(0,V.jsx)(ne,{id:U,title:y,text:N,open:ee,onOk:function(e){void 0!==(null===e||void 0===e?void 0:e.data_source_entries)&&(0,J.o)().delete("api/datasources/".concat(e.uuid)).then((function(e){Be(),le(!1)}))},onCancel:function(){le(!1)}}),ce&&(0,V.jsx)($,{title:Ae,onCancel:function(){return de(!1)},onOk:function(){de(!1)},open:ce,dataSource:Re})]})}},46573:function(e,n,t){t.d(n,{B6:function(){return o},lD:function(){return l}});var i=t(9229),r=t(25926),a=t(84817);function o(){var e=(0,i.Zl)(r.NM);return function(){(0,a.o)().get("/api/datasources").then((function(n){e(n.data)})).catch((function(e){})).then({})}}function l(){var e=(0,i.Zl)(r.MC);return function(){(0,a.o)().get("/api/datasource_entries").then((function(n){e(n.data)})).catch((function(e){})).then({})}}}}]);