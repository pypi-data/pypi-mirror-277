import{n as N,u as w,r as C,z as U,A as k,w as i,y as z,B as L,o as a,a as n,c as l,x as D,t as V,b as d,d as u,C as E,v as x,F}from"./entry.wJW_9yny.js";import{r as b,a as y}from"./form-methods.CS9pXFl6.js";const S={class:"table usa-table usa-table--borderless"},I=n("thead",null,[n("tr",null,[n("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Username"),n("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Email"),n("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Full Name"),n("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Disabled"),n("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Password"),n("th",{scope:"col",role:"columnheader"},"Actions")])],-1),G={key:0},O={key:1},j={key:2},H={key:3},J={key:4},K={key:5},M={key:6},Q={class:"centered-container",style:{"margin-bottom":"1.5em"}},W={key:7},X={class:"centered-container",style:{"margin-bottom":"1.5em"}},Y={key:8},Z={key:9},ee={key:10},te={key:11},ne=N({__name:"user-management",setup(ae){const m=z(),p=w("token"),R=w("user"),_=C(!0),r=C([]);h();async function h(){await $fetch(m.public.apiPath+"/users/details",{retry:0,method:"GET",headers:{Authorization:"Bearer "+p.value},onRequestError(){b()},onResponse({response:t}){r.value=t._data,r.value.forEach(s=>s.edit=!1),r.value.forEach(s=>s.newUser=!1)},onResponseError(){y()}})}function B(t){t.edit=!0}function A(t){t.newUser?(r.value.pop(),_.value=!0):t.edit=!1}function g(){r.value.push({username:"",email:"",full_name:"",disabled:!1,password:"",edit:!0,newUser:!0}),_.value=!1}async function $(t){if(t.newUser){if(t.username===""||t.password===""){alert("Username and password are required.");return}await $fetch(m.public.apiPath+"/user",{retry:0,method:"POST",headers:{Authorization:"Bearer "+p.value},body:{username:t.username,email:t.email,full_name:t.full_name,disabled:t.disabled,password:t.password},onRequestError(){b()},onResponse({response:s}){h()},onResponseError(){y()}}),_.value=!0}else await $fetch(m.public.apiPath+"/user",{retry:0,method:"PUT",body:{username:t.username,email:t.email,full_name:t.full_name,disabled:t.disabled},headers:{Authorization:"Bearer "+p.value},onRequestError(){b()},onResponse({response:s}){h()},onResponseError(){y()}});t.edit=!1}async function P(t){t===R.value?alert("Cannot delete the active user."):confirm("Are you sure you want to delete user, "+t+"?")&&await $fetch(m.public.apiPath+"/user/"+t,{retry:0,method:"DELETE",headers:{Authorization:"Bearer "+p.value},onRequestError(){b()},onResponse({response:s}){console.log("deleted"),h()},onResponseError(){y()}})}return(t,s)=>{const f=U("UsaTextInput"),v=U("UsaCheckbox"),c=U("UsaButton"),T=L;return a(),k(T,{name:"base-layout"},{default:i(()=>[n("table",S,[I,n("tbody",null,[(a(!0),l(F,null,D(x(r),(e,q)=>(a(),l("tr",{key:q},[e.newUser?(a(),l("td",O,[d(f,{modelValue:e.username,"onUpdate:modelValue":o=>e.username=o,type:"email",class:"input-box"},null,8,["modelValue","onUpdate:modelValue"])])):(a(),l("td",G,V(e.username),1)),e.edit?(a(),l("td",H,[d(f,{modelValue:e.email,"onUpdate:modelValue":o=>e.email=o,class:"input-box"},null,8,["modelValue","onUpdate:modelValue"])])):(a(),l("td",j,V(e.email),1)),e.edit?(a(),l("td",K,[d(f,{modelValue:e.full_name,"onUpdate:modelValue":o=>e.full_name=o,class:"input-box"},null,8,["modelValue","onUpdate:modelValue"])])):(a(),l("td",J,V(e.full_name),1)),e.edit?(a(),l("td",W,[n("div",X,[d(v,{modelValue:e.disabled,"onUpdate:modelValue":o=>e.disabled=o},null,8,["modelValue","onUpdate:modelValue"])])])):(a(),l("td",M,[n("div",Q,[d(v,{modelValue:e.disabled,"onUpdate:modelValue":o=>e.disabled=o,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])])),e.newUser?(a(),l("td",Z,[d(f,{modelValue:e.password,"onUpdate:modelValue":o=>e.password=o,class:"input-box"},null,8,["modelValue","onUpdate:modelValue"])])):(a(),l("td",Y,"*****")),e.edit?(a(),l("td",te,[d(c,{class:"secondary-button",onClick:o=>A(e)},{default:i(()=>[u(" Cancel ")]),_:2},1032,["onClick"]),e.edit?(a(),k(c,{key:0,class:"secondary-button",onClick:o=>$(e)},{default:i(()=>[u(" Save ")]),_:2},1032,["onClick"])):E("",!0)])):(a(),l("td",ee,[d(c,{class:"secondary-button",onClick:o=>B(e)},{default:i(()=>[u(" Edit ")]),_:2},1032,["onClick"]),d(c,{class:"usa-button usa-button--secondary",onClick:o=>P(e.username)},{default:i(()=>[u(" Delete ")]),_:2},1032,["onClick"])]))]))),128))])]),x(_)?(a(),k(c,{key:0,class:"primary-button",onClick:s[0]||(s[0]=e=>g())},{default:i(()=>[u(" Add User ")]),_:1})):E("",!0)]),_:1})}}});export{ne as default};
