image: python:alpine

stages:
  - test

before_script:
  - apk add --no-cache git gcc musl-dev libmagic
  - pip install tox

code_style:
  stage: test
  script:
    - tox -e pep8,black_check

py3:
  stage: test
  script:
    - tox -e py3

coverage:
  stage: test
  script:
    - tox -e coverage
  coverage: '/(?i)total.*? (100(?:\.0+)?\%|[1-9]?\d(?:\.\d+)?\%)$/'
